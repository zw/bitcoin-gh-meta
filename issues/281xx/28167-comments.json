[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28167).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [jamesob](https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1894142760) |\n| Stale ACK | [tdb3](https://github.com/bitcoin/bitcoin/pull/28167#pullrequestreview-1894738259) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-07-27T09:52:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1653283215",
      "id" : 1653283215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585iixmP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1653283215/reactions"
      },
      "updated_at" : "2024-04-03T10:27:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1653283215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1285117042"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117042"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not sure `StringToOctal` is the right place for this check.",
      "commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "created_at" : "2023-08-05T20:13:45Z",
      "diff_hunk" : "@@ -239,12 +239,37 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    if (str.length() != 4) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1285117042",
      "id" : 1285117042,
      "line" : 244,
      "node_id" : "PRRC_kwDOABII585MmVRy",
      "original_commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "original_line" : 244,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 6,
      "pull_request_review_id" : 1564007879,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117042/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-05T20:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117042",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1285117079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117079"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Isn't the leading 0 optional? (Also the user might want to setgid or something weird)",
      "commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "created_at" : "2023-08-05T20:14:09Z",
      "diff_hunk" : "@@ -239,12 +239,37 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    if (str.length() != 4) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1285117079",
      "id" : 1285117079,
      "line" : 244,
      "node_id" : "PRRC_kwDOABII585MmVSX",
      "original_commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "original_line" : 244,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 6,
      "pull_request_review_id" : 1564007879,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117079/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-05T20:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285117079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1288488390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288488390"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Seperated sanitzing checks and str->octal converstion in b4b0d2adc9",
      "commit_id" : "b4b0d2adc911758d0d7d37ffe5f3133ea7cd6121",
      "created_at" : "2023-08-09T13:30:51Z",
      "diff_hunk" : "@@ -239,12 +239,37 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    if (str.length() != 4) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1288488390",
      "id" : 1288488390,
      "in_reply_to_id" : 1285117042,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MzMXG",
      "original_commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "original_line" : 244,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1569567574,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288488390/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T13:30:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288488390",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1288489583"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288489583"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "b4b0d2adc9 now handles optional special mode bit",
      "commit_id" : "b4b0d2adc911758d0d7d37ffe5f3133ea7cd6121",
      "created_at" : "2023-08-09T13:31:41Z",
      "diff_hunk" : "@@ -239,12 +239,37 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    if (str.length() != 4) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1288489583",
      "id" : 1288489583,
      "in_reply_to_id" : 1285117079,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MzMpv",
      "original_commit_id" : "a8e92784ba3ee8a5534a427d2b61c4ebbec563a7",
      "original_line" : 244,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1569569843,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288489583/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T13:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288489583",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1290509079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1290509079"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think we need to prepend the zero here.",
      "commit_id" : "b4b0d2adc911758d0d7d37ffe5f3133ea7cd6121",
      "created_at" : "2023-08-10T18:12:27Z",
      "diff_hunk" : "@@ -239,12 +239,43 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    unsigned ret = 0;\n+    for (char c : str) {\n+        if (c < '0' || c > '7') return std::nullopt;\n+        ret = (ret << 3) | (c - '0');\n+    }\n+    return ret;\n+}\n+\n+static std::optional<unsigned> ConvertPermsToOctal(const std::string& str)\n+{\n+    // Padding the front with 0 sets no special modes if not provided\n+    if (str.length() == 3) return StringToOctal(\"0\" + str);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1290509079",
      "id" : 1290509079,
      "line" : 255,
      "node_id" : "PRRC_kwDOABII585M65sX",
      "original_commit_id" : "b4b0d2adc911758d0d7d37ffe5f3133ea7cd6121",
      "original_line" : 255,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 17,
      "pull_request_review_id" : 1572474255,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1290509079/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-10T18:12:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1290509079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Are you still working on this?",
      "created_at" : "2023-10-25T19:20:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1779904322",
      "id" : 1779904322,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585qFy9C",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1779904322/reactions"
      },
      "updated_at" : "2023-10-25T19:20:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1779904322",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1399277913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1399277913"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok removed the 0 padding in 1b0fa12fa5",
      "commit_id" : "4b469d3f984e548137ca16cbc73648de47ca60bd",
      "created_at" : "2023-11-20T14:24:26Z",
      "diff_hunk" : "@@ -239,12 +239,43 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    unsigned ret = 0;\n+    for (char c : str) {\n+        if (c < '0' || c > '7') return std::nullopt;\n+        ret = (ret << 3) | (c - '0');\n+    }\n+    return ret;\n+}\n+\n+static std::optional<unsigned> ConvertPermsToOctal(const std::string& str)\n+{\n+    // Padding the front with 0 sets no special modes if not provided\n+    if (str.length() == 3) return StringToOctal(\"0\" + str);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1399277913",
      "id" : 1399277913,
      "in_reply_to_id" : 1290509079,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585TZ0lZ",
      "original_commit_id" : "b4b0d2adc911758d0d7d37ffe5f3133ea7cd6121",
      "original_line" : 255,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1739941133,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1399277913/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-20T14:24:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1399277913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated to address luke's comment and added a test to ensure rpccookieperms are being applied",
      "created_at" : "2023-11-20T14:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1819164214",
      "id" : 1819164214,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585sbj42",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1819164214/reactions"
      },
      "updated_at" : "2023-11-20T14:24:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1819164214",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased now that #28905 is merged.",
      "created_at" : "2023-11-21T11:36:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1820750522",
      "id" : 1820750522,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585shnK6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1820750522/reactions"
      },
      "updated_at" : "2023-11-21T11:36:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1820750522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-12-01T19:06:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1836631577",
      "id" : 1836631577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585teMYZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1836631577/reactions"
      },
      "updated_at" : "2023-12-01T19:06:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1836631577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1437941333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941333"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This won't work if multiple bits are set",
      "commit_id" : "f15f4b3c4b4d2c3492135c27df93bc35faa40cfc",
      "created_at" : "2023-12-29T01:29:05Z",
      "diff_hunk" : "@@ -82,7 +82,26 @@ static fs::path GetAuthCookieFile(bool temp=false)\n \n static bool g_generated_cookie = false;\n \n-bool GenerateAuthCookie(std::string *cookie_out)\n+static std::string perms_to_str(fs::perms p)\n+{\n+    char special = '-';\n+    if ((p & fs::perms::set_uid)    != fs::perms::none) special = '4';\n+    if ((p & fs::perms::set_gid)    != fs::perms::none) special = '2';\n+    if ((p & fs::perms::sticky_bit) != fs::perms::none) special = '1';",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1437941333",
      "id" : 1437941333,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585VtT5V",
      "original_commit_id" : "f15f4b3c4b4d2c3492135c27df93bc35faa40cfc",
      "original_line" : 90,
      "original_position" : 10,
      "original_start_line" : 88,
      "path" : "src/rpc/request.cpp",
      "position" : 10,
      "pull_request_review_id" : 1798542006,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941333/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 88,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-29T01:29:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1437941696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These bits seem to typically manifest by replacing the 'x' field with either 's' (setuid/setgid+executable), 'S' (setuid/setgid WITHOUT executable), 't' (sticky+exec), or 'T' (sticky NO exec)",
      "commit_id" : "f15f4b3c4b4d2c3492135c27df93bc35faa40cfc",
      "created_at" : "2023-12-29T01:31:17Z",
      "diff_hunk" : "@@ -82,7 +82,26 @@ static fs::path GetAuthCookieFile(bool temp=false)\n \n static bool g_generated_cookie = false;\n \n-bool GenerateAuthCookie(std::string *cookie_out)\n+static std::string perms_to_str(fs::perms p)\n+{\n+    char special = '-';\n+    if ((p & fs::perms::set_uid)    != fs::perms::none) special = '4';\n+    if ((p & fs::perms::set_gid)    != fs::perms::none) special = '2';\n+    if ((p & fs::perms::sticky_bit) != fs::perms::none) special = '1';",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1437941696",
      "id" : 1437941696,
      "in_reply_to_id" : 1437941333,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585VtT_A",
      "original_commit_id" : "f15f4b3c4b4d2c3492135c27df93bc35faa40cfc",
      "original_line" : 90,
      "original_position" : 10,
      "original_start_line" : 88,
      "path" : "src/rpc/request.cpp",
      "position" : 10,
      "pull_request_review_id" : 1798542443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 88,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-29T01:31:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437941696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Should the permissions that can be set limited here? There is no reason to ever set +x on an RPC cookie file.",
      "created_at" : "2023-12-29T09:30:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1871874677",
      "id" : 1871874677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585vkop1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1871874677/reactions"
      },
      "updated_at" : "2023-12-29T09:30:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1871874677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm not sure there's a reason to ever set +w either... maybe it should just be -rpccookieaccess user/group/all or something",
      "created_at" : "2023-12-30T23:50:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1872628019",
      "id" : 1872628019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585vngkz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872628019/reactions"
      },
      "updated_at" : "2023-12-30T23:50:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872628019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure there's a reason to ever set +w either... maybe it should just be -rpccookieaccess user/group/all or something\r\n\r\nAgree, makes sense. Giving read access to other users is the only use case of this functionality I know of.",
      "created_at" : "2023-12-31T01:10:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1872640782",
      "id" : 1872640782,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585vnjsO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872640782/reactions"
      },
      "updated_at" : "2023-12-31T01:10:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872640782",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sorry for the slow response. I was away but am now back.\r\n\r\nThanks for the review, I agree that setting special bits is uninteresting for cookie files (I was really trying to keep the subfunctions generic in case we wanted to re-use them elsewhere). I've now removed ability to set special bits.\r\n\r\nI think a little on switching to string-based settings, i.e. `-rpccookieperms=group`, but this quickly gets more ugly inside, as IMO the usual use-case is to be setting multiple values in the same permission. i.e. setting just `user` (`040`) means that the owner-user will NOT be able to read the cookie, as user is checked against owner before group, and if a match is found, with no read perms, the checks are exited. I feel that users are likely to want to set `group` in _addition_ to `user`, therefore 3 digit ocal perms make more sense.",
      "created_at" : "2024-01-08T12:17:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1880891111",
      "id" : 1880891111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585wHB7n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880891111/reactions"
      },
      "updated_at" : "2024-01-08T12:17:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880891111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think a little on switching to string-based settings, i.e. `-rpccookieperms=group`, but this quickly gets more ugly inside, as IMO the usual use-case is to be setting multiple values in the same permission. i.e. setting just `user` (`040`) means that the owner-user will NOT be able to read the cookie, as user is checked against owner before group, and if a match is found, with no read perms, the checks are exited. I feel that users are likely to want to set `group` in _addition_ to `user`, therefore 3 digit ocal perms make more sense.\r\n\r\nOnly three permissions that makes sense IMO are `600`, `640` and `644`.",
      "created_at" : "2024-01-08T13:37:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1881022140",
      "id" : 1881022140,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585wHh68",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881022140/reactions"
      },
      "updated_at" : "2024-01-08T13:37:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881022140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > I think a little on switching to string-based settings, i.e. `-rpccookieperms=group`, but this quickly gets more ugly inside, as IMO the usual use-case is to be setting multiple values in the same permission. i.e. setting just `user` (`040`) means that the owner-user will NOT be able to read the cookie, as user is checked against owner before group, and if a match is found, with no read perms, the checks are exited. I feel that users are likely to want to set `group` in _addition_ to `user`, therefore 3 digit ocal perms make more sense.\r\n> \r\n> Only three permissions that makes sense IMO are `600`, `640` and `644`.\r\n\r\nYes. I did author a commit to be prepended the two in this PR, which changed our default cookie perms to `400` using `DEFAULT_COOKIE_PERMS` (with current umask it is `600`), as I don't think enabling write perms on a cookie (ever?!) that bitcoind has created makes sense? It just seemed a bit out of scope for this PR and I thought it might work best as a followup (or before) on it's own. It could also include rejecting permissions which included writing if we wanted...",
      "created_at" : "2024-01-08T13:50:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1881049934",
      "id" : 1881049934,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585wHotO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881049934/reactions"
      },
      "updated_at" : "2024-01-08T13:50:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881049934",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I don't think enabling write perms on a cookie (ever?!) that bitcoind has created makes sense?\r\n\r\nAhh, yes, `400`, `440`, `444`.",
      "created_at" : "2024-01-08T13:52:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1881053840",
      "id" : 1881053840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585wHpqQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881053840/reactions"
      },
      "updated_at" : "2024-01-08T13:52:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881053840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "OK I added a commit to change default cookie perms to `400`, and rebased on master to try and get the unrelated CI failure to go away.",
      "created_at" : "2024-01-15T13:21:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1892167852",
      "id" : 1892167852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585wyDCs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1892167852/reactions"
      },
      "updated_at" : "2024-01-15T13:21:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1892167852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Approach ACK; seems like a reasonable feature reasonably implemented. Will do a more formal review soon.",
      "created_at" : "2024-01-16T16:57:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1894142760",
      "id" : 1894142760,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585w5lMo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1894142760/reactions"
      },
      "updated_at" : "2024-01-16T16:57:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1894142760",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465818605"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465818605"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I dislike using `auto` both here and the default. It could conceivably not be a type that supports all permission masks.",
      "commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "created_at" : "2024-01-25T04:08:40Z",
      "diff_hunk" : "@@ -240,12 +240,41 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    unsigned ret = 0;\n+    for (char c : str) {\n+        if (c < '0' || c > '7') return std::nullopt;\n+        ret = (ret << 3) | (c - '0');\n+    }\n+    return ret;\n+}\n+\n+static auto ConvertPermsToOctal(const std::string& str) noexcept -> std::optional<unsigned>\n+{\n+    // Don't permit setting special bits as they're not relevant to cookie files\n+    if (str.length() == 3) return StringToOctal(str);\n+    return std::nullopt;\n+}\n+\n static bool InitRPCAuthentication()\n {\n     if (gArgs.GetArg(\"-rpcpassword\", \"\") == \"\")\n     {\n         LogPrintf(\"Using random cookie authentication.\\n\");\n-        if (!GenerateAuthCookie(&strRPCUserColonPass)) {\n+\n+        auto cookie_perms{DEFAULT_COOKIE_PERMS};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465818605",
      "id" : 1465818605,
      "line" : 266,
      "node_id" : "PRRC_kwDOABII585XXp3t",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 266,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 28,
      "pull_request_review_id" : 1842805469,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465818605/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T04:08:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465818605",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465819385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819385"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Feels weird to log this unconditionally. Maybe the option should just be unavailable (and implicitly error) on Windows, and hard-code setting it user-read-only here?",
      "commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "created_at" : "2024-01-25T04:10:27Z",
      "diff_hunk" : "@@ -82,23 +82,32 @@ static fs::path GetAuthCookieFile(bool temp=false)\n \n static bool g_generated_cookie = false;\n \n-bool GenerateAuthCookie(std::string *cookie_out)\n+bool GenerateAuthCookie(std::string* cookie_out, fs::perms cookie_perms)\n {\n     const size_t COOKIE_SIZE = 32;\n     unsigned char rand_pwd[COOKIE_SIZE];\n     GetRandBytes(rand_pwd);\n     std::string cookie = COOKIEAUTH_USER + \":\" + HexStr(rand_pwd);\n \n-    /** the umask determines what permissions are used to create this file -\n-     * these are set to 0077 in common/system.cpp.\n-     */\n     std::ofstream file;\n     fs::path filepath_tmp = GetAuthCookieFile(true);\n     file.open(filepath_tmp);\n     if (!file.is_open()) {\n         LogPrintf(\"Unable to open cookie authentication file %s for writing\\n\", fs::PathToString(filepath_tmp));\n         return false;\n     }\n+\n+#ifdef WIN32\n+    LogPrintf(\"Unable to set unix file permissions on cookie using Windows systems: %s\\n\", fs::PathToString(filepath_tmp));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465819385",
      "id" : 1465819385,
      "line" : 101,
      "node_id" : "PRRC_kwDOABII585XXqD5",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 101,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 24,
      "pull_request_review_id" : 1842806580,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819385/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T04:10:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465819696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Missing a space in the indentation",
      "commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "created_at" : "2024-01-25T04:11:09Z",
      "diff_hunk" : "@@ -84,6 +94,39 @@ def test_auth(self, node, user, password):\n         self.log.info('Wrong...')\n         assert_equal(401, call_with_auth(node, user + 'wrong', password + 'wrong').status)\n \n+    def test_rpccookieperms(self):\n+\n+        if os.name == 'nt':\n+            raise SkipTest(f\"Skip cookie file permissions checks as OS detected as: {os.name=:}\")\n+        self.log.info('Check cookie file permissions can be set using -rpccookieperms')\n+\n+        cookie_file_path = self.nodes[1].chain_path / '.cookie'\n+\n+        def test_perm(perm: Optional[str]):\n+            if not perm:\n+                perm = f\"{(DEFAULT_COOKIE_PERMISSION & PERM_BITS_UMASK):03o}\"\n+                self.restart_node(1)\n+            else:\n+                self.restart_node(1, extra_args=[f\"-rpccookieperms={perm}\"])\n+            file_stat = os.stat(cookie_file_path)\n+            actual_perms = f\"{(file_stat.st_mode & PERM_BITS_UMASK):03o}\"\n+            assert_equal(perm, actual_perms)\n+\n+       # Remove any leftover rpc{user|password} config options from previous tests",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465819696",
      "id" : 1465819696,
      "line" : 115,
      "node_id" : "PRRC_kwDOABII585XXqIw",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 115,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "test/functional/rpc_users.py",
      "position" : 53,
      "pull_request_review_id" : 1842806995,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T04:11:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465819696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465820310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465820310"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Feels like a hack\r\n\r\n```suggestion\r\n        for perm in \"440\", \"640\", \"444\":\r\n            test_perm(perm)\r\n```",
      "commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "created_at" : "2024-01-25T04:12:37Z",
      "diff_hunk" : "@@ -84,6 +94,39 @@ def test_auth(self, node, user, password):\n         self.log.info('Wrong...')\n         assert_equal(401, call_with_auth(node, user + 'wrong', password + 'wrong').status)\n \n+    def test_rpccookieperms(self):\n+\n+        if os.name == 'nt':\n+            raise SkipTest(f\"Skip cookie file permissions checks as OS detected as: {os.name=:}\")\n+        self.log.info('Check cookie file permissions can be set using -rpccookieperms')\n+\n+        cookie_file_path = self.nodes[1].chain_path / '.cookie'\n+\n+        def test_perm(perm: Optional[str]):\n+            if not perm:\n+                perm = f\"{(DEFAULT_COOKIE_PERMISSION & PERM_BITS_UMASK):03o}\"\n+                self.restart_node(1)\n+            else:\n+                self.restart_node(1, extra_args=[f\"-rpccookieperms={perm}\"])\n+            file_stat = os.stat(cookie_file_path)\n+            actual_perms = f\"{(file_stat.st_mode & PERM_BITS_UMASK):03o}\"\n+            assert_equal(perm, actual_perms)\n+\n+       # Remove any leftover rpc{user|password} config options from previous tests\n+        conf = self.nodes[1].bitcoinconf\n+        with conf.open('r') as file:\n+            lines = file.readlines()\n+        filtered_lines = [line for line in lines if not line.startswith('rpcuser') and not line.startswith('rpcpassword')]\n+        with conf.open('w') as file:\n+            file.writelines(filtered_lines)\n+\n+        self.log.info('Check default cookie permission')\n+        test_perm(None)\n+\n+        self.log.info('Check custom cookie permissions')\n+        test_perms = [\"440\", \"640\", \"444\"]\n+        [test_perm(perm) for perm in test_perms]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1465820310",
      "id" : 1465820310,
      "line" : 128,
      "node_id" : "PRRC_kwDOABII585XXqSW",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 128,
      "original_position" : 66,
      "original_start_line" : 127,
      "path" : "test/functional/rpc_users.py",
      "position" : 66,
      "pull_request_review_id" : 1842807864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465820310/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 127,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-25T04:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465820310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466107824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466107824"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed to `fs::perms` here and the default in e838d7dcc6c835dcb936dd3b691842aaa43f22ad",
      "commit_id" : "78f59b4a26b19011d53d9330454f383b47c063eb",
      "created_at" : "2024-01-25T09:48:31Z",
      "diff_hunk" : "@@ -240,12 +240,41 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n     return true;\n }\n \n+static std::optional<unsigned> StringToOctal(const std::string& str)\n+{\n+    unsigned ret = 0;\n+    for (char c : str) {\n+        if (c < '0' || c > '7') return std::nullopt;\n+        ret = (ret << 3) | (c - '0');\n+    }\n+    return ret;\n+}\n+\n+static auto ConvertPermsToOctal(const std::string& str) noexcept -> std::optional<unsigned>\n+{\n+    // Don't permit setting special bits as they're not relevant to cookie files\n+    if (str.length() == 3) return StringToOctal(str);\n+    return std::nullopt;\n+}\n+\n static bool InitRPCAuthentication()\n {\n     if (gArgs.GetArg(\"-rpcpassword\", \"\") == \"\")\n     {\n         LogPrintf(\"Using random cookie authentication.\\n\");\n-        if (!GenerateAuthCookie(&strRPCUserColonPass)) {\n+\n+        auto cookie_perms{DEFAULT_COOKIE_PERMS};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466107824",
      "id" : 1466107824,
      "in_reply_to_id" : 1465818605,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XYwew",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 266,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1843266175,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466107824/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T09:53:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466107824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466110010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466110010"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The cookie should be read-only on Windows by deafult, so I've moved the logging up into `InitRPCAuthentication` [here](https://github.com/bitcoin/bitcoin/pull/28167/commits/e838d7dcc6c835dcb936dd3b691842aaa43f22ad#diff-a8ffd831b801d5170ec47bd2cde728ada0ffb3571f03ad70d93fc66c2009309aR269-R272), which now also returns an error if the user tries to set `rpccookieperms`  on windows.",
      "commit_id" : "78f59b4a26b19011d53d9330454f383b47c063eb",
      "created_at" : "2024-01-25T09:50:14Z",
      "diff_hunk" : "@@ -82,23 +82,32 @@ static fs::path GetAuthCookieFile(bool temp=false)\n \n static bool g_generated_cookie = false;\n \n-bool GenerateAuthCookie(std::string *cookie_out)\n+bool GenerateAuthCookie(std::string* cookie_out, fs::perms cookie_perms)\n {\n     const size_t COOKIE_SIZE = 32;\n     unsigned char rand_pwd[COOKIE_SIZE];\n     GetRandBytes(rand_pwd);\n     std::string cookie = COOKIEAUTH_USER + \":\" + HexStr(rand_pwd);\n \n-    /** the umask determines what permissions are used to create this file -\n-     * these are set to 0077 in common/system.cpp.\n-     */\n     std::ofstream file;\n     fs::path filepath_tmp = GetAuthCookieFile(true);\n     file.open(filepath_tmp);\n     if (!file.is_open()) {\n         LogPrintf(\"Unable to open cookie authentication file %s for writing\\n\", fs::PathToString(filepath_tmp));\n         return false;\n     }\n+\n+#ifdef WIN32\n+    LogPrintf(\"Unable to set unix file permissions on cookie using Windows systems: %s\\n\", fs::PathToString(filepath_tmp));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466110010",
      "id" : 1466110010,
      "in_reply_to_id" : 1465819385,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XYxA6",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 101,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : null,
      "pull_request_review_id" : 1843269556,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466110010/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T09:53:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466110010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466111038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466111038"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! My formatter is having some difficulty with diff/range-based formatting at the moment. Fixed.",
      "commit_id" : "78f59b4a26b19011d53d9330454f383b47c063eb",
      "created_at" : "2024-01-25T09:50:59Z",
      "diff_hunk" : "@@ -84,6 +94,39 @@ def test_auth(self, node, user, password):\n         self.log.info('Wrong...')\n         assert_equal(401, call_with_auth(node, user + 'wrong', password + 'wrong').status)\n \n+    def test_rpccookieperms(self):\n+\n+        if os.name == 'nt':\n+            raise SkipTest(f\"Skip cookie file permissions checks as OS detected as: {os.name=:}\")\n+        self.log.info('Check cookie file permissions can be set using -rpccookieperms')\n+\n+        cookie_file_path = self.nodes[1].chain_path / '.cookie'\n+\n+        def test_perm(perm: Optional[str]):\n+            if not perm:\n+                perm = f\"{(DEFAULT_COOKIE_PERMISSION & PERM_BITS_UMASK):03o}\"\n+                self.restart_node(1)\n+            else:\n+                self.restart_node(1, extra_args=[f\"-rpccookieperms={perm}\"])\n+            file_stat = os.stat(cookie_file_path)\n+            actual_perms = f\"{(file_stat.st_mode & PERM_BITS_UMASK):03o}\"\n+            assert_equal(perm, actual_perms)\n+\n+       # Remove any leftover rpc{user|password} config options from previous tests",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466111038",
      "id" : 1466111038,
      "in_reply_to_id" : 1465819696,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XYxQ-",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 115,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "test/functional/rpc_users.py",
      "position" : null,
      "pull_request_review_id" : 1843271138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466111038/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T09:50:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466111038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466112815"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466112815"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "IMO list comprehensions are fine, but seeing as I voided half the point of using one (creating a one-liner), so took the change to a regular for loop in 78f59b4a26b19011d53d9330454f383b47c063eb",
      "commit_id" : "78f59b4a26b19011d53d9330454f383b47c063eb",
      "created_at" : "2024-01-25T09:52:24Z",
      "diff_hunk" : "@@ -84,6 +94,39 @@ def test_auth(self, node, user, password):\n         self.log.info('Wrong...')\n         assert_equal(401, call_with_auth(node, user + 'wrong', password + 'wrong').status)\n \n+    def test_rpccookieperms(self):\n+\n+        if os.name == 'nt':\n+            raise SkipTest(f\"Skip cookie file permissions checks as OS detected as: {os.name=:}\")\n+        self.log.info('Check cookie file permissions can be set using -rpccookieperms')\n+\n+        cookie_file_path = self.nodes[1].chain_path / '.cookie'\n+\n+        def test_perm(perm: Optional[str]):\n+            if not perm:\n+                perm = f\"{(DEFAULT_COOKIE_PERMISSION & PERM_BITS_UMASK):03o}\"\n+                self.restart_node(1)\n+            else:\n+                self.restart_node(1, extra_args=[f\"-rpccookieperms={perm}\"])\n+            file_stat = os.stat(cookie_file_path)\n+            actual_perms = f\"{(file_stat.st_mode & PERM_BITS_UMASK):03o}\"\n+            assert_equal(perm, actual_perms)\n+\n+       # Remove any leftover rpc{user|password} config options from previous tests\n+        conf = self.nodes[1].bitcoinconf\n+        with conf.open('r') as file:\n+            lines = file.readlines()\n+        filtered_lines = [line for line in lines if not line.startswith('rpcuser') and not line.startswith('rpcpassword')]\n+        with conf.open('w') as file:\n+            file.writelines(filtered_lines)\n+\n+        self.log.info('Check default cookie permission')\n+        test_perm(None)\n+\n+        self.log.info('Check custom cookie permissions')\n+        test_perms = [\"440\", \"640\", \"444\"]\n+        [test_perm(perm) for perm in test_perms]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466112815",
      "id" : 1466112815,
      "in_reply_to_id" : 1465820310,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XYxsv",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 128,
      "original_position" : 66,
      "original_start_line" : 127,
      "path" : "test/functional/rpc_users.py",
      "position" : null,
      "pull_request_review_id" : 1843273966,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466112815/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-25T09:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466112815",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20852902254</sub>",
      "created_at" : "2024-01-25T09:53:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1909783501",
      "id" : 1909783501,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585x1PvN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1909783501/reactions"
      },
      "updated_at" : "2024-01-25T09:53:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1909783501",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466685406"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466685406"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think Windows has strict defaults on permissions for new files, with regard to other users. [This StackExchange article](https://superuser.com/questions/242783/set-default-access-control-list-acl-to-everyone-when-creating-a-new-file-or-fo) at least suggests the default can be manipulated manually.\r\n\r\nAlso, typically when a feature is disabled at build time, we don't add it to argsman (except perhaps as a hidden_args, but I think that may be a bug in such cases).",
      "commit_id" : "78f59b4a26b19011d53d9330454f383b47c063eb",
      "created_at" : "2024-01-25T17:07:39Z",
      "diff_hunk" : "@@ -82,23 +82,32 @@ static fs::path GetAuthCookieFile(bool temp=false)\n \n static bool g_generated_cookie = false;\n \n-bool GenerateAuthCookie(std::string *cookie_out)\n+bool GenerateAuthCookie(std::string* cookie_out, fs::perms cookie_perms)\n {\n     const size_t COOKIE_SIZE = 32;\n     unsigned char rand_pwd[COOKIE_SIZE];\n     GetRandBytes(rand_pwd);\n     std::string cookie = COOKIEAUTH_USER + \":\" + HexStr(rand_pwd);\n \n-    /** the umask determines what permissions are used to create this file -\n-     * these are set to 0077 in common/system.cpp.\n-     */\n     std::ofstream file;\n     fs::path filepath_tmp = GetAuthCookieFile(true);\n     file.open(filepath_tmp);\n     if (!file.is_open()) {\n         LogPrintf(\"Unable to open cookie authentication file %s for writing\\n\", fs::PathToString(filepath_tmp));\n         return false;\n     }\n+\n+#ifdef WIN32\n+    LogPrintf(\"Unable to set unix file permissions on cookie using Windows systems: %s\\n\", fs::PathToString(filepath_tmp));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#discussion_r1466685406",
      "id" : 1466685406,
      "in_reply_to_id" : 1465819385,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Xa9fe",
      "original_commit_id" : "d38e54425fab9ef26883c9a32d2b75a13c62e383",
      "original_line" : 101,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : null,
      "pull_request_review_id" : 1844249235,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28167",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466685406/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-25T17:07:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466685406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Actually, why wouldn't fs::permissions work on Windows?",
      "created_at" : "2024-01-25T18:11:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1910735981",
      "id" : 1910735981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585x44Rt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1910735981/reactions"
      },
      "updated_at" : "2024-01-25T18:11:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1910735981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For your consideration, I have pushed a variant with some recommended changes here: https://github.com/luke-jr/bitcoin/commits/rpccookieperms-26%2Bknots/\r\n\r\nFeel free to cherry-pick or squash into your PR as you deem best.",
      "created_at" : "2024-01-26T16:28:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1912341078",
      "id" : 1912341078,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585x_AJW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1912341078/reactions"
      },
      "updated_at" : "2024-01-26T16:28:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1912341078",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks Luke, I agree that repeated string concatenation was not a particularly neat for creating a single string where we could simply modify in place. I've updated this further from your version to use a lambda in bf9b11d8f6c0af9b2c76674481e5905a00240cf5.\r\n\r\nRe Windows. Yes, fs::permissions is \"supported\", but IIUC without devolving into access control lists, it all boils down to whether the write bit is enabled. I don't see the sense in supporting either of these things here personally. The default cookie permission should be setting the read flag on Windows, but not write. And I would prefer to keep `rpccookieperms` Unix only.",
      "created_at" : "2024-02-05T11:30:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-1926771908",
      "id" : 1926771908,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII585y2DTE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1926771908/reactions"
      },
      "updated_at" : "2024-02-05T11:30:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1926771908",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Knots 26.1 included this (with a few modifications). A user got stuck with a `.cookie.tmp` file that was read-only, and couldn't start Knots because the file couldn't be opened for writing. Which got me thinking should we even be modifying a read-only cookie file, or use it as-is? But here, we've been discussing only (or normative) read-only files...\r\n\r\nDealing with a read-only tmp file is probably outside the scope of this PR, but maybe we should reconsider if `+rw` might actually be the correct mode to use.",
      "created_at" : "2024-03-29T16:33:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-2027460718",
      "id" : 2027460718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII58542Jhu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027460718/reactions"
      },
      "updated_at" : "2024-03-29T16:33:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027460718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Dealing with a read-only tmp file is probably outside the scope of this PR, but maybe we should reconsider if +rw might actually be the correct mode to use.\r\n\r\n@luke-jr that seems like an unlikely situation (unless bitcoind is killed in the moment between writing the temporary cookie file and renaming it?), nonetheless, it could be addressed by changing where we apply the new more restrictive `400` permissions, from the temp file to the renamed `.cookie`.\r\n\r\nI don't think the temporary cookie file existing with perms `600` for a moment is particularly problematic, so I've integrated the change here in 06761eb2686ffe3d7f647d8df9bb7b555bc0072a\r\n\r\nI also tested that Bitcoin Core starts up OK like this with the new changes:\r\n\r\n```bash\r\ncd $DATADIR\r\ntouch .cookie.tmp\r\nchmod 600 .cookie.tmp\r\n./src/bitcoind\r\n```\r\n\r\nEven if the `.cookie.tmp` file contains old data from a previous start, the default `std::ofstream` open mode will overwrite the file rather than append, so after renaming the `.cookie` should always be valid.",
      "created_at" : "2024-04-03T10:28:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-2034186584",
      "id" : 2034186584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII5855PzlY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2034186584/reactions"
      },
      "updated_at" : "2024-04-03T10:28:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2034186584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My point was more that we should probably not be making cookie files read-only to begin with. So only `rw-r--r--`, `rw-r-----`, and `rw-------` should be supported. Bringing us back to this maybe being best as `-rpccookieperms=user/group/all` rather than an octal modeset.\r\n\r\nAnd then how to handle if the cookie file already exists read-only... it *might* make sense to just use it unmodified in that scenario?",
      "created_at" : "2024-04-21T22:59:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28167#issuecomment-2068240859",
      "id" : 2068240859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28167",
      "node_id" : "IC_kwDOABII5857Rtnb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068240859/reactions"
      },
      "updated_at" : "2024-04-21T22:59:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068240859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
