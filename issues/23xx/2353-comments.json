[
   {
      "body" : "bad_alloc means it is running out of memory. How much memory do you have?  What OS?\r\n",
      "created_at" : "2013-03-10T20:58:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2353#issuecomment-14689144",
      "id" : 14689144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2353",
      "updated_at" : "2013-03-10T20:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/14689144",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "magnus@desktop|21:59|~/src/bitcoin ((v0.8.0)) $ cat /proc/meminfo \r\nMemTotal:       16445204 kB\r\nMemFree:         4247964 kB\r\nBuffers:          341888 kB\r\nCached:          8300268 kB\r\nSwapCached:            0 kB\r\nActive:         10045068 kB\r\nInactive:        1818152 kB\r\nActive(anon):    2951020 kB\r\nInactive(anon):   303216 kB\r\nActive(file):    7094048 kB\r\nInactive(file):  1514936 kB\r\nUnevictable:          80 kB\r\nMlocked:              80 kB\r\nHighTotal:      15751096 kB\r\nHighFree:        4179560 kB\r\nLowTotal:         694108 kB\r\nLowFree:           68404 kB\r\nSwapTotal:      16659452 kB\r\nSwapFree:       16659452 kB\r\nDirty:              3440 kB\r\nWriteback:             0 kB\r\nAnonPages:       3221360 kB\r\nMapped:           233656 kB\r\nShmem:             33172 kB\r\nSlab:             236588 kB\r\nSReclaimable:     200160 kB\r\nSUnreclaim:        36428 kB\r\nKernelStack:        5144 kB\r\nPageTables:        31576 kB\r\nNFS_Unstable:          0 kB\r\nBounce:                0 kB\r\nWritebackTmp:          0 kB\r\nCommitLimit:    24882052 kB\r\nCommitted_AS:    7121976 kB\r\nVmallocTotal:     122880 kB\r\nVmallocUsed:       63688 kB\r\nVmallocChunk:      52276 kB\r\nHardwareCorrupted:     0 kB\r\nAnonHugePages:         0 kB\r\nHugePages_Total:       0\r\nHugePages_Free:        0\r\nHugePages_Rsvd:        0\r\nHugePages_Surp:        0\r\nHugepagesize:       2048 kB\r\nDirectMap4k:       98296 kB\r\nDirectMap2M:      815104 kB\r\n\r\nI'm running Lubuntu 12.04, 32 bit.",
      "created_at" : "2013-03-10T21:01:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2353#issuecomment-14689196",
      "id" : 14689196,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2353",
      "updated_at" : "2013-03-10T21:01:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/14689196",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/308049?v=3",
         "events_url" : "https://api.github.com/users/ralphtheninja/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ralphtheninja/followers",
         "following_url" : "https://api.github.com/users/ralphtheninja/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ralphtheninja/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ralphtheninja",
         "id" : 308049,
         "login" : "ralphtheninja",
         "organizations_url" : "https://api.github.com/users/ralphtheninja/orgs",
         "received_events_url" : "https://api.github.com/users/ralphtheninja/received_events",
         "repos_url" : "https://api.github.com/users/ralphtheninja/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ralphtheninja/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ralphtheninja/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ralphtheninja"
      }
   },
   {
      "body" : "This is how bitcoin runs out of memory (virtual address space) while downloading blocks:\r\n\r\nWhenever a node receives a block that it cannot link to the chain, it stores it in memory in mapOrphanBlocks.  There is no limit to the size of that data.  When a node is downloading blocks, it may download and keep in memory many blocks that it can't currently link to the chain.  In particular, if your node connects to another node which is also downloading blocks and which is further along in the download, the other node will spam your node with an \"inv\" message for every new block that it downloads (no, the logic in CBlock::AcceptBlock does not prevent it), and your node will download and store those blocks in mapOrphanBlocks.  This can occur with multiple connected nodes simultaneously which are at different points in the download.\r\n\r\nI encountered this problem several times with 0.8.0rc1.  With the current size of the blockchain, it is not hard to exhaust the virtual address space (at most 4GiB) in 32-bit builds, which includes all Windows builds.\r\n\r\nThe fix could proceed in one of two directions: (1) store orphan blocks on disk instead of in memory, or (2) don't keep an unbounded set of orphan blocks.  For (2), the ideal would be to prevent downloading of too many orphans rather than discarding orphans that have already been downloaded, which is wasteful.  The goal would be to download blocks roughly in order.  One idea is to make use of \"getheaders\" during block download.  Headers would be downloaded and linked together, and blocks would only be downloaded if we already know based on headers that they are not too far away from the chain of blocks that we already have.",
      "created_at" : "2013-03-12T21:51:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2353#issuecomment-14806541",
      "id" : 14806541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2353",
      "updated_at" : "2013-03-12T21:51:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/14806541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3847496?v=3",
         "events_url" : "https://api.github.com/users/jeremysawicki/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jeremysawicki/followers",
         "following_url" : "https://api.github.com/users/jeremysawicki/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jeremysawicki/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jeremysawicki",
         "id" : 3847496,
         "login" : "jeremysawicki",
         "organizations_url" : "https://api.github.com/users/jeremysawicki/orgs",
         "received_events_url" : "https://api.github.com/users/jeremysawicki/received_events",
         "repos_url" : "https://api.github.com/users/jeremysawicki/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jeremysawicki/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jeremysawicki/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jeremysawicki"
      }
   },
   {
      "body" : "Headers-first synchronization (being worked on) removes the concept of orphan blocks entirely, as a block is only downloaded when its ancestry is already known, so it can always be saved on disk.",
      "created_at" : "2013-10-22T08:28:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2353#issuecomment-26785284",
      "id" : 26785284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2353",
      "updated_at" : "2013-10-22T08:28:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26785284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Since 0.9.0 the number of orphan blocks that is stored has been restricted, so this immediate issue should be fixed.",
      "created_at" : "2014-05-03T10:36:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2353#issuecomment-42101767",
      "id" : 42101767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2353",
      "updated_at" : "2014-05-03T10:36:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42101767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
