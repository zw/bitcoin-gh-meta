[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28695).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1785068400), [stickies-v](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1704051850), [vasild](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1704119812) |\n| Concept ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1690371059), [kristapsk](https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1783006261) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2023-10-20T15:44:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1772980550",
      "id" : 1772980550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585prYlG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772980550/reactions"
      },
      "updated_at" : "2023-10-30T13:24:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772980550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I would greatly appreciate it if someone could write unit tests for this, @vasild @jonatack maybe?",
      "created_at" : "2023-10-20T15:46:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1772983120",
      "id" : 1772983120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585prZNQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772983120/reactions"
      },
      "updated_at" : "2023-10-20T15:46:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772983120",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1367292456"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1367292456"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: typo `to` -> `too` (here and below).",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-20T17:15:18Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key to small (size < 387 bytes)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1367292456",
      "id" : 1367292456,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Rfzoo",
      "original_commit_id" : "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "original_line" : 83,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : null,
      "pull_request_review_id" : 1690585049,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1367292456/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-20T17:16:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1367292456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This should probably be in the 26.0 milestone?",
      "created_at" : "2023-10-23T08:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774716867",
      "id" : 1774716867,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pyAfD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774716867/reactions"
      },
      "updated_at" : "2023-10-23T08:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774716867",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To what extent is the proxy trusted, and to what extent is it required to validate inputs from it? I think it would be good to first document that and then design unit and fuzz tests based on that design assumption?",
      "created_at" : "2023-10-23T09:03:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774741614",
      "id" : 1774741614,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pyGhu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774741614/reactions"
      },
      "updated_at" : "2023-10-23T09:03:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774741614",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "typo-nit: `received`",
      "created_at" : "2023-10-23T09:06:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774747837",
      "id" : 1774747837,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pyIC9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 1,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774747837/reactions"
      },
      "updated_at" : "2023-10-23T09:06:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774747837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> To what extent is the proxy trusted, and to what extent is it required to validate inputs from it?\r\n\r\n@jonatack @vasild @zzzi2p",
      "created_at" : "2023-10-23T09:10:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774753670",
      "id" : 1774753670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pyJeG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774753670/reactions"
      },
      "updated_at" : "2023-10-23T09:10:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774753670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "The i2pd crash in OP should be reported to that project and/or @orignal\r\n\r\nJava I2P probably won't crash on bad input and we do some validation of public and private keys but we can't promise to catch everything.\r\n\r\nThe format is a little elaborate, I don't know how far down you want to go. Would you validate the individual key fields? Would you check for pubkey/privkey mismatches? Just basic length checks?\r\n\r\nFrom the SAM spec:\r\n\r\n```\r\nThe $privkey is the base 64 of the concatenation of the [Destination](https://geti2p.net/en/docs/spec/common-structures#type_Destination) \r\nfollowed by the [Private Key](https://geti2p.net/en/docs/spec/common-structures#type_PrivateKey) \r\nfollowed by the [Signing Private Key](https://geti2p.net/en/docs/spec/common-structures#type_SigningPrivateKey),\r\n optionally followed by the [Offline Signature](https://geti2p.net/en/docs/spec/common-structures#struct_OfflineSignature), \r\nwhich is 663 or more bytes in binary and 884 or more bytes in base 64, depending on signature type. \r\nThe binary format is specified in [Private Key File](https://github.com/i2p/i2p.i2p/blob/master/core/java/src/net/i2p/data/PrivateKeyFile.java). \r\nSee additional notes about the [Private Key](https://geti2p.net/en/docs/spec/common-structures#type_PrivateKey)\r\n in the Destination Key Generation section below.\r\n\r\nIf the signing private key is all zeros, \r\nthe [Offline Signature](https://geti2p.net/en/docs/spec/common-structures#struct_OfflineSignature) \r\nsection follows....\r\n```\r\n\r\nAnd there's more near the bottom in the 'Destination Key Generation' section of https://geti2p.net/en/docs/api/samv3\r\n\r\nYou're not using offline signatures so you can skip that part.\r\n\r\nI can't really answer your question about \"trust\" in SAM. It probably won't send you bad input, and in most cases you can treat the private key as an opaque string without \"validation\". So as long as you don't corrupt it when you store and retrieve it, you should be fine. But it's up to you.",
      "created_at" : "2023-10-23T12:16:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775063452",
      "id" : 1775063452,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pzVGc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775063452/reactions"
      },
      "updated_at" : "2023-10-23T12:18:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775063452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/62618568?v=4",
         "events_url" : "https://api.github.com/users/zzzi2p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/zzzi2p/followers",
         "following_url" : "https://api.github.com/users/zzzi2p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/zzzi2p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/zzzi2p",
         "id" : 62618568,
         "login" : "zzzi2p",
         "node_id" : "MDQ6VXNlcjYyNjE4NTY4",
         "organizations_url" : "https://api.github.com/users/zzzi2p/orgs",
         "received_events_url" : "https://api.github.com/users/zzzi2p/received_events",
         "repos_url" : "https://api.github.com/users/zzzi2p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/zzzi2p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/zzzi2p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/zzzi2p"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Ah, correction, OP is a bitcoin crash not a i2pd crash, apologies to @orignal",
      "created_at" : "2023-10-23T12:23:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775075623",
      "id" : 1775075623,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585pzYEn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775075623/reactions"
      },
      "updated_at" : "2023-10-23T12:23:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775075623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/62618568?v=4",
         "events_url" : "https://api.github.com/users/zzzi2p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/zzzi2p/followers",
         "following_url" : "https://api.github.com/users/zzzi2p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/zzzi2p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/zzzi2p",
         "id" : 62618568,
         "login" : "zzzi2p",
         "node_id" : "MDQ6VXNlcjYyNjE4NTY4",
         "organizations_url" : "https://api.github.com/users/zzzi2p/orgs",
         "received_events_url" : "https://api.github.com/users/zzzi2p/received_events",
         "repos_url" : "https://api.github.com/users/zzzi2p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/zzzi2p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/zzzi2p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/zzzi2p"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368628730"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368628730"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n    return std::move(binary);\r\n```\r\n\r\n(requires `#include <utility>`)",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-23T13:03:45Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\n+    }\n+\n+    if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {\n+        throw std::runtime_error(\"Private key too large\");\n+    }\n+\n+    return binary;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368628730",
      "id" : 1368628730,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585Rk536",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 90,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : 14,
      "pull_request_review_id" : 1692484042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368628730/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-23T15:48:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368628730",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368632024"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368632024"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I find the name a bit misleading as we're not modifying the private key, I'd prefer `ValidatePrivKey{Size}` instead\r\n\r\n```suggestion\r\nstatic Binary ValidatePrivKeySize(Binary&& binary)\r\n```",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-23T13:06:19Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368632024",
      "id" : 1368632024,
      "line" : 80,
      "node_id" : "PRRC_kwDOABII585Rk6rY",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 80,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : 4,
      "pull_request_review_id" : 1692484042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368632024/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-23T15:47:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368632024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368633060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368633060"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: since they're mutually exclusive, I think else if would make that more clear\r\n\r\n```suggestion\r\n    } else if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {\r\n```",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-23T13:07:07Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\n+    }\n+\n+    if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368633060",
      "id" : 1368633060,
      "line" : 86,
      "node_id" : "PRRC_kwDOABII585Rk67k",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 86,
      "original_position" : 10,
      "original_start_line" : 84,
      "path" : "src/i2p.cpp",
      "position" : 10,
      "pull_request_review_id" : 1692484042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368633060/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 84,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-23T15:47:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368633060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368642646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368642646"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could also use `static const Binary& ValidatePrivKeySize(const Binary& binary LIFETIMEBOUND)` (requires `#include <attributes.h>`) to highlight the constness of `binary` and make the fn accept both lvalues and rvalues? I think this approach would have my preference, but I'm okay with either.",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-23T13:12:48Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368642646",
      "id" : 1368642646,
      "in_reply_to_id" : 1368632024,
      "line" : 80,
      "node_id" : "PRRC_kwDOABII585Rk9RW",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 80,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : 4,
      "pull_request_review_id" : 1692484042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368642646/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-23T15:47:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368642646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> To what extent is the proxy trusted, and to what extent is it required to validate inputs from it? I think it would be good to first document that and then design unit and fuzz tests based on that design assumption?\r\n\r\nWouldn't it be best to write error handling code / tests on the assumption that no external input source should be able to cause memory corruption within `bitcoind` - including trusted ones, like the datadir?",
      "created_at" : "2023-10-23T15:13:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775432406",
      "id" : 1775432406,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585p0vLW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 3,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 3,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775432406/reactions"
      },
      "updated_at" : "2023-10-23T15:13:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775432406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In any case, I don't think this is a blocker for rc1. It is not a regression and this diff can be added to rc2 trivially.",
      "created_at" : "2023-10-24T08:06:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1776724021",
      "id" : 1776724021,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585p5qg1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1776724021/reactions"
      },
      "updated_at" : "2023-10-24T08:06:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1776724021",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1370087750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370087750"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it would be better to do the check just before doing the offensive operation. Consider:\r\n\r\n```cpp\r\nvoid f()\r\n{\r\n    if (x >= a.size()) {\r\n        return or throw (dont continue below)\r\n    }\r\n    a[x] = 0;\r\n```\r\nvs\r\n```cpp\r\nvoid f()\r\n{\r\n    a[x] = 0; // it is not immediately obvious if x has been checked\r\n\r\n...\r\n\r\n// somewhere else in the code\r\nif (x >= a.size()) {\r\n    // make sure f() is not called\r\n}\r\n// but new code or a refactor could end up calling f() nevertheless\r\n```\r\n\r\nThe following is shorter and I find it safer and it also avoids using magic numbers (+ unit test):\r\n\r\n```diff\r\ndiff --git i/src/i2p.cpp w/src/i2p.cpp\r\nindex 05a5dde396..685b43ba18 100644\r\n--- i/src/i2p.cpp\r\n+++ w/src/i2p.cpp\r\n@@ -381,17 +381,32 @@ Binary Session::MyDestination() const\r\n     // \"They are 387 bytes plus the certificate length specified at bytes 385-386, which may be\r\n     // non-zero\"\r\n     static constexpr size_t DEST_LEN_BASE = 387;\r\n     static constexpr size_t CERT_LEN_POS = 385;\r\n \r\n     uint16_t cert_len;\r\n+\r\n+    if (m_private_key.size() < CERT_LEN_POS + sizeof(cert_len)) {\r\n+        throw std::runtime_error(strprintf(\"The private key is too short (%d < %d)\",\r\n+                                           m_private_key.size(),\r\n+                                           CERT_LEN_POS + sizeof(cert_len)));\r\n+    }\r\n+\r\n     memcpy(&cert_len, &m_private_key.at(CERT_LEN_POS), sizeof(cert_len));\r\n     cert_len = be16toh(cert_len);\r\n \r\n     const size_t dest_len = DEST_LEN_BASE + cert_len;\r\n \r\n+    if (dest_len > m_private_key.size()) {\r\n+        throw std::runtime_error(strprintf(\"Certificate length (%d) designates that the private key should \"\r\n+                                           \"be %d bytes, but it is only %d bytes\",\r\n+                                           cert_len,\r\n+                                           dest_len,\r\n+                                           m_private_key.size()));\r\n+    }\r\n+\r\n     return Binary{m_private_key.begin(), m_private_key.begin() + dest_len};\r\n }\r\n \r\n void Session::CreateIfNotCreatedAlready()\r\n {\r\n     std::string errmsg;\r\ndiff --git i/src/test/i2p_tests.cpp w/src/test/i2p_tests.cpp\r\nindex 5b8b0e9215..d6bbe4fa8f 100644\r\n--- i/src/test/i2p_tests.cpp\r\n+++ w/src/test/i2p_tests.cpp\r\n@@ -6,12 +6,13 @@\r\n #include <i2p.h>\r\n #include <logging.h>\r\n #include <netaddress.h>\r\n #include <test/util/logging.h>\r\n #include <test/util/net.h>\r\n #include <test/util/setup_common.h>\r\n+#include <util/readwritefile.h>\r\n #include <util/threadinterrupt.h>\r\n \r\n #include <boost/test/unit_test.hpp>\r\n \r\n #include <memory>\r\n #include <string>\r\n@@ -122,7 +123,51 @@ BOOST_AUTO_TEST_CASE(listen_ok_accept_fail)\r\n         ASSERT_DEBUG_LOG(\"Destroying SAM session\");\r\n         BOOST_REQUIRE(session.Listen(conn));\r\n         BOOST_REQUIRE(!session.Accept(conn));\r\n     }\r\n }\r\n \r\n+BOOST_AUTO_TEST_CASE(damaged_private_key)\r\n+{\r\n+    const auto CreateSockOrig = CreateSock;\r\n+\r\n+    CreateSock = [](const CService&) {\r\n+        return std::make_unique<StaticContentsSock>(\"HELLO REPLY RESULT=OK VERSION=3.1\\n\"\r\n+                                                    \"SESSION STATUS RESULT=OK DESTINATION=\\n\");\r\n+    };\r\n+\r\n+    const auto i2p_private_key_file = gArgs.GetDataDirNet() / \"test_i2p_private_key_damaged\";\r\n+\r\n+    for (const auto& [file_contents, expected_error] : std::vector<std::tuple<std::string, std::string>>{\r\n+             {\"\", \"The private key is too short (0 < 387)\"},\r\n+\r\n+             {\"abcd\", \"The private key is too short (4 < 387)\"},\r\n+\r\n+             {std::string(386, '\\0'), \"The private key is too short (386 < 387)\"},\r\n+\r\n+             {std::string(385, '\\0') + '\\0' + '\\1',\r\n+              \"Certificate length (1) designates that the private key should be 388 bytes, but it is only \"\r\n+              \"387 bytes\"},\r\n+\r\n+             {std::string(385, '\\0') + '\\0' + '\\5' + \"abcd\",\r\n+              \"Certificate length (5) designates that the private key should be 392 bytes, but it is only \"\r\n+              \"391 bytes\"}}) {\r\n+\r\n+        BOOST_REQUIRE(WriteBinaryFile(i2p_private_key_file, file_contents));\r\n+\r\n+        CThreadInterrupt interrupt;\r\n+        i2p::sam::Session session(i2p_private_key_file, CService{}, &interrupt);\r\n+\r\n+        {\r\n+            ASSERT_DEBUG_LOG(\"Creating persistent SAM session\");\r\n+            ASSERT_DEBUG_LOG(expected_error);\r\n+\r\n+            i2p::Connection conn;\r\n+            bool proxy_error;\r\n+            BOOST_CHECK(!session.Connect(CService{}, conn, proxy_error));\r\n+        }\r\n+    }\r\n+\r\n+    CreateSock = CreateSockOrig;\r\n+}\r\n+\r\n BOOST_AUTO_TEST_SUITE_END()\r\n```",
      "commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "created_at" : "2023-10-24T12:34:58Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1370087750",
      "id" : 1370087750,
      "line" : 82,
      "node_id" : "PRRC_kwDOABII585RqeFG",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 82,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : 6,
      "pull_request_review_id" : 1694729744,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370087750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-24T12:35:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370087750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1371165070"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371165070"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> The following is shorter and I find it safer and it also avoids using magic numbers (+ unit test)\r\n\r\nNice! (and unit test ð)",
      "commit_id" : "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "created_at" : "2023-10-25T05:17:00Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1371165070",
      "id" : 1371165070,
      "in_reply_to_id" : 1370087750,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585RulGO",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 82,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : null,
      "pull_request_review_id" : 1696386555,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371165070/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-25T05:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371165070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1373399307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1373399307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Very nice, thank you!",
      "commit_id" : "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "created_at" : "2023-10-26T15:55:40Z",
      "diff_hunk" : "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1373399307",
      "id" : 1373399307,
      "in_reply_to_id" : 1370087750,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585R3GkL",
      "original_commit_id" : "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "original_line" : 82,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : null,
      "pull_request_review_id" : 1700002703,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1373399307/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-26T15:55:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1373399307",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-10-27T14:23:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1783006261",
      "id" : 1783006261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585qRoQ1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1783006261/reactions"
      },
      "updated_at" : "2023-10-27T14:23:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1783006261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "code lgtm ACK 5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "created_at" : "2023-10-30T12:20:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1785068400",
      "id" : 1785068400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585qZftw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1785068400/reactions"
      },
      "updated_at" : "2023-10-30T12:20:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1785068400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Backported to 26.x in #28754.",
      "created_at" : "2023-10-30T13:53:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1785252088",
      "id" : 1785252088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
      "node_id" : "IC_kwDOABII585qaMj4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1785252088/reactions"
      },
      "updated_at" : "2023-10-30T13:53:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1785252088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
