[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28616).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/28616#pullrequestreview-1678529596) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "created_at" : "2023-10-09T09:47:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1752685932",
      "id" : 1752685932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585od91s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752685932/reactions"
      },
      "updated_at" : "2023-10-29T14:41:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752685932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There's a glitch in this implementation though, probably not a big deal in practice. Because it relies on `blockConnected` to update the icon, if you restart the node during background sync, then the transaction will show as fully confirmed briefly - until the next block is connected.\r\n\r\nSimilarly, once background sync finishes, it will show as partially confirmed until a new block comes in. Since we don't show background validation progress yet in the GUI, this glitch would only be noticed by someone looking at the log.\r\n\r\nNot sure how involved fixing that is.",
      "created_at" : "2023-10-09T09:50:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1752693617",
      "id" : 1752693617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585od_tx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752693617/reactions"
      },
      "updated_at" : "2023-10-09T09:52:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752693617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> `* =` in the current implementation this involves giving someone a malicious binary or getting them to recompile\r\n\r\nNot sure if this pull request is needed then.\r\n\r\nIf someone is running a malicious binary or malicious code, the malicious actor will have this code removed from the binary or code.\r\n\r\nI think this is only needed when the the utxo hash is added as a config option, so my suggestion would be to close this pull and include it in the pull that makes this an option.",
      "created_at" : "2023-10-09T10:19:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1752736130",
      "id" : 1752736130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585oeKGC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752736130/reactions"
      },
      "updated_at" : "2023-10-09T10:19:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752736130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> If someone is running a malicious binary or malicious code\r\n\r\nThey'd just add code to sweep the wallet.\r\n\r\nThere's also the (remote) possibility of Bitcoin Core shipping an otherwise valid binary with just a bad hash (accidentally or otherwise).\r\n\r\nI think it's reasonable to have _some_ UI differentiator between before and after the background check is finished. There's a difference between your node having validated every block and other people having vouched for the blocks.\r\n\r\nThat could also be a warning message (which would be followed by a crash if background sync completes and finds a different UTXO set). But this seems a bit less alarmist. Until you receive coins, there's no risk anyway.",
      "created_at" : "2023-10-09T12:02:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1752879978",
      "id" : 1752879978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585oetNq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752879978/reactions"
      },
      "updated_at" : "2023-10-09T12:16:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752879978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1350228491"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350228491"
         }
      },
      "author_association" : "MEMBER",
      "body" : "be2be21d1740966325213258151d7f3477b19e1e: if #28608 lands first, this would check `role.validated` and `role.most_work` instead (cc @ryanofsky)",
      "commit_id" : "fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4",
      "created_at" : "2023-10-09T12:15:36Z",
      "diff_hunk" : "@@ -1468,12 +1468,30 @@ void CWallet::transactionRemovedFromMempool(const CTransactionRef& tx, MemPoolRe\n \n void CWallet::blockConnected(ChainstateRole role, const interfaces::BlockInfo& block)\n {\n-    if (role == ChainstateRole::BACKGROUND) {\n-        return;\n-    }\n     assert(block.data);\n     LOCK(cs_wallet);\n \n+    switch (role) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1350228491",
      "id" : 1350228491,
      "line" : 1474,
      "node_id" : "PRRC_kwDOABII585QetoL",
      "original_commit_id" : "be2be21d1740966325213258151d7f3477b19e1e",
      "original_line" : 1474,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 10,
      "pull_request_review_id" : 1664320238,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350228491/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-09T12:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350228491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1359690548"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359690548"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Conditions were covered by the `switch` above.\r\n```suggestion\r\n```",
      "commit_id" : "fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4",
      "created_at" : "2023-10-15T00:08:10Z",
      "diff_hunk" : "@@ -1468,12 +1468,30 @@ void CWallet::transactionRemovedFromMempool(const CTransactionRef& tx, MemPoolRe\n \n void CWallet::blockConnected(ChainstateRole role, const interfaces::BlockInfo& block)\n {\n-    if (role == ChainstateRole::BACKGROUND) {\n-        return;\n-    }\n     assert(block.data);\n     LOCK(cs_wallet);\n \n+    switch (role) {\n+        case ChainstateRole::BACKGROUND:\n+            m_background_validation_height = block.height;\n+            return;\n+        case ChainstateRole::ASSUMEDVALID:\n+            if (m_background_validation_height == -1) {\n+                m_background_validation_height = 0;\n+            }\n+            break;\n+        case ChainstateRole::NORMAL:\n+            m_background_validation_height = -1;\n+            break;\n+    } // no default case, so the compiler can warn about missing cases\n+\n+    if (role == ChainstateRole::BACKGROUND) {\n+        m_background_validation_height = block.height;\n+        return;\n+    } else if (role == ChainstateRole::NORMAL) {\n+        m_background_validation_height = -1;\n+    } else {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1359690548",
      "id" : 1359690548,
      "line" : 1493,
      "node_id" : "PRRC_kwDOABII585RCzs0",
      "original_commit_id" : "fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4",
      "original_line" : 1493,
      "original_position" : 29,
      "original_start_line" : 1488,
      "path" : "src/wallet/wallet.cpp",
      "position" : 29,
      "pull_request_review_id" : 1678529596,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359690548/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1488,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-15T00:19:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359690548",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1359691870"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359691870"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "On the`gui:` comit fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4, was this unintentional?",
      "commit_id" : "fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4",
      "created_at" : "2023-10-15T00:25:12Z",
      "diff_hunk" : "@@ -3376,7 +3376,6 @@ bool CWallet::IsTxAssumed(const CWalletTx& wtx) const EXCLUSIVE_LOCKS_REQUIRED(c\n     return false;\n }\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1359691870",
      "id" : 1359691870,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585RC0Be",
      "original_commit_id" : "fff5cb42dfe91ce1ba1a1aa2269253f262c6e2b4",
      "original_line" : 3379,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 1678530676,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359691870/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-15T00:28:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359691870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think it's reasonable to have _some_ UI differentiator between before and after the background check is finished. There's a difference between your node having validated every block and other people having vouched for the blocks.\r\n\r\nAre you aware of the RPC call to get the state, which can be accessed via the UI. I think it should be obvious to the user that they loaded an utxo set, after they used the loadutxoset RPC call?\r\n\r\nNo objection to adding something to the GUI, but I don't think the wallet is the right place.\r\n\r\n> Until you receive coins, there's no risk anyway.\r\n\r\nCan you explain this? It is possible to attach a wallet over P2P to a node that has no wallet compiled in. To me, whatever code you are trying to write here, putting it in the wallet doesn't seem right.",
      "created_at" : "2023-10-16T15:31:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1764748628",
      "id" : 1764748628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585pL-1U",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1764748628/reactions"
      },
      "updated_at" : "2023-10-16T15:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1764748628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">> Until you receive coins, there's no risk anyway.\r\n> Can you explain this?\r\n\r\nThe only thing a GUI wallet user can do is generate an address. This is safe whether or not IBD and background sync are complete, and regardless of if the snapshot hash was valid. Once they receive coins on that address it's useful to know if these coins are in their mempool, confirmed in a block but pending background sync, or confirmed in a fully validated chain.\r\n\r\n> attach a wallet over P2P to a node that has no wallet compiled in\r\n\r\nThere's no p2p message to communicate background validation state.\r\n\r\nA wallet that's connected over IPC (see #19461) should figure out it's own handling of this. The way process seperation is designed at the moment, I believe you can only connect the GUI to a remote Node + Wallet combo, so this PR would work. I.e. you can connect a GUI + wallet to a remote node, that would require rethinking the interface.\r\n\r\nI also don't think it's a good idea to make the GUI do more independent reasoning, e.g. taking confirmation height from the wallet interface, the background sync state from the node interface and then determining what to display. \r\n\r\n> Are you aware of the RPC call to get the state, which can be accessed via the UI.\r\n\r\nI assume we'll add a GUI menu option to load the snapshot soon enough. At that point relying on users calling an RPC method and interpreting the result, doesn't seem like a good idea. It's also safer to not rely on the user proactively checking if the background sync is done. Rather with this PR, they will see that the transaction is not fully confirmed, and if they're curious they can look at that RPC method.\r\n\r\n> putting it in the wallet doesn't seem right.\r\n\r\nI think we need to access background sync information in two places:\r\n1. The GUI sync progress indicator(s) \r\n2. The wallet\r\n\r\n(1) is independent of the wallet and not implemented in this PR. I don't think it would be sufficient. We should not expect users to automatically understand that a background sync in progress has implications for a confirmed transaction near the tip.",
      "created_at" : "2023-10-23T08:11:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1774651823",
      "id" : 1774651823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585pxwmv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774651823/reactions"
      },
      "updated_at" : "2023-10-23T08:11:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774651823",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> also specify it in the rpc command `listtransactions` output\r\n\r\nI'll look into that.",
      "created_at" : "2023-10-23T08:13:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1774654821",
      "id" : 1774654821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585pxxVl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774654821/reactions"
      },
      "updated_at" : "2023-10-23T08:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774654821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > attach a wallet over P2P to a node that has no wallet compiled in\r\n> \r\n> There's no p2p message to communicate background validation state.\r\n\r\nI mean a wallet attached over P2P, not a full node. For example, https://bitcoinops.org/en/topics/transaction-bloom-filtering/ or similar. Not sure if this is still a use case, or if it is possible, but I don't see why not?",
      "created_at" : "2023-10-23T08:26:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1774678621",
      "id" : 1774678621,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585px3Jd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774678621/reactions"
      },
      "updated_at" : "2023-10-23T08:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774678621",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I would expect that a wallet that connects to us over (untrusted) p2p will get the exact same info regardless of background validation progress.",
      "created_at" : "2023-11-01T02:05:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1788285499",
      "id" : 1788285499,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585qlxI7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1788285499/reactions"
      },
      "updated_at" : "2023-11-01T02:05:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1788285499",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384403599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384403599"
         }
      },
      "author_association" : "MEMBER",
      "body" : "82f19c7e97281bbd66a25e53f30fe2f80a4f9d11: I found this while loading an existing wallet into a fresh (signet) node, while it was doing the background sync. That's not a very common scenario, so I haven't bothered looking into deeper causes...",
      "commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "created_at" : "2023-11-07T05:33:44Z",
      "diff_hunk" : "@@ -22,16 +22,23 @@ static void WalletTxToJSON(const CWallet& wallet, const CWalletTx& wtx, UniValue\n     entry.pushKV(\"confirmations\", confirms);\n     if (wtx.IsCoinBase())\n         entry.pushKV(\"generated\", true);\n-    if (auto* conf = wtx.state<TxStateConfirmed>())\n-    {\n+    if (auto* conf = wtx.state<TxStateConfirmed>()) {\n         entry.pushKV(\"blockhash\", conf->confirmed_block_hash.GetHex());\n         entry.pushKV(\"blockheight\", conf->confirmed_block_height);\n         entry.pushKV(\"blockindex\", conf->position_in_block);\n         int64_t block_time;\n         CHECK_NONFATAL(chain.findBlock(conf->confirmed_block_hash, FoundBlock().time(block_time)));\n         entry.pushKV(\"blocktime\", block_time);\n+        if (chain.hasAssumedValidChain()) {\n+            entry.pushKV(\"assumed\", wallet.IsTxAssumed(wtx));\n+        }\n     } else {\n         entry.pushKV(\"trusted\", CachedTxIsTrusted(wallet, wtx));\n+        // This can happen when loading a wallet from another node,\n+        // while still in (background) IBD:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384403599",
      "id" : 1384403599,
      "line" : 38,
      "node_id" : "PRRC_kwDOABII585ShFKP",
      "original_commit_id" : "82f19c7e97281bbd66a25e53f30fe2f80a4f9d11",
      "original_line" : 38,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/transactions.cpp",
      "position" : 19,
      "pull_request_review_id" : 1716856196,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384403599/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-07T05:33:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384403599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384405176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384405176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "82f19c7e97281bbd66a25e53f30fe2f80a4f9d11: such a test seems hard to write without a (background sync aware) `stopatheight` RPC. So far I just tested manually that the value is correct: absent before loading a snapshot, `true` while background sync is below it, `false` once background sync passed the confirmation height.",
      "commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "created_at" : "2023-11-07T05:36:23Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384405176",
      "id" : 1384405176,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585ShFi4",
      "original_commit_id" : "82f19c7e97281bbd66a25e53f30fe2f80a4f9d11",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1716858650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384405176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-07T05:36:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384405176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I would expect that a wallet that connects to us over (untrusted) p2p will get the exact same info regardless of background validation progress.\r\n\r\nassumeutxo allows blocks and the mempool to be based on top of the assumed utxo set, so transactions from those blocks and that mempool can be sent on p2p. I am pretty sure that this mempool does not have \"the exact same info regardless of background validation progress.\"",
      "created_at" : "2023-11-07T08:50:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1798060231",
      "id" : 1798060231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rLDjH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798060231/reactions"
      },
      "updated_at" : "2023-11-07T08:50:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798060231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There's no way for a node to tell its peers that the mempool transactions its relaying rely on an assumed state. The same goes for block relay. Are you suggesting we should change the p2p protocol to add this information?",
      "created_at" : "2023-11-07T10:52:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1798267555",
      "id" : 1798267555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rL2Kj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798267555/reactions"
      },
      "updated_at" : "2023-11-07T10:52:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798267555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, I am saying, as explained in my first comment, that this pull request isn't needed. If it was needed, a reason should be given in the pull request description. So far I haven't seen a valid reason, reading the whole thread.",
      "created_at" : "2023-11-07T11:43:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1798342200",
      "id" : 1798342200,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rMIY4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798342200/reactions"
      },
      "updated_at" : "2023-11-07T11:43:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798342200",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maflcko I copy-pasted @luke-jr's comment in the PR description, if that helps?",
      "created_at" : "2023-11-07T12:04:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1798372461",
      "id" : 1798372461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rMPxt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798372461/reactions"
      },
      "updated_at" : "2023-11-07T12:04:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798372461",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Before the background sync is finished, we can only check the proof-of-work for new blocks and a few other rules. It's better than SPV, but not the same as knowing the transaction is in a fully validated block. We should display that difference somehow.",
      "created_at" : "2023-11-07T12:31:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1798410685",
      "id" : 1798410685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rMZG9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798410685/reactions"
      },
      "updated_at" : "2023-11-07T12:32:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798410685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384865925"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384865925"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think wallet tests should be separate from consensus tests. Also, it would be good to check what happens if loading a wallet file from a backup, whose transactions happened before the utxo snapshot.",
      "commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "created_at" : "2023-11-07T12:53:22Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1384865925",
      "id" : 1384865925,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585Si2CF",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1717608294,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384865925/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-07T12:53:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1384865925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1386694325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1386694325"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Did that for fun (in the wrong test file), and it prints the error message:\r\n\r\n```\r\ntest_framework.authproxy.JSONRPCException: Wallet loading failed. Error loading wallet. Wallet requires blocks to be downloaded, and software does not currently support loading wallets while blocks are being downloaded out of order when using assumeutxo snapshots. Wallet should be able to load successfully after node sync reaches height 299 (-4)\r\n```\r\n\r\nHacky diff:\r\n\r\n```diff\r\ndiff --git a/test/functional/feature_assumeutxo.py b/test/functional/feature_assumeutxo.py\r\nindex ab2e6c4d0b..c54c650532 100755\r\n--- a/test/functional/feature_assumeutxo.py\r\n+++ b/test/functional/feature_assumeutxo.py\r\n@@ -48,7 +48,8 @@ COMPLETE_IDX = {'synced': True, 'best_block_height': FINAL_HEIGHT}\r\n \r\n \r\n class AssumeutxoTest(BitcoinTestFramework):\r\n-\r\n+    def add_options(self, parser):\r\n+        self.add_wallet_options(parser, legacy=False)\r\n     def set_test_params(self):\r\n         \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\r\n         self.num_nodes = 3\r\n@@ -143,6 +144,11 @@ class AssumeutxoTest(BitcoinTestFramework):\r\n \r\n         self.sync_blocks()\r\n \r\n+        n0.createwallet('test',blank=True, disable_private_keys=True, descriptors=True)\r\n+        w = n0.get_wallet_rpc(\"test\")\r\n+\r\n+        w.importdescriptors([{\"desc\":\"addr(mjTkW3DjgyZck4KbiRusZsqTgaYTxdSz6z)#jdtmxdcm\",\"timestamp\":0,\"label\":\"det_coinbase_key_0\"}])\r\n+\r\n         # Generate a series of blocks that `n0` will have in the snapshot,\r\n         # but that n1 doesn't yet see. In order for the snapshot to activate,\r\n         # though, we have to ferry over the new headers to n1 so that it\r\n@@ -160,6 +166,8 @@ class AssumeutxoTest(BitcoinTestFramework):\r\n         for n in self.nodes:\r\n             assert_equal(n.getblockchaininfo()[\"headers\"], SNAPSHOT_BASE_HEIGHT)\r\n \r\n+        w.backupwallet(\"/tmp/abc.dat\")\r\n+\r\n         self.log.info(\"-- Testing assumeutxo + some indexes + pruning\")\r\n \r\n         assert_equal(n0.getblockcount(), SNAPSHOT_BASE_HEIGHT)\r\n@@ -201,6 +209,8 @@ class AssumeutxoTest(BitcoinTestFramework):\r\n \r\n         assert_equal(n1.getblockchaininfo()[\"blocks\"], SNAPSHOT_BASE_HEIGHT)\r\n \r\n+        n1.restorewallet(\"hi\", \"/tmp/abc.dat\")\r\n+\r\n         PAUSE_HEIGHT = FINAL_HEIGHT - 40\r\n \r\n         self.log.info(\"Restarting node to stop at height %d\", PAUSE_HEIGHT)\r\n",
      "commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "created_at" : "2023-11-08T14:18:23Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1386694325",
      "id" : 1386694325,
      "in_reply_to_id" : 1384865925,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585Sp0a1",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1720469589,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1386694325/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-08T14:26:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1386694325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387351444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387351444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Interesting that you're getting that error when loading from a backup, but not when loading a regular wallet.",
      "commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "created_at" : "2023-11-09T00:45:39Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387351444",
      "id" : 1387351444,
      "in_reply_to_id" : 1384865925,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585SsU2U",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1721506539,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387351444/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T00:45:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387351444",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased to see if the asserts added in #28546 catch anything here. (They don't in the test suite and manual testing).",
      "created_at" : "2023-11-09T01:00:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#issuecomment-1802999311",
      "id" : 1802999311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28616",
      "node_id" : "IC_kwDOABII585rd5YP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1802999311/reactions"
      },
      "updated_at" : "2023-11-09T01:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1802999311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387360904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387360904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I think wallet tests should be separate from consensus tests.\r\n\r\nThat makes sense.\r\n",
      "commit_id" : "d503d272cbc0eb7b25fbeff1fdf632981841f32c",
      "created_at" : "2023-11-09T01:01:09Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387360904",
      "id" : 1387360904,
      "in_reply_to_id" : 1384865925,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585SsXKI",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1721519902,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387360904/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T01:01:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387360904",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387417011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387417011"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added a wallet test file here: 59796c3926cb146229a2b3e942a5f6994f27d72a\r\n\r\nIt made me realise we should probably disallow loading a wallet with a birth date below the assume valid block. Though for manual testing it's handy.",
      "commit_id" : "d503d272cbc0eb7b25fbeff1fdf632981841f32c",
      "created_at" : "2023-11-09T02:39:16Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387417011",
      "id" : 1387417011,
      "in_reply_to_id" : 1384865925,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ssk2z",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1721595959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387417011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T02:39:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387417011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387466566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387466566"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm still trying to wrap my head around the logic in `CWallet::AttachChain` which is what triggers the error when loading a backup, but somehow doesn't trigger it when loading an existing wallet. In any case, improving that seems orthogonal to this PR.\r\n\r\nMy guess is that the backup triggers a rescan from the wallet birth date, whereas loading an existing wallet only rescans from where it last left off. In case of the wallet I tested with, that was already synced well beyond the snapshot height - so it would only rescan from there to the tip. That's probably correct behavior.",
      "commit_id" : "2d3b23fb49ed1b44eef69e340b48c24228a7f33e",
      "created_at" : "2023-11-09T04:22:02Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387466566",
      "id" : 1387466566,
      "in_reply_to_id" : 1384865925,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ssw9G",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1721667074,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387466566/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T04:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387466566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387468948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387468948"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh I see, the test creates the backup _before_ the snapshot height. It's probably worth testing that _as well as_ a backup that was made _after_ the snapshot height.",
      "commit_id" : "2d3b23fb49ed1b44eef69e340b48c24228a7f33e",
      "created_at" : "2023-11-09T04:27:14Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387468948",
      "id" : 1387468948,
      "in_reply_to_id" : 1384865925,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585SsxiU",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1721670517,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387468948/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T04:28:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387468948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387470744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387470744"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As for the behavior that this PR introduces, ideally there would a `stopatheight` RPC, but the test could also - as it does now - use `-stopatheight` and restart the node. Since it won't automatically connect to the other test nodes, we can inspect the result of `getwallettransactions` and see if `assumed` is set correctly.\r\n\r\nI'll work on that and make it a separate commit, so it's a bit easier to extract the test scaffold if this PR doesn't make it.",
      "commit_id" : "2d3b23fb49ed1b44eef69e340b48c24228a7f33e",
      "created_at" : "2023-11-09T04:31:15Z",
      "diff_hunk" : "@@ -12,6 +12,9 @@\n ## Possible test improvements\n \n - TODO: test submitting a transaction and verifying it appears in mempool\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28616#discussion_r1387470744",
      "id" : 1387470744,
      "in_reply_to_id" : 1384865925,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ssx-Y",
      "original_commit_id" : "9325f1e1d5beeb5082470728d49710c67952710c",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1721673905,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28616",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387470744/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-09T04:31:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1387470744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
