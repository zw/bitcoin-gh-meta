{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "Inspired by https://github.com/bitcoin/bitcoin/pull/27446, this PR implements the proposal detailed in the comment https://github.com/bitcoin/bitcoin/pull/27446#issuecomment-1516600820.\r\n\r\n## Rationale\r\n\r\nIntroduce the ability to configure a custom target time between blocks in a custom Bitcoin signet network. This enhancement enables users to create a signet that is more conducive to testing. The change enhances the flexibility of signet, rendering it more versatile for various testing scenarios. For instance, I am currently working on setting up a signet with a 30-second block time. However, this caused numerous difficulty adjustments, resulting in an inconsistent network state. Regtest isn't a viable alternative for me in this context since we prefer defaults to utilize our custom signet when configured, without impeding local regtest development.\r\n\r\n## Implementation\r\n\r\nIf the challenge format is `OP_RETURN PUSHDATA<params> PUSHDATA<actual challenge>`, the actual challenge from the second data push is used as the signet challenge, and the parameters from the first push are used to configure the network. Otherwise the challenge is used as is.\r\n\r\nThis change is backward-compatible, as per the old rules, such a signet challenge would always evaluate to false, rendering it unused.\r\n\r\nThe only parameter currently available is \"target_spacing\" (default 600 seconds). To set it, place `0x01<target_spacing as uint64_t, little endian>` in the params. Empty params are also valid. If other network parameters are added in the future, they should use `0x02<option 2 value>`, `0x03<option 3 value>`, etc., following the protobuf style.\r\n\r\nTwo public functions were added to `chainparams.h`:\r\n  - `ParseWrappedSignetChallenge`: Extracts signet params and signet challenge from a wrapped signet challenge.\r\n  - `ParseSignetParams`: Parses `<params>` bytes of the first data push.\r\n\r\nFunction `ReadSigNetArgs` calls `ParseWrappedSignetChallenge` and `ParseSignetParams` to implement the new meaning of signetchallenge.\r\n\r\nThe description of the flag `-signetchallenge` was updated to reflect the changes.\r\n\r\nA new unit tests file, `chainparams_tests.cpp`, was added, containing tests for `ParseWrappedSignetChallenge` and `ParseSignetParams`.\r\n\r\nThe test `signet_parse_tests` from the file `validation_tests.cpp` was modified to ensure proper understanding of the new logic.\r\n\r\nIn the functional test `feature_signet.py`, the value of `-signetchallenge` was changed from `OP_TRUE` to the wrapped challenge, setting spacing to 30 seconds and having the same actual challenge `OP_TRUE`.\r\n\r\nThe Signet miner was updated, introducing a new option `--target-spacing` with a default of 600 seconds. It must be set to the value used by the network.\r\n\r\n## Example\r\n\r\nI tested this PR against [Mutinynet](https://blog.mutinywallet.com/mutinynet/), a signet running on a custom fork of Bitcoin Core, implementing 30s target spacing. I successfully synchronized the blockchain using the following config:\r\n\r\n```\r\nsignet=1\r\n[signet]\r\nsignetchallenge=6a4c09011e000000000000004c25512102f7561d208dd9ae99bf497273e16f389bdbd6c4742ddb8e6b216e64fa2928ad8f51ae\r\naddnode=45.79.52.207:38333\r\ndnsseed=0\r\n```\r\n\r\nThe content of this wrapped challenge:\r\n\r\n```\r\n6a OP_RETURN\r\n4c OP_PUSHDATA1\r\n09 (length of signet params = 9)\r\n011e00000000000000 (signet params: 0x01, pow_target_spacing=30)\r\n4c OP_PUSHDATA1\r\n25 (length of challenge = 37)\r\n512102f7561d208dd9ae99bf497273e16f389bdbd6c4742ddb8e6b216e64fa2928ad8f51ae\r\n(original Mutinynet challenge)\r\n```",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365/comments",
   "created_at" : "2024-02-01T16:36:21Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/29365",
   "id" : 2112936124,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585luUZO",
   "number" : 29365,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/29365.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29365",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/29365.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29365"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365/timeline",
   "title" : "Extend signetchallenge to set target block spacing",
   "updated_at" : "2024-02-01T16:36:25Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29365",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/920155?v=4",
      "events_url" : "https://api.github.com/users/starius/events{/privacy}",
      "followers_url" : "https://api.github.com/users/starius/followers",
      "following_url" : "https://api.github.com/users/starius/following{/other_user}",
      "gists_url" : "https://api.github.com/users/starius/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/starius",
      "id" : 920155,
      "login" : "starius",
      "node_id" : "MDQ6VXNlcjkyMDE1NQ==",
      "organizations_url" : "https://api.github.com/users/starius/orgs",
      "received_events_url" : "https://api.github.com/users/starius/received_events",
      "repos_url" : "https://api.github.com/users/starius/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/starius/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/starius/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/starius"
   }
}
