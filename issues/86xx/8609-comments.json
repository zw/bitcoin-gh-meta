[
   {
      "body" : "![screenshot at 2016-08-27 10 05 56](https://cloud.githubusercontent.com/assets/1530283/18024812/e4343386-6c3d-11e6-8d97-8c4ecee4ab5d.png)\r\n\r\nFor example, here is almost the same time period (as seen by the red line) but with dbcache and maxmempool set to double. Bear in mind that these are two different nodes running with different connections, so it might be something the connected nodes are doing that is causing the memory usage to go up (and down?) at different rates.",
      "created_at" : "2016-08-27T03:06:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-242891948",
      "id" : 242891948,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-08-27T03:10:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242891948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "What reason do you have to believe that this isn't perfectly correct?",
      "created_at" : "2016-09-09T08:13:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-245848785",
      "id" : 245848785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-09T08:13:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/245848785",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I don't get it. What is the problem here? The mempool size is a maximum cap, it willuse less than that after e.g. a block comes in and transactions are removed from it.\r\n",
      "created_at" : "2016-09-09T08:37:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-245853757",
      "id" : 245853757,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-09T08:37:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/245853757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Also see #8610, which effectively reassigns the unused portion of the\nmempool for use by the chainstate cache.\n",
      "created_at" : "2016-09-09T08:41:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-245854735",
      "id" : 245854735,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-09T08:41:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/245854735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@laanwj you ask a question, and then close the issue the same day without giving me a chance to answer. Are issues only issues as long as you personally understand them?\r\n\r\nLook at the graph half-way through - there is still a minimum relay fee even though the memory utilization is almost zero. This is the issue - why limit the txs at all when the utilization is almost 0%? Would it not make more sense to continue storing txs and only increase the restrictive criteria once utilization gets close to being 100%?",
      "created_at" : "2016-09-25T03:40:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-249400795",
      "id" : 249400795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-25T03:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/249400795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad One design goal of the limited mempool was to prevent relay of\ntransactions that don't pay for relay.\n\nConsider the following scenario: a peer figures out what the lowest feerate\nof any transaction in your mempool is (call it tx A), and creates a valid\ntransaction with a feerate 1sat/kB than this (call it tx B). If our mempool\nis at its maximum size, and there was no minimum feerate at all, we would\nkick out tx A and accept tx B, effectively replacing it. If this were to\nhappen across the network (for example because there are several nodes with\nthe same mempool size and software), the network as a whole would have\nrelayed tx A without it actually ending up in a block - it effectively\nrelayed across the network for free.\n\nThis could be exploited by anyone who observes the network wide behaviour,\nand produces a series of transactions with very very slowly increasing fee\nonly, which at every node in the network cause the previous transaction to\nbe replaced by the newer one, for effectively ~zero cost. At a large scale,\nthis means someone could use the P2P network to mass relay data everywhere,\nwasting bandwidth and processing time, without paying fees as a deterrent.\n\nTo combat this:\n* There always is a minimum feerate that we demand transactions pay\n(1000/kB currently, far lower than the going network rate, and the same as\nmany versions ago).\n* When a transaction is being kicked out in favor of another transaction\n(whether through RBF or mempool limiting), we always require the feerate of\nthe new one to pay at least the minimum feerate *more* than the kicked-out\none paid. This guarantees that the latest transaction in a chain of\nreplacements always paid for the relay (at minimum feerate level) of all\nprevious evicted transactions before it.\n* After kicking out a transaction, we raise the effective minimum feerate\ntemporarily to avoid using the newly available space (after a new block was\nmined) from being filled with relatively low-feerate transactions that\nnecessitate being evicted again soon after anyway.\n\nAs you can see, for all of these countermeasures, we need an effective\nminimum feerate even when the mempool is not full.\n",
      "created_at" : "2016-09-25T04:48:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-249402662",
      "id" : 249402662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-25T04:48:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/249402662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "> @laanwj you ask a question, and then close the issue the same day without giving me a chance to answer. Are issues only issues as long as you personally understand them?\r\n\r\nClosing issues (in contrast to locking them) doesn't prevent anyone from answering.\r\n\r\nTo keep a lid on the sheer number of issues open, I have to do the thankless job of closing issues that are not clear user problems, but fall into other categories like \"I've noticed this curious behavior and have questions about it\". As I've said to you many times this is an **issue tracker** not a Q&A site.\r\n\r\nThis is also not the place to make other people do your research/investigation for you.",
      "created_at" : "2016-09-25T06:29:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-249405495",
      "id" : 249405495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-09-25T06:29:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/249405495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj I do not see github being used to do other people research/investigation, but I understand that you perceive this. I do not understand why though.\r\n\r\nI think the root cause of this is ultimately lack of documentation. @sipa 's very detailed response, IMHO, ought to be incorporated into such documentation. There is the question of where this documentation ought to best be stored. My answer to that question would be github - with the documentation for the functionality of each pull request being stored against the pull request. Ideally the documentation ought to be submitted with the pull request itself, or in the code as comments, but when this isn't done, then at least, retrospectively might be a suitable alternative.\r\n\r\nPerhaps I am unaware of such documentation that already exists - if so, then the issue, IMHO, would be making it easier for people to find it.",
      "created_at" : "2016-10-04T07:15:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-251312001",
      "id" : 251312001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-10-04T07:15:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/251312001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "> I think the root cause of this is ultimately lack of documentation.\r\n\r\nI agree that there is a lack of documentation. Usually the code is considered the documentation and it becomes clear how something works, but the design principles usually are hidden somewhere else. (Maybe not even publicly accessible)\r\n\r\nFor the protocol and general bitcoin related concepts, we have the Bitcoin Improvement Proposals... For documenting internal logic, you suggested to use github issues and pull requests. I disagree, the design rationale for the internal logic should be placed in properly formatted doxygen comments above each class/method. (We have the problem, that those comments usually outdate very quickly because contributors \"forget\" to update the comments. Unfortunately I don't know of a way to enforce during review that comments need to be updated when the code is changed. Maybe only a maintainer for the specific module could keep it in mind? While not perfect, I still think that documentation should be part of the source code.)",
      "created_at" : "2016-10-04T08:55:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-251332111",
      "id" : 251332111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-10-04T08:55:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/251332111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : ">  While not perfect, I still think that documentation should be part of the source code.\r\n\r\n100% agreed.\r\n\r\nAlso note that while it's easy to forget to update **developer documentation** that is part of the source code, it is even easier to forget to update \"design documents\" that live elsewhere. We actually have a few of those in `doc/`, for example https://github.com/bitcoin/bitcoin/blob/master/doc/multiwallet-qt.md . \r\nOr the list of threads here: https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#threads  . Sufficient to say, both are outdated, though to different degrees.\r\n\r\n**Application user documentation** should probably exist outside the source code, although it can exist as something that can be queried from the program itself. Like the RPC `help`, or `--help` flags. And e.g. a context-sensitive help for the GUI would be nice.\r\n\r\n**Protocol documentation** should exist outside this repository as it is not specific to Bitcoin Core. Examples of this are the BIPs, as well as the excellent [Developer Reference](https://bitcoin.org/en/developer-reference) on bitcoin.org.\r\n",
      "created_at" : "2016-10-04T09:06:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/8609#issuecomment-251334684",
      "id" : 251334684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8609",
      "updated_at" : "2016-10-04T09:06:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/251334684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
