[
   {
      "author_association" : "MEMBER",
      "body" : "So the idea, as I understand, is that this adds compile-time checking capabilities a bit like rust? Yes that's really neat.",
      "created_at" : "2021-10-08T15:59:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23226#issuecomment-938753093",
      "id" : 938753093,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23226",
      "node_id" : "IC_kwDOABII58439DxF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938753093/reactions"
      },
      "updated_at" : "2021-10-08T15:59:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938753093",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Yes, but in this case we're actually opting out of some of those protections because of the semantics of Span. By default, the returned iterator type for a potentially dangling reference is a `std::ranges::dangling`. By opting in to `enable_borrowed_range`, we get a real return type. Otherwise it'd fail to compile the `*iter` dereference in the `printf`. This is also used by `std::string_view`, for example.\r\n\r\nThe `enable_view` seems to be another way of saying pretty much the same thing but for a different semantic reason.\r\n\r\nI found it useful to copy/paste a little cheat-sheet of these concepts from libstdc++'s implementation:\r\n```c++\r\n/// [range.range] The range concept.\r\ntemplate<typename _Tp>\r\n  concept range = requires(_Tp& __t)\r\n    {\r\n  ranges::begin(__t);\r\n  ranges::end(__t);\r\n    };\r\n\r\ntemplate<typename _Tp>\r\n  concept view\r\n    = range<_Tp> && movable<_Tp> && default_initializable<_Tp>\r\n  && enable_view<_Tp>;\r\n\r\n// Part of the constraints of ranges::borrowed_range\r\ntemplate<typename _Tp>\r\n  concept __maybe_borrowed_range\r\n  = is_lvalue_reference_v<_Tp>\r\n    || enable_borrowed_range<remove_cvref_t<_Tp>>;\r\n\r\ntemplate<typename _Tp>\r\n  concept borrowed_range\r\n    = range<_Tp> && __detail::__maybe_borrowed_range<_Tp>;\r\n\r\n/// A range which can be safely converted to a view.\r\ntemplate<typename _Tp>\r\n  concept viewable_range = range<_Tp>\r\n    && (borrowed_range<_Tp> || view<remove_cvref_t<_Tp>>);\r\n```\r\n\r\nIn the above example, enabling `enable_borrowed_range` alone is enough to make both examples compile, because (I believe) the first only requires a `viewable_range`.\r\n\r\n~Interestingly, libstdc++'s definitions line up with the [c++20 final draft spec](https://timsong-cpp.github.io/cppwp/n4861/range.refinements), but [differ from cppreference](https://en.cppreference.com/w/cpp/ranges/viewable_range). I'm assuming that the latter is stale, so it's probably worth using the draft spec for reference for now.~\r\nI actually had this backwards. cppreference incorporates [LWG 3481](https://cplusplus.github.io/LWG/lwg-defects.html#3481), which libstdc++ [includes as of last week](https://github.com/gcc-mirror/gcc/commit/a2c2dcc6ca205a8c5c76b04ef2eb4fb097dcb069) and [P2415R2](https://isocpp.org/files/papers/P2415R2.html), which has not yet been integrated.",
      "created_at" : "2021-10-12T16:07:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23226#issuecomment-941155912",
      "id" : 941155912,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23226",
      "node_id" : "IC_kwDOABII5844GOZI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/941155912/reactions"
      },
      "updated_at" : "2021-10-25T20:06:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/941155912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23413](https://github.com/bitcoin/bitcoin/pull/23413) (Replace MakeSpan helper with Span deduction guide by sipa)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-11-01T22:46:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23226#issuecomment-956794245",
      "id" : 956794245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23226",
      "node_id" : "IC_kwDOABII5845B4WF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956794245/reactions"
      },
      "updated_at" : "2021-11-01T22:46:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956794245",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
