{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "Hi,\n\nI'm running bitcoind both on livenet and on testnet. I daemonize both processes through the -daemon flag. However, I have found that my testnet process keeps dying at irregular intervals.\n\nI looked in ~/Library/Logs/DiagnosticReports/ and found several reports. All of the reports have the same Crashed Thread (13 bitcoin-msghand)\n\n```\nProcess:         bitcoind [68496]\nPath:            /Users/USER/Documents/*/bitcoind\nIdentifier:      bitcoind\nVersion:         0\nCode Type:       X86-64 (Native)\nParent Process:  bash [60948]\nResponsible:     Terminal [306]\nUser ID:         501\n\nDate/Time:       2014-07-30 19:00:00.431 -0400\nOS Version:      Mac OS X 10.9.4 (13E28)\nReport Version:  11\n\nCrashed Thread:  13  bitcoin-msghand\n\nException Type:  EXC_BAD_ACCESS (SIGSEGV)\nException Codes: KERN_INVALID_ADDRESS at 0xfffffffffffffff0\n\nVM Regions Near 0xfffffffffffffff0:\n--> shared memory          00007fffffeb5000-00007fffffeb6000 [    4K] r-x/r-x SM=SHM  \n```\n\nStack Trace:\n\n```\nThread 13 Crashed:: bitcoin-msghand\n0   bitcoind                        0x000000010638b3d7 CMinerPolicyEstimator::seenBlock(std::__1::vector<CTxMemPoolEntry, std::__1::allocator<CTxMemPoolEntry> > const&, int, CFeeRate) + 231 (vector:1536)\n1   bitcoind                        0x0000000106389474 CTxMemPool::removeForBlock(std::__1::vector<CTransaction, std::__1::allocator<CTransaction> > const&, unsigned int, std::__1::list<CTransaction, std::__1::allocator<CTransaction> >&) + 484 (foreach.hpp:580)\n2   bitcoind                        0x0000000106286505 ActivateBestChain(CValidationState&) + 11589 (main.cpp:2008)\n3   bitcoind                        0x000000010628935a ProcessBlock(CValidationState&, CNode*, CBlock*, CDiskBlockPos*) + 1002 (main.cpp:2693)\n4   bitcoind                        0x00000001062907d4 ProcessMessage(CNode*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, CDataStream&, long long) + 1908 (.main.h:987)\n5   bitcoind                        0x0000000106275716 ProcessMessages(CNode*) + 1110 (main.cpp:4291)\n6   bitcoind                        0x00000001062fed5a boost::function1<bool, CNode*>::operator()(CNode*) const + 42 (function_template.hpp:766)\n7   bitcoind                        0x00000001062fece7 boost::signals2::detail::signal1_impl<bool, CNode*, boost::signals2::optional_last_value<bool>, int, std::__1::less<int>, boost::function<bool (CNode*)>, boost::function<bool (boost::signals2::connection const&, CNode*)>, boost::signals2::mutex>::slot_invoker::m_invoke(boost::shared_ptr<boost::signals2::detail::connection_body<std::__1::pair<boost::signals2::detail::slot_meta_group, boost::optional<int> >, boost::signals2::slot1<bool, CNode*, boost::function<bool (CNode*)> >, boost::signals2::mutex> > const&, ...) const + 119 (signal_template.hpp:368)\n8   bitcoind                        0x00000001062feb8b boost::signals2::detail::slot_call_iterator_t<boost::signals2::detail::signal1_impl<bool, CNode*, boost::signals2::optional_last_value<bool>, int, std::__1::less<int>, boost::function<bool (CNode*)>, boost::function<bool (boost::signals2::connection const&, CNode*)>, boost::signals2::mutex>::slot_invoker, std::__1::__list_iterator<boost::shared_ptr<boost::signals2::detail::connection_body<std::__1::pair<boost::signals2::detail::slot_meta_group, boost::optional<int> >, boost::signals2::slot1<bool, CNode*, boost::function<bool (CNode*)> >, boost::signals2::mutex> >, void*>, boost::signals2::detail::connection_body<std::__1::pair<boost::signals2::detail::slot_meta_group, boost::optional<int> >, boost::signals2::slot1<bool, CNode*, boost::function<bool (CNode*)> >, boost::signals2::mutex> >::dereference() const + 59 (optional.hpp:340)\n9   bitcoind                        0x00000001062fdfe8 boost::signals2::detail::signal1_impl<bool, CNode*, boost::signals2::optional_last_value<bool>, int, std::__1::less<int>, boost::function<bool (CNode*)>, boost::function<bool (boost::signals2::connection const&, CNode*)>, boost::signals2::mutex>::operator()(CNode*) + 456 (optional.hpp:340)\n10  bitcoind                        0x00000001062f26bc ThreadMessageHandler() + 844 (optional.hpp:340)\n11  bitcoind                        0x00000001062f6cfa void TraceThread<void (*)()>(char const*, void (*)()) + 138 (.util.h:494)\n12  libboost_thread-mt.dylib        0x00000001069080c5 boost::(anonymous namespace)::thread_proxy(void*) + 133\n13  libsystem_pthread.dylib         0x00007fff86cc3899 _pthread_body + 138\n14  libsystem_pthread.dylib         0x00007fff86cc372a _pthread_start + 137\n15  libsystem_pthread.dylib         0x00007fff86cc7fc9 thread_start + 13\n```\n\nI'm now watching the service and restarting it whenever it dies, but thought I'd report the issue.\n\nThis is not an issue in my livenet daemon.\n\n**_EDIT: Updated to latest version, still a problem**_\nVersion\n\n```\n$ git show\ncommit e8cb5c30b0db15a1c6786d6575098a66320ffec4\nMerge: 1de2992 714a3e6\nAuthor: Pieter Wuille <pieter.wuille@gmail.com>\nDate:   Thu Jul 31 00:04:55 2014 +0200\n\n    Merge pull request #4497\n\n    714a3e6 Only keep setBlockIndexValid entries that are possible improvements (Pieter Wuille)\n```\n",
   "closed_at" : "2014-08-13T12:51:24Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4607/comments",
   "created_at" : "2014-07-30T22:26:14Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4607/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/4607",
   "id" : 39143889,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "id" : 64585,
         "name" : "Bug",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "5319e7",
         "default" : false,
         "id" : 82428251,
         "name" : "TX fees and policy",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/TX%20fees%20and%20policy"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4607/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 4607,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Mac bitcoind -testnet exits with Segmentation Fault: 11. Not an issue on livenet",
   "updated_at" : "2014-08-13T12:51:24Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4607",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/1325863?v=4",
      "events_url" : "https://api.github.com/users/vogelito/events{/privacy}",
      "followers_url" : "https://api.github.com/users/vogelito/followers",
      "following_url" : "https://api.github.com/users/vogelito/following{/other_user}",
      "gists_url" : "https://api.github.com/users/vogelito/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/vogelito",
      "id" : 1325863,
      "login" : "vogelito",
      "organizations_url" : "https://api.github.com/users/vogelito/orgs",
      "received_events_url" : "https://api.github.com/users/vogelito/received_events",
      "repos_url" : "https://api.github.com/users/vogelito/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/vogelito/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/vogelito/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/vogelito"
   }
}
