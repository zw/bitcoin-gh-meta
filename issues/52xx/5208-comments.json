[
   {
      "body" : "Wouldn't this would be more flexible without keystore in the base class? Removing that would make this conducive to a future signing lib as well. Quick hack: https://github.com/theuni/bitcoin/commit/a61f6b103cd00c3540ea9d1d33f9810107713447",
      "created_at" : "2014-11-05T02:07:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-61748947",
      "id" : 61748947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-05T02:07:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61748947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni Yes, I actually started off that way, but if you need something that can look up private keys, public keys, and  scripts... then you pretty much already have CKeyStore (the abstract base) already again. ",
      "created_at" : "2014-11-05T06:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-61764525",
      "id" : 61764525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-05T06:16:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61764525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa fair enough. I've been debating whether CKeyStore should just drop its app deps and become available to libs. I guess you would argue \"yes\" on that one. In that case, it's only necessary to bump CKeyStore's CCriticalSection up to CBasicKeyStore, and move CKeyStore to a new file as a stateless base class. If you agree, I'll PR that change.\r\n\r\nEdit: Err.. stateless in the sense that it depends on no app globals",
      "created_at" : "2014-11-05T06:23:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-61764954",
      "id" : 61764954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-05T06:27:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61764954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni An alternative would be to make BaseSignatureCreator have the methods you suggest, and make CKeyStore derive from it: it effectively is something that is able to create signatures, but in addition, is able to recognize payments to itself.",
      "created_at" : "2014-11-05T06:25:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-61765096",
      "id" : 61765096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-05T06:25:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61765096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa Yes, that would make sense. That way SignatureCreator could use a small subset of CKeyStore, and that subset would be available to a lib as well. +1",
      "created_at" : "2014-11-05T06:30:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-61765478",
      "id" : 61765478,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-05T06:30:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61765478",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni After thinking a bit longer, I think I prefer the solution with simplifying CKeyStore if necessary, as that means the same keystore class could be reused for different types of signing.",
      "created_at" : "2014-11-08T16:08:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-62263068",
      "id" : 62263068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-08T16:08:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62263068",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa ok. Taking another look, for that we'd also need to rid CKeyStore (the interface class) of CKey usage, since that's not lib safe. Clunky as that sounds at first, it may make a little bit of sense if you consider that a lib's keystore implementation may want to maintain its own backing store and avoid copying data around with getters/setters.",
      "created_at" : "2014-11-08T19:51:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-62274366",
      "id" : 62274366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-08T19:51:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62274366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "My preference is the solution in which CKeyStore doesn't have any critical section (it's moved up to CBasicKeyStore) and becomes just a pure interface (well, leaving AddKey() and GetPubKey() as the only non-pure virtual methods, so it's still an abstract class rather than an interface) with only CKey, CPubKey, CKeyID, CScript and CScriptID as dependencies. \r\nI implemented that prerequisite in #5251.\r\n\r\nAs said earlier, it would be good to rename Solver() since it is very different from script/standard::Solver.\r\n\r\nBike-shedding a little bit, I would also change the name of the implementation from SignatureCreator to TxSignatureCreator (IMO SignatureChecker shoud have been named TxSignatureChecker as well).\r\nand maybe BaseSignatureCreator to just SignatureCreator.\r\n",
      "created_at" : "2014-11-09T23:53:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-62326227",
      "id" : 62326227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2015-02-05T20:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62326227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@jtimon 3x agreed.",
      "created_at" : "2014-11-09T23:55:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-62326311",
      "id" : 62326311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-09T23:55:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62326311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, and addressed @jtimon's two last nits. I haven't incorporated #5251 yet as that isn't sufficiently up to date with master.",
      "created_at" : "2014-11-16T21:09:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-63239424",
      "id" : 63239424,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-16T21:23:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63239424",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@theuni we should get rid of those globals regardless, I suppose.",
      "created_at" : "2014-11-16T21:21:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-63240027",
      "id" : 63240027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2014-11-16T21:21:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63240027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, and made the class names consistent with #5719.",
      "created_at" : "2015-02-05T02:13:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-72982075",
      "id" : 72982075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2015-02-05T02:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72982075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Concept ACK, looks ok from a quick glance. ",
      "created_at" : "2015-02-05T03:04:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-72986495",
      "id" : 72986495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2015-02-05T03:04:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72986495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "You ended up doing TransactionSignatureCreator and TransactionSignatureChecker instead of TxSignatureCreator and TxSignatureChecker. Longer, but too late to bikeshed that.\r\nutACK",
      "created_at" : "2015-02-05T20:06:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-73116816",
      "id" : 73116816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2015-02-05T20:06:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73116816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195034"
         }
      },
      "body" : "Why this needs to become static?\r\nCan't the compiler find out what it's best (static or inline) by itself?",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-05T20:11:21Z",
      "diff_hunk" : "@@ -40,20 +49,20 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n     {\n         const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n-        if (Sign1(keyID, keystore, hash, nHashType, scriptSigRet))\n+        if (Sign1(keyID, creator, scriptCode, scriptSigRet))\n             ++nSigned;\n     }\n     return nSigned==nRequired;\n }\n \n /**\n- * Sign scriptPubKey with private keys stored in keystore, given transaction hash and hash type.\n+ * Sign scriptPubKey using signature made with creator.\n  * Signatures are returned in scriptSigRet (or returns false if scriptPubKey can't be signed),\n  * unless whichTypeRet is TX_SCRIPTHASH, in which case scriptSigRet is the redemption script.\n  * Returns false if scriptPubKey could not be completely satisfied.\n  */\n-bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType,\n-                  CScript& scriptSigRet, txnouttype& whichTypeRet)\n+static bool SignStep(const BaseSignatureCreator& creator, const CScript& scriptPubKey,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195034",
      "id" : 24195034,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 56,
      "path" : "src/script/sign.cpp",
      "position" : 56,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-05T20:11:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195034",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195206"
         }
      },
      "body" : "Compilers don't have enough information to determine if functions can be static. And non-static functions cannot be inlined.",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-05T20:13:08Z",
      "diff_hunk" : "@@ -40,20 +49,20 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n     {\n         const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n-        if (Sign1(keyID, keystore, hash, nHashType, scriptSigRet))\n+        if (Sign1(keyID, creator, scriptCode, scriptSigRet))\n             ++nSigned;\n     }\n     return nSigned==nRequired;\n }\n \n /**\n- * Sign scriptPubKey with private keys stored in keystore, given transaction hash and hash type.\n+ * Sign scriptPubKey using signature made with creator.\n  * Signatures are returned in scriptSigRet (or returns false if scriptPubKey can't be signed),\n  * unless whichTypeRet is TX_SCRIPTHASH, in which case scriptSigRet is the redemption script.\n  * Returns false if scriptPubKey could not be completely satisfied.\n  */\n-bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType,\n-                  CScript& scriptSigRet, txnouttype& whichTypeRet)\n+static bool SignStep(const BaseSignatureCreator& creator, const CScript& scriptPubKey,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195206",
      "id" : 24195206,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 56,
      "path" : "src/script/sign.cpp",
      "position" : 56,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-05T20:13:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195348"
         }
      },
      "body" : "The compiler compiles individual .cpp files. At that stage, it's not yet known whether a function will be used by other modules (.cpp), so no, you need to tell it that it's local to the module.",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-05T20:14:34Z",
      "diff_hunk" : "@@ -40,20 +49,20 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n     {\n         const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n-        if (Sign1(keyID, keystore, hash, nHashType, scriptSigRet))\n+        if (Sign1(keyID, creator, scriptCode, scriptSigRet))\n             ++nSigned;\n     }\n     return nSigned==nRequired;\n }\n \n /**\n- * Sign scriptPubKey with private keys stored in keystore, given transaction hash and hash type.\n+ * Sign scriptPubKey using signature made with creator.\n  * Signatures are returned in scriptSigRet (or returns false if scriptPubKey can't be signed),\n  * unless whichTypeRet is TX_SCRIPTHASH, in which case scriptSigRet is the redemption script.\n  * Returns false if scriptPubKey could not be completely satisfied.\n  */\n-bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType,\n-                  CScript& scriptSigRet, txnouttype& whichTypeRet)\n+static bool SignStep(const BaseSignatureCreator& creator, const CScript& scriptPubKey,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24195348",
      "id" : 24195348,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 56,
      "path" : "src/script/sign.cpp",
      "position" : 56,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-05T20:14:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24195348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24196617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24196617"
         }
      },
      "body" : "@luke-jr Non-static functions can (and are) inlined just fine. They just can't be omitted from the resulting .o file unless they're 1) static 2) inlined in every call site.",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-05T20:30:09Z",
      "diff_hunk" : "@@ -40,20 +49,20 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n     {\n         const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n-        if (Sign1(keyID, keystore, hash, nHashType, scriptSigRet))\n+        if (Sign1(keyID, creator, scriptCode, scriptSigRet))\n             ++nSigned;\n     }\n     return nSigned==nRequired;\n }\n \n /**\n- * Sign scriptPubKey with private keys stored in keystore, given transaction hash and hash type.\n+ * Sign scriptPubKey using signature made with creator.\n  * Signatures are returned in scriptSigRet (or returns false if scriptPubKey can't be signed),\n  * unless whichTypeRet is TX_SCRIPTHASH, in which case scriptSigRet is the redemption script.\n  * Returns false if scriptPubKey could not be completely satisfied.\n  */\n-bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType,\n-                  CScript& scriptSigRet, txnouttype& whichTypeRet)\n+static bool SignStep(const BaseSignatureCreator& creator, const CScript& scriptPubKey,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24196617",
      "id" : 24196617,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 56,
      "path" : "src/script/sign.cpp",
      "position" : 56,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-05T20:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24196617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24213081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24213081"
         }
      },
      "body" : "s/Solver/SignStep",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-06T00:15:40Z",
      "diff_hunk" : "@@ -109,21 +111,29 @@ bool SignSignature(const CKeyStore &keystore, const CScript& fromPubKey, CMutabl\n         // Solver returns the subscript that need to be evaluated;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24213081",
      "id" : 24213081,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 109,
      "path" : "src/script/sign.cpp",
      "position" : 109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-06T00:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24213081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24221455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24221455"
         }
      },
      "body" : "and s/need/needs",
      "commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "created_at" : "2015-02-06T04:04:32Z",
      "diff_hunk" : "@@ -109,21 +111,29 @@ bool SignSignature(const CKeyStore &keystore, const CScript& fromPubKey, CMutabl\n         // Solver returns the subscript that need to be evaluated;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#discussion_r24221455",
      "id" : 24221455,
      "original_commit_id" : "38f7dc300eff7d68b376e0801f7d301998b4b3c1",
      "original_position" : 109,
      "path" : "src/script/sign.cpp",
      "position" : 109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5208",
      "updated_at" : "2015-02-06T04:04:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24221455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@laanwj Care to have a look?",
      "created_at" : "2015-02-16T20:33:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5208#issuecomment-74568358",
      "id" : 74568358,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5208",
      "updated_at" : "2015-02-16T20:33:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/74568358",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
