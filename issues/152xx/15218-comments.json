[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294009"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could be written as `std::thread(FlushStateToDisk).detach();`?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-20T20:19:59Z",
      "diff_hunk" : "@@ -1190,6 +1190,11 @@ bool IsInitialBlockDownload()\n         return true;\n     if (chainActive.Tip()->GetBlockTime() < (GetTime() - nMaxTipAge))\n         return true;\n+\n+    // Flush state after IBD is finished, but don't block return\n+    void (*flush_ptr)() = &FlushStateToDisk;\n+    std::thread(flush_ptr).detach();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294009",
      "id" : 249294009,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTI5NDAwOQ==",
      "original_commit_id" : "c5c5702ffeba817dbe0c1ae6135462e1060fa2f9",
      "original_line" : 1196,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 194407400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294009/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294143"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No, because `FlushStateToDisk` is overloaded and the compiler can't determine which function to call in that case.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-20T20:23:47Z",
      "diff_hunk" : "@@ -1190,6 +1190,11 @@ bool IsInitialBlockDownload()\n         return true;\n     if (chainActive.Tip()->GetBlockTime() < (GetTime() - nMaxTipAge))\n         return true;\n+\n+    // Flush state after IBD is finished, but don't block return\n+    void (*flush_ptr)() = &FlushStateToDisk;\n+    std::thread(flush_ptr).detach();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294143",
      "id" : 249294143,
      "in_reply_to_id" : 249294009,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTI5NDE0Mw==",
      "original_commit_id" : "c5c5702ffeba817dbe0c1ae6135462e1060fa2f9",
      "original_line" : 1196,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 194407541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294143/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294554"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@andrewtoth Ah, yes! Thanks!\r\n\r\n```\r\n$ git grep ' FlushStateToDisk.*{'\r\nsrc/validation.cpp:bool static FlushStateToDisk(const CChainParams& chainparams, CValidationState &state, FlushStateMode mode, int nManualPruneHeight) {\r\nsrc/validation.cpp:void FlushStateToDisk() {\r\n```",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-20T20:35:47Z",
      "diff_hunk" : "@@ -1190,6 +1190,11 @@ bool IsInitialBlockDownload()\n         return true;\n     if (chainActive.Tip()->GetBlockTime() < (GetTime() - nMaxTipAge))\n         return true;\n+\n+    // Flush state after IBD is finished, but don't block return\n+    void (*flush_ptr)() = &FlushStateToDisk;\n+    std::thread(flush_ptr).detach();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249294554",
      "id" : 249294554,
      "in_reply_to_id" : 249294009,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTI5NDU1NA==",
      "original_commit_id" : "c5c5702ffeba817dbe0c1ae6135462e1060fa2f9",
      "original_line" : 1196,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 194407962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294554/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249294554",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, but I think `IsInitialBlockDownload` is the wrong place to implement this, as it's a query function, having it suddenly spawn a thread that flushes is unexpected.\r\n\r\nWould be better to implement it closer to the validation logic and database update logic itself.",
      "created_at" : "2019-01-21T15:42:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456116167",
      "id" : 456116167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjExNjE2Nw==",
      "updated_at" : "2019-01-21T15:42:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456116167",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@laanwj Good point. I refactored to move this behaviour to `ActivateBestChain` in an area where periodic flushes are already expected.",
      "created_at" : "2019-01-21T23:34:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456224773",
      "id" : 456224773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjIyNDc3Mw==",
      "updated_at" : "2019-01-21T23:34:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456224773",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249655399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249655399"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Wrong indentation :-)",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-22T06:37:07Z",
      "diff_hunk" : "@@ -2751,7 +2751,13 @@ bool CChainState::ActivateBestChain(CValidationState &state, const CChainParams&\n     CheckBlockIndex(chainparams.GetConsensus());\n \n     // Write changes periodically to disk, after relay.\n-    if (!FlushStateToDisk(chainparams, state, FlushStateMode::PERIODIC)) {\n+    // Unless we just finished initial sync, then always write to disk\n+    static bool initially_in_ibd = true;\n+    bool finished_ibd = initially_in_ibd && !IsInitialBlockDownload();\n+    if (finished_ibd) {\n+      initially_in_ibd = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249655399",
      "id" : 249655399,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTY1NTM5OQ==",
      "original_commit_id" : "e3e1e7aac49db4133d0c412ad6c82251daff883b",
      "original_line" : 2758,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 194853140,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249655399/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249655399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> @laanwj Good point. I refactored to move this behaviour to ActivateBestChain in an area where periodic flushes are already expected.\r\n\r\nThanks, much better!",
      "created_at" : "2019-01-22T12:29:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456382561",
      "id" : 456382561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjM4MjU2MQ==",
      "updated_at" : "2019-01-22T12:29:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456382561",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249799715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249799715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-22T14:25:56Z",
      "diff_hunk" : "@@ -2751,7 +2751,13 @@ bool CChainState::ActivateBestChain(CValidationState &state, const CChainParams&\n     CheckBlockIndex(chainparams.GetConsensus());\n \n     // Write changes periodically to disk, after relay.\n-    if (!FlushStateToDisk(chainparams, state, FlushStateMode::PERIODIC)) {\n+    // Unless we just finished initial sync, then always write to disk\n+    static bool initially_in_ibd = true;\n+    bool finished_ibd = initially_in_ibd && !IsInitialBlockDownload();\n+    if (finished_ibd) {\n+      initially_in_ibd = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249799715",
      "id" : 249799715,
      "in_reply_to_id" : 249655399,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTc5OTcxNQ==",
      "original_commit_id" : "e3e1e7aac49db4133d0c412ad6c82251daff883b",
      "original_line" : 2758,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 195030884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249799715/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249799715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249810717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249810717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think that this variable should be the member of CChainState to avoid share same variable if we have two CChainState object in the program.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-22T14:51:15Z",
      "diff_hunk" : "@@ -2751,7 +2751,13 @@ bool CChainState::ActivateBestChain(CValidationState &state, const CChainParams&\n     CheckBlockIndex(chainparams.GetConsensus());\n \n     // Write changes periodically to disk, after relay.\n-    if (!FlushStateToDisk(chainparams, state, FlushStateMode::PERIODIC)) {\n+    // Unless we just finished initial sync, then always write to disk\n+    static bool initially_in_ibd = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r249810717",
      "id" : 249810717,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTgxMDcxNw==",
      "original_commit_id" : "36628231dc52096f1613e6b85241eadc4df9cb09",
      "original_line" : 2755,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 195044542,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249810717/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249810717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm not really a fan of this change -- the problem described in #11600 is from an unclean shutdown (ie system crash), where our recovery code could take a long time (but typically would be much faster than doing a -reindex to recover, which is how our code used to work).\r\n\r\nThis change doesn't really solve that problem, it just changes the window in which an unclean shutdown could occur (reducing it at most by 24 hours).  But extra flushes, particularly during initial sync, aren't obviously a good idea, since they harm performance.  (Note that we leave IBD before we've synced all the way to the tip, I think once we're within a day or two?)\r\n\r\nBecause we flush every day anyway, it's hard for me to say that this is really that much worse, performance-wise (after all we don't currently support a node configuration where the utxo is kept entirely cached).  But I'm not sure this solves anything either, and a change like this would have to be reverted if, for instance, we wanted to make the cache actually more useful on startup (something I've thought we should do for a while).  So I think I'm a -0 on this change.",
      "created_at" : "2019-01-22T20:52:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456558815",
      "id" : 456558815,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjU1ODgxNQ==",
      "updated_at" : "2019-01-22T20:52:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456558815",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar This change also greatly improves the common workflow of spinning up a high performance instance to sync, then immediately shutting it down and using a cheaper one. Currently, you have to enter it and do a clean shutdown instead of just terminating. Similarly, when syncing to an external drive, you can now just unplug the drive or turn off the machine when finished.\r\n\r\nI would argue that moving the window to 0 hours directly after initial sync is an objective improvement. There is a lot of data that will be lost directly after, so why risk another 24 hours? After that, the most they will lose is 24 hours worth of rolling back, instead of 10 years. Also, this change does *not* do any extra flushes during initial sync, only after.\r\n\r\nI can't speak to your last point about changing the way we use the cache, since I don't know what your ideas are.",
      "created_at" : "2019-01-23T01:18:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456628736",
      "id" : 456628736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjYyODczNg==",
      "updated_at" : "2019-01-23T01:36:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456628736",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250027236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250027236"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-23T01:34:14Z",
      "diff_hunk" : "@@ -2751,7 +2751,13 @@ bool CChainState::ActivateBestChain(CValidationState &state, const CChainParams&\n     CheckBlockIndex(chainparams.GetConsensus());\n \n     // Write changes periodically to disk, after relay.\n-    if (!FlushStateToDisk(chainparams, state, FlushStateMode::PERIODIC)) {\n+    // Unless we just finished initial sync, then always write to disk\n+    static bool initially_in_ibd = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250027236",
      "id" : 250027236,
      "in_reply_to_id" : 249810717,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDAyNzIzNg==",
      "original_commit_id" : "36628231dc52096f1613e6b85241eadc4df9cb09",
      "original_line" : 2755,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 195312218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250027236/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250027236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Currently, you have to enter it and do a clean shutdown instead of just terminating.\r\n\r\n@andrewtoth We already support this (better, I think) with the `-stopatheight` argument, no?\r\n\r\nI don't really view data that is in memory as \"at risk\"; I view it as a massive performance optimization that will allow a node to process new blocks at the fastest possible speed while the data hasn't yet been flushed.  I also don't feel very strongly about this for the reasons I gave above, so if others want this behavior then so be it.",
      "created_at" : "2019-01-23T17:08:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456885613",
      "id" : 456885613,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1Njg4NTYxMw==",
      "updated_at" : "2019-01-23T17:08:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456885613",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar Maybe this is a bit of a different discussion, but there is another option; namely supporting flushing the dirty state to disk, but without wiping it from the cache. Based on our earlier benchmarking, we wouldn't want to do this purely for maximizing IBD performance, but it could be done at specific times to minimize losses in case of crashes (the once per day flush for example, and also this IBD-is-finshed one).",
      "created_at" : "2019-01-23T19:31:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456935332",
      "id" : 456935332,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjkzNTMzMg==",
      "updated_at" : "2019-01-23T19:31:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456935332",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa Agreed, I think that would make a lot more sense as a first pass optimization for the periodic flushes and would also work better for this purpose as well.",
      "created_at" : "2019-01-23T19:43:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456939539",
      "id" : 456939539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjkzOTUzOQ==",
      "updated_at" : "2019-01-23T19:43:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456939539",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> . Currently, you have to enter it and do a clean shutdown instead of just terminating. \r\n\r\nWell with this, if you \"just terminate\" you're going to end up with a replay of several days blocks at start, which is still ugly, even if less bad via this.\r\n\r\nAside, actually if you actually shut off the computer any time during IBD you'll likely completely corrupt the state and need to reindex because we don't use fsync during IBD for performance reasons.\r\n\r\nWe really need to get background writing going, so that our writes are never more than (say) a week of blocktime behind... but that is a much bigger change, so I don't suggest \"just do that instead\", though it would make the change here completely unnecessary.\r\n\r\nMight it be better to trigger the flush the first time it goes 30 seconds without connecting a block and there are no queued transfers, from the scheduler thread? ",
      "created_at" : "2019-01-24T19:18:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-457321738",
      "id" : 457321738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NzMyMTczOA==",
      "updated_at" : "2019-01-24T19:18:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457321738",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250746344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250746344"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems unrelated to the changes?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-24T19:29:07Z",
      "diff_hunk" : "@@ -57,6 +57,8 @@ def run_test(self):\n         self.log.info('Start with empty mempool, and 200 blocks')\n         self.mempool_size = 0\n         wait_until(lambda: node.getblockcount() == 200)\n+        # Generate 1 more block to exit IBD\n+        node.generate(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250746344",
      "id" : 250746344,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDc0NjM0NA==",
      "original_commit_id" : "478705490369bd5718fca6420a45588fa3090f92",
      "original_line" : 61,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mempool_accept.py",
      "position" : null,
      "pull_request_review_id" : 196210013,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250746344/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250746344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250842130"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250842130"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The test below that checks if a mined transaction can be added to the mempool will fail after this flush is triggered when a block is generated. It rejects the transaction with the `missing-inputs` message rather than the expected `tx-already-known`. By triggering the flush here the test passes.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-01-25T01:44:54Z",
      "diff_hunk" : "@@ -57,6 +57,8 @@ def run_test(self):\n         self.log.info('Start with empty mempool, and 200 blocks')\n         self.mempool_size = 0\n         wait_until(lambda: node.getblockcount() == 200)\n+        # Generate 1 more block to exit IBD\n+        node.generate(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r250842130",
      "id" : 250842130,
      "in_reply_to_id" : 250746344,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDg0MjEzMA==",
      "original_commit_id" : "478705490369bd5718fca6420a45588fa3090f92",
      "original_line" : 61,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mempool_accept.py",
      "position" : null,
      "pull_request_review_id" : 196330089,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250842130/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250842130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @andrewtoth We already support this (better, I think) with the `-stopatheight` argument, no?\r\n\r\n@sdaftuar Ahh, I never considered using that for this purpose. Thanks!\r\n\r\n@gmaxwell It might still be ugly to have a replay of a few days, but much better than making everything unusable for hours. \r\n\r\nThere are comments from several people in this PR about adding background writing and writing dirty state to disk without wiping the cache. This change wouldn't affect either of those improvements, and is an improvement by itself in the interim.\r\n\r\nAs for moving this to the scheduler thread, I think this is better since it happens in a place where periodic flushes are already expected Also, checking every 30 seconds for a new block wouldn't work if for instance the network cuts out for a few minutes.\r\n\r\n",
      "created_at" : "2019-01-25T02:22:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-457431998",
      "id" : 457431998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NzQzMTk5OA==",
      "updated_at" : "2019-01-25T02:23:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457431998",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@andrewtoth The problem is that right now, causing a flush when exiting IBD will (temporarily) kill your performance right before finishing the sync (because it leaves you with an empty cache). If instead it was a non-clearing flush, there would be no such downside.",
      "created_at" : "2019-01-25T02:36:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-457434328",
      "id" : 457434328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NzQzNDMyOA==",
      "updated_at" : "2019-01-25T02:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457434328",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My experiment in #15265 has changed my view on this a bit -- now I think that we might as well make a change like this for now, but should change the approach slightly to do something like @gmaxwell's proposal so that we don't trigger the flush before we are done syncing:\r\n\r\n> Might it be better to trigger the flush the first time it goes 30 seconds without connecting a block and there are no queued transfers, from the scheduler thread?\r\n\r\n",
      "created_at" : "2019-01-29T18:56:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-458662734",
      "id" : 458662734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1ODY2MjczNA==",
      "updated_at" : "2019-01-29T18:56:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458662734",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar @gmaxwell I've updated this to check every 30 seconds on the scheduler thread if there has been an update to the active chain height. This only actually checks after `IsInitialBlockDownload` is false, which happens if latest block is within a day of the current time. \r\n\r\nI'm not sure how to check if there are queued transfers. If this is not sufficient, some guidance on how to do that would be appreciated.",
      "created_at" : "2019-02-10T20:34:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-462169529",
      "id" : 462169529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MjE2OTUyOQ==",
      "updated_at" : "2019-02-10T20:34:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/462169529",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r255356011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255356011"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Lifetime issue with `did_initial_flush` and `last_chain_height` when `AppInitMain` goes out of scope?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-02-10T21:12:52Z",
      "diff_hunk" : "@@ -1781,5 +1784,19 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    bool did_initial_flush = false;\n+    int last_chain_height = -1;\n+    scheduler.scheduleEvery([&did_initial_flush, &last_chain_height] {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r255356011",
      "id" : 255356011,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTM1NjAxMQ==",
      "original_commit_id" : "442db9d79d8f4e2177000e8e8b98f647424349f8",
      "original_line" : 1790,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 201922131,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255356011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255356011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r255358401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255358401"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Moved them inside the lambda as static variables.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-02-10T22:06:06Z",
      "diff_hunk" : "@@ -1781,5 +1784,19 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    bool did_initial_flush = false;\n+    int last_chain_height = -1;\n+    scheduler.scheduleEvery([&did_initial_flush, &last_chain_height] {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r255358401",
      "id" : 255358401,
      "in_reply_to_id" : 255356011,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTM1ODQwMQ==",
      "original_commit_id" : "442db9d79d8f4e2177000e8e8b98f647424349f8",
      "original_line" : 1790,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 201924675,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255358401/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255358401",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [MarcoFalke](https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-554540031) |\n| Concept ACK | [laanwj](https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-456116167), [luke-jr](https://github.com/bitcoin/bitcoin/pull/15218#pullrequestreview-228803963), [Sjors](https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-557789811) |\n\nIf your review is incorrectly listed, please react with  to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28170](https://github.com/bitcoin/bitcoin/pull/28170) (p2p: adaptive connections services flags by furszy)\n* [#27052](https://github.com/bitcoin/bitcoin/pull/27052) (test: rpc: add last block announcement time to getpeerinfo result by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2019-02-11T03:49:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-462213268",
      "id" : 462213268,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MjIxMzI2OA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/462213268/reactions"
      },
      "updated_at" : "2024-01-22T22:10:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/462213268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276096258"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276096258"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can't we just unschedule the task?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-17T06:33:53Z",
      "diff_hunk" : "@@ -1812,5 +1815,24 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    scheduler.scheduleEvery([]{\n+        static bool did_initial_flush = false;\n+        if (did_initial_flush || IsInitialBlockDownload()) {\n+            return;\n+        }\n+\n+        static int last_chain_height = -1;\n+        LOCK(cs_main);\n+        int current_height = chainActive.Height();\n+        if (last_chain_height == -1 || last_chain_height != current_height) {\n+            last_chain_height = current_height;\n+            return;\n+        }\n+\n+        did_initial_flush = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276096258",
      "id" : 276096258,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NjA5NjI1OA==",
      "original_commit_id" : "8ecd177c3ad522f7748c6ef943ff726ebbfe1016",
      "original_line" : 1833,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 227570696,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276096258/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276096258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276501009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276501009"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Unless I'm missing something, I don't think it's possible to unschedule without making a lot more changes https://github.com/bitcoin/bitcoin/blob/master/src/scheduler.h#L58 ",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-18T02:44:00Z",
      "diff_hunk" : "@@ -1812,5 +1815,24 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    scheduler.scheduleEvery([]{\n+        static bool did_initial_flush = false;\n+        if (did_initial_flush || IsInitialBlockDownload()) {\n+            return;\n+        }\n+\n+        static int last_chain_height = -1;\n+        LOCK(cs_main);\n+        int current_height = chainActive.Height();\n+        if (last_chain_height == -1 || last_chain_height != current_height) {\n+            last_chain_height = current_height;\n+            return;\n+        }\n+\n+        did_initial_flush = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276501009",
      "id" : 276501009,
      "in_reply_to_id" : 276096258,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NjUwMTAwOQ==",
      "original_commit_id" : "8ecd177c3ad522f7748c6ef943ff726ebbfe1016",
      "original_line" : 1833,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228080473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276501009/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276501009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276886513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276886513"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Use `scheduleFromNow` conditionally?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T02:17:25Z",
      "diff_hunk" : "@@ -1812,5 +1815,24 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    scheduler.scheduleEvery([]{\n+        static bool did_initial_flush = false;\n+        if (did_initial_flush || IsInitialBlockDownload()) {\n+            return;\n+        }\n+\n+        static int last_chain_height = -1;\n+        LOCK(cs_main);\n+        int current_height = chainActive.Height();\n+        if (last_chain_height == -1 || last_chain_height != current_height) {\n+            last_chain_height = current_height;\n+            return;\n+        }\n+\n+        did_initial_flush = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r276886513",
      "id" : 276886513,
      "in_reply_to_id" : 276096258,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Njg4NjUxMw==",
      "original_commit_id" : "8ecd177c3ad522f7748c6ef943ff726ebbfe1016",
      "original_line" : 1833,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228570862,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276886513/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276886513",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277030073"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277030073"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated. How is that?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T16:31:17Z",
      "diff_hunk" : "@@ -1812,5 +1815,24 @@ bool AppInitMain(InitInterfaces& interfaces)\n         g_banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL * 1000);\n \n+    // Once initial sync is finished, flush state to protect against data loss\n+    scheduler.scheduleEvery([]{\n+        static bool did_initial_flush = false;\n+        if (did_initial_flush || IsInitialBlockDownload()) {\n+            return;\n+        }\n+\n+        static int last_chain_height = -1;\n+        LOCK(cs_main);\n+        int current_height = chainActive.Height();\n+        if (last_chain_height == -1 || last_chain_height != current_height) {\n+            last_chain_height = current_height;\n+            return;\n+        }\n+\n+        did_initial_flush = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277030073",
      "id" : 277030073,
      "in_reply_to_id" : 276096258,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzAzMDA3Mw==",
      "original_commit_id" : "8ecd177c3ad522f7748c6ef943ff726ebbfe1016",
      "original_line" : 1833,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228748211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277030073/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277030073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277037222"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037222"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: extra space on the end",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T17:01:54Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync() ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277037222",
      "id" : 277037222,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzAzNzIyMg==",
      "original_commit_id" : "4ff12b7e98dc17c7ce12d34cf97c7182b5a39c16",
      "original_line" : 1256,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228757294,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037222/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277037329"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037329"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't understand the purpose of `*` before `FlushAfterSync`.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T17:02:15Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync() \n+{\n+    // Once initial sync is finished, flush state to protect against data loss\n+    if (IsInitialBlockDownload()) {\n+        scheduler.scheduleFromNow(*FlushAfterSync, SYNC_CHECK_INTERVAL * 1000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277037329",
      "id" : 277037329,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzAzNzMyOQ==",
      "original_commit_id" : "4ff12b7e98dc17c7ce12d34cf97c7182b5a39c16",
      "original_line" : 1260,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228757294,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037329/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277037329",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277041892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041892"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T17:23:22Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync() ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277041892",
      "id" : 277041892,
      "in_reply_to_id" : 277037222,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzA0MTg5Mg==",
      "original_commit_id" : "4ff12b7e98dc17c7ce12d34cf97c7182b5a39c16",
      "original_line" : 1256,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228763649,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277041932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041932"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed them.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T17:23:35Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync() \n+{\n+    // Once initial sync is finished, flush state to protect against data loss\n+    if (IsInitialBlockDownload()) {\n+        scheduler.scheduleFromNow(*FlushAfterSync, SYNC_CHECK_INTERVAL * 1000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277041932",
      "id" : 277041932,
      "in_reply_to_id" : 277037329,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzA0MTkzMg==",
      "original_commit_id" : "4ff12b7e98dc17c7ce12d34cf97c7182b5a39c16",
      "original_line" : 1260,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228763719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041932/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277041932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277092602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277092602"
         }
      },
      "author_association" : "MEMBER",
      "body" : "doc-nit: This comment should be moved down after the `if` or as docstring on top of the method, imo. The condition in the if below is \"initial sync is *not* finished\".",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-19T21:10:15Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync()\n+{\n+    // Once initial sync is finished, flush state to protect against data loss",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277092602",
      "id" : 277092602,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzA5MjYwMg==",
      "original_commit_id" : "6471856400f24822d6f0836937b0a6660499418e",
      "original_line" : 1258,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228827943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277092602/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277092602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277137392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277137392"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated comments to align with coding style.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-20T15:04:52Z",
      "diff_hunk" : "@@ -1250,6 +1253,26 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+static void FlushAfterSync()\n+{\n+    // Once initial sync is finished, flush state to protect against data loss",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277137392",
      "id" : 277137392,
      "in_reply_to_id" : 277092602,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzEzNzM5Mg==",
      "original_commit_id" : "6471856400f24822d6f0836937b0a6660499418e",
      "original_line" : 1258,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 228880931,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277137392/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277137392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 5d9aa4c6432bd41e8d65717976293e006a6c732a",
      "created_at" : "2019-04-22T14:14:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-485429170",
      "id" : 485429170,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTQyOTE3MA==",
      "updated_at" : "2019-04-22T14:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485429170",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not sure how to check if there are queued transfers. If this is not sufficient, some guidance on how to do that would be appreciated.\r\n\r\nThere's a variable called `nPeersWithValidatedDownloads` in `net_processing.cpp` which indicates how many peers we are downloading blocks from.  So to implement @gmaxwell's suggestion I think you would just need to expose that variable and then check to see if it equals 0.",
      "created_at" : "2019-04-22T15:04:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-485443155",
      "id" : 485443155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTQ0MzE1NQ==",
      "updated_at" : "2019-04-22T15:04:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485443155",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar Thanks. Updated.",
      "created_at" : "2019-04-23T00:57:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-485602817",
      "id" : 485602817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTYwMjgxNw==",
      "updated_at" : "2019-04-23T00:57:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485602817",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277636926"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277636926"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Annotations in definitions are ignored, they need to be in the declaration\r\n\r\n```suggestion\r\nint GetNumberOfPeersWithValidatedDownloads()\r\n```",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-23T11:47:15Z",
      "diff_hunk" : "@@ -803,6 +803,11 @@ bool GetNodeStateStats(NodeId nodeid, CNodeStateStats &stats) {\n     return true;\n }\n \n+int GetNumberOfPeersWithValidatedDownloads() EXCLUSIVE_LOCKS_REQUIRED(cs_main)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277636926",
      "id" : 277636926,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzYzNjkyNg==",
      "original_commit_id" : "6f76c4f97bf71ccd76a665184212d3d0628ddde2",
      "original_line" : 806,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 229500246,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277636926/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277636926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277695089"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277695089"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2019-04-23T14:05:15Z",
      "diff_hunk" : "@@ -803,6 +803,11 @@ bool GetNodeStateStats(NodeId nodeid, CNodeStateStats &stats) {\n     return true;\n }\n \n+int GetNumberOfPeersWithValidatedDownloads() EXCLUSIVE_LOCKS_REQUIRED(cs_main)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r277695089",
      "id" : 277695089,
      "in_reply_to_id" : 277636926,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzY5NTA4OQ==",
      "original_commit_id" : "6f76c4f97bf71ccd76a665184212d3d0628ddde2",
      "original_line" : 806,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 229573249,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277695089/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2019-07-31T16:38:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277695089",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-07-31T15:29:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-516899685",
      "id" : 516899685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjg5OTY4NQ==",
      "updated_at" : "2019-07-31T15:29:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516899685",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "-0.5. This is really not the right way to go here, I think. Namely, people with high dbcache may also want to use it after IBD completes (ie cause they want to connect blocks quickly), and this breaks that by wiping the cache completely. Coupling it with a change to not drop non-dirty entries while flushing is the easy fix to make it not have a regression, though a more complete cleanup of background flushing would also be nice.",
      "created_at" : "2019-08-21T18:17:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-523587757",
      "id" : 523587757,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMzU4Nzc1Nw==",
      "updated_at" : "2019-08-21T18:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/523587757",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> this breaks that by wiping the cache completely\r\n\r\nOn a sort of related note, I think it's kind of crazy that we couple writing back to disk with emptying the in-memory cache. Feels like those should be separate considerations, especially in a case like this.",
      "created_at" : "2019-08-21T19:14:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-523609555",
      "id" : 523609555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMzYwOTU1NQ==",
      "updated_at" : "2019-08-21T19:14:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/523609555",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This PR seems to be too controversial to merge in the current state, and discussion has become inactive. Closing as up for grabs. Let me know if you start work on this again and I'll re-open it.",
      "created_at" : "2019-10-08T09:55:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-539441272",
      "id" : 539441272,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzOTQ0MTI3Mg==",
      "updated_at" : "2019-10-08T09:55:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/539441272",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Could rebase on top of something like: #17487, and then open a new pull request and link to this discussion which is mostly about \"NACK, because this will erase the cache\".",
      "created_at" : "2019-11-15T21:42:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-554540031",
      "id" : 554540031,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDU0MDAzMQ==",
      "updated_at" : "2019-11-15T21:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554540031",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke Thanks for bringing that to my attention. What is the benefit of making a new PR instead of reopening this one? Just for visibility?",
      "created_at" : "2019-11-16T03:00:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-554597640",
      "id" : 554597640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDU5NzY0MA==",
      "updated_at" : "2019-11-16T03:00:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554597640",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Up to you. Let me know if you want this reopened.",
      "created_at" : "2019-11-16T03:16:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-554598794",
      "id" : 554598794,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDU5ODc5NA==",
      "updated_at" : "2019-11-16T03:16:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554598794",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The benefit is that the no-longer-applicable criticism is no longer right there at first glance.",
      "created_at" : "2019-11-16T05:02:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-554605063",
      "id" : 554605063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDYwNTA2Mw==",
      "updated_at" : "2019-11-16T05:02:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554605063",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Given that it was found this does not negatively affect performance, see https://github.com/bitcoin/bitcoin/pull/15265#issuecomment-458657451, I think it should be reconsidered in its current form.",
      "created_at" : "2019-11-22T13:09:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-557525370",
      "id" : 557525370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzUyNTM3MA==",
      "updated_at" : "2019-11-22T13:09:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557525370",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke I don't think the takeaway from that comment is that it doesn't affect performance. That was benchmarking IBD for pruned nodes with not emptying the cache on flush. This PR is flushing the dbcache after IBD. I'm sure for a non-pruned node with a high dbcache this will negatively affect performance directly after the flush, as @TheBlueMatt 's comment points out.",
      "created_at" : "2019-11-22T14:27:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-557551815",
      "id" : 557551815,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzU1MTgxNQ==",
      "updated_at" : "2019-11-22T14:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557551815",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If #17487 gets merged I will rebase this, perhaps without checking for active peers since the cache would no longer be affected and it will make the diff smaller.",
      "created_at" : "2019-11-22T14:31:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-557553220",
      "id" : 557553220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzU1MzIyMA==",
      "updated_at" : "2019-11-22T14:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557553220",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK on doing a `Flush(erase=false)` at the end of IBD once support for that is merged. It probably still makes sense to wait a little bit (e.g. checking for active peers), otherwise the user might be bothered with this flush right before sync really finishes.",
      "created_at" : "2019-11-23T11:26:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-557789811",
      "id" : 557789811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Nzc4OTgxMQ==",
      "updated_at" : "2019-11-23T11:26:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557789811",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-31T18:43:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-1410890394",
      "id" : 1410890394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "IC_kwDOABII585UGHqa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1410890394/reactions"
      },
      "updated_at" : "2023-01-31T18:43:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1410890394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->\nThere hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant?  Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant?  Please close.\n* Did the author lose interest or time to work on this?  Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "created_at" : "2023-07-24T01:45:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-1647078697",
      "id" : 1647078697,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "IC_kwDOABII585iLG0p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1647078697/reactions"
      },
      "updated_at" : "2023-07-24T01:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1647078697",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> If #17487 gets merged I will rebase this\r\n\r\nIt has been merged.",
      "created_at" : "2023-07-28T12:23:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-1655597008",
      "id" : 1655597008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "IC_kwDOABII585irmfQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1655597008/reactions"
      },
      "updated_at" : "2023-07-28T12:23:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1655597008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476346"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476346"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why was the order here swapped? Seems like override should be the very last keyword IMO",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2023-07-30T01:06:42Z",
      "diff_hunk" : "@@ -523,6 +523,7 @@ class PeerManagerImpl final : public PeerManager\n                         const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) override\n         EXCLUSIVE_LOCKS_REQUIRED(!m_peer_mutex, !m_recent_confirmed_transactions_mutex, !m_most_recent_block_mutex, !m_headers_presync_mutex, g_msgproc_mutex);\n     void UpdateLastBlockAnnounceTime(NodeId node, int64_t time_in_seconds) override;\n+    int GetNumberOfPeersWithValidatedDownloads() override EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476346",
      "id" : 1278476346,
      "line" : 526,
      "node_id" : "PRRC_kwDOABII585MNAA6",
      "original_commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "original_line" : 526,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 4,
      "pull_request_review_id" : 1553533327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476346/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-30T01:23:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476346",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: There used to be a blank line before this. IMO it was nicer.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2023-07-30T01:08:05Z",
      "diff_hunk" : "@@ -137,6 +137,8 @@ static constexpr bool DEFAULT_PROXYRANDOMIZE{true};\n static constexpr bool DEFAULT_REST_ENABLE{false};\n static constexpr bool DEFAULT_I2P_ACCEPT_INCOMING{true};\n static constexpr bool DEFAULT_STOPAFTERBLOCKIMPORT{false};\n+//! Check if initial sync is done with no change in block height or queued downloads every 30s",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476394",
      "id" : 1278476394,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII585MNABq",
      "original_commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "original_line" : 140,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 1553533327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476394/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-30T01:23:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476957"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476957"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do we want to monitor only the active chainstate? Or should we be paying attention to the background one too?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2023-07-30T01:17:36Z",
      "diff_hunk" : "@@ -1048,6 +1050,40 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+/**\n+ * Once initial block sync is finished and no change in block height or queued downloads,\n+ * sync utxo state to protect against data loss\n+ */\n+static void SyncCoinsTipAfterChainSync(const NodeContext& node)\n+{\n+    LOCK(node.chainman->GetMutex());\n+    if (node.chainman->ActiveChainstate().IsInitialBlockDownload()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278476957",
      "id" : 1278476957,
      "line" : 1060,
      "node_id" : "PRRC_kwDOABII585MNAKd",
      "original_commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "original_line" : 1060,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 20,
      "pull_request_review_id" : 1553533327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476957/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-30T01:23:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278476957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278477065"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278477065"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`-1` is always going to be `!= current_height` anyway...?",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2023-07-30T01:19:19Z",
      "diff_hunk" : "@@ -1048,6 +1050,40 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+/**\n+ * Once initial block sync is finished and no change in block height or queued downloads,\n+ * sync utxo state to protect against data loss\n+ */\n+static void SyncCoinsTipAfterChainSync(const NodeContext& node)\n+{\n+    LOCK(node.chainman->GetMutex());\n+    if (node.chainman->ActiveChainstate().IsInitialBlockDownload()) {\n+        node.scheduler->scheduleFromNow([&node] {\n+            SyncCoinsTipAfterChainSync(node);\n+        }, SYNC_CHECK_INTERVAL);\n+        return;\n+    }\n+\n+    static auto last_chain_height{-1};\n+    const auto current_height{node.chainman->ActiveHeight()};\n+    if (last_chain_height == -1 || last_chain_height != current_height) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278477065",
      "id" : 1278477065,
      "line" : 1069,
      "node_id" : "PRRC_kwDOABII585MNAMJ",
      "original_commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "original_line" : 1069,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 29,
      "pull_request_review_id" : 1553533327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278477065/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-30T01:23:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278477065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278481260"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278481260"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That's a good question.\r\nPlease correct me if my assumptions are incorrect, but I believe the other chainstate would be the background syncing while our active is the assumeutxo chainstate which we want to sync quickly and then have active ASAP. In that case, there are only two chainstates, active and background. The background chainstate can take a long time to sync, possibly >24h, which would mean the periodic flush would take effect. So syncing that here would not really be beneficial. For the active chainstate it would be much less than 24h and therefore we would want sync it to disk to protect against data loss.",
      "commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "created_at" : "2023-07-30T02:46:45Z",
      "diff_hunk" : "@@ -1048,6 +1050,40 @@ bool AppInitLockDataDirectory()\n     return true;\n }\n \n+/**\n+ * Once initial block sync is finished and no change in block height or queued downloads,\n+ * sync utxo state to protect against data loss\n+ */\n+static void SyncCoinsTipAfterChainSync(const NodeContext& node)\n+{\n+    LOCK(node.chainman->GetMutex());\n+    if (node.chainman->ActiveChainstate().IsInitialBlockDownload()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#discussion_r1278481260",
      "id" : 1278481260,
      "in_reply_to_id" : 1278476957,
      "line" : 1060,
      "node_id" : "PRRC_kwDOABII585MNBNs",
      "original_commit_id" : "9c27c626cf3707312f153e2884e7d9277dfa8f5b",
      "original_line" : 1060,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 20,
      "pull_request_review_id" : 1553538739,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15218",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278481260/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-30T02:46:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1278481260",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@luke-jr thank you for the speedy review! Will address your comments, but will wait for others to review as well.\r\n@Sjors @MarcoFalke rebased, apologies for the delay.",
      "created_at" : "2023-07-30T03:07:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-1657004059",
      "id" : 1657004059,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "IC_kwDOABII585iw-Ab",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1657004059/reactions"
      },
      "updated_at" : "2023-07-30T03:07:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1657004059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2024-01-31T18:15:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15218#issuecomment-1919656365",
      "id" : 1919656365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15218",
      "node_id" : "IC_kwDOABII585ya6Gt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1919656365/reactions"
      },
      "updated_at" : "2024-01-31T18:15:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1919656365",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
