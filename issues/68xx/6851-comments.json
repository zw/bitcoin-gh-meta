[
   {
      "body" : "People are already complaining about memory usage of the wallet. How much will this make it worse?",
      "created_at" : "2015-10-19T09:25:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-149156386",
      "id" : 149156386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-10-19T09:25:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149156386",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I would guess maybe 40 bytes per transaction. I am running some tests to compare.\r\n\r\nThe current code is very poor for zapwallettxes because it will re-sort the entire wallet transactions, every time it adds a new one.",
      "created_at" : "2015-10-19T09:32:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-149160347",
      "id" : 149160347,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-10-19T09:32:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149160347",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "With a wallet containing 10184 transactions, I did not observe any measurable memory overhead to the cache.\r\n\r\n```\r\n SIZE    VSZ    SZ\r\n329352 347192 86798\td78a880\r\n320552 338396 84599\td78a880+5873cc8\r\n```\r\n",
      "created_at" : "2015-10-20T04:55:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-149433219",
      "id" : 149433219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-10-20T04:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149433219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6851#discussion_r43430532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6851"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43430532"
         }
      },
      "body" : "nit: use a better method name? Maybe\r\n```c\r\n_WriteAccountingEntry(const CAccountingEntry& acentry) //should only be called from the CWallet\r\n```",
      "commit_id" : "5873cc890df161f4d7cbc312e02cf8181a0d8ef1",
      "created_at" : "2015-10-29T19:06:52Z",
      "diff_hunk" : "@@ -189,7 +189,7 @@ bool CWalletDB::WriteAccountingEntry(const uint64_t nAccEntryNum, const CAccount\n     return Write(std::make_pair(std::string(\"acentry\"), std::make_pair(acentry.strAccount, nAccEntryNum)), acentry);\n }\n \n-bool CWalletDB::WriteAccountingEntry(const CAccountingEntry& acentry)\n+bool CWalletDB::WriteAccountingEntry_ForWalletOnly(const CAccountingEntry& acentry)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#discussion_r43430532",
      "id" : 43430532,
      "original_commit_id" : "5873cc890df161f4d7cbc312e02cf8181a0d8ef1",
      "original_position" : 5,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6851",
      "updated_at" : "2015-10-29T19:06:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43430532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Nice!\r\nAdding a wtx to the wallet could also be faster (especially big wallets) because `AddToWallet()` does also call `OrderedTxItems()` (which reads in all the whole transaction history).\r\n\r\nutACK.",
      "created_at" : "2015-10-29T19:12:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-152290903",
      "id" : 152290903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-10-29T19:12:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152290903",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "concept ACK, light utACK\r\n\r\nAlso,  I feel like any memory overhead required would already exist instantaneously at the call site anyway, this just persists the requirement for the lifetime of the application instead?\r\n\r\n**edit**: To clarify, this doesn't really require any extra memory, except in that it is now persistent across the applications lifetime, not just when needed.",
      "created_at" : "2015-10-29T19:19:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-152292606",
      "id" : 152292606,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-18T00:38:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152292606",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "Needs rebase",
      "created_at" : "2015-11-06T04:23:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-154281504",
      "id" : 154281504,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-06T04:23:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/154281504",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=3",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "body" : "@luke-jr rebase please",
      "created_at" : "2015-11-14T07:57:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-156665090",
      "id" : 156665090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-14T07:57:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/156665090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Rebased",
      "created_at" : "2015-11-17T16:38:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-157425219",
      "id" : 157425219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-17T16:38:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157425219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Increased memory from 1.5GB on master to 1.8GB \r\nImproved zapwallet time to 5 minutes from something approximating infinity\r\n\r\n$ ./src/bitcoin-cli -testnet  getwalletinfo\r\n{\r\n  \"walletversion\": 60000,\r\n  \"balance\": 1937898.88787003,\r\n  \"unconfirmed_balance\": 0.00000000,\r\n  \"immature_balance\": 1275.53301591,\r\n  \"txcount\": 776267,\r\n  \"keypoololdest\": 1446285387,\r\n  \"keypoolsize\": 999999,\r\n  \"paytxfee\": 0.00000000\r\n}\r\n",
      "created_at" : "2015-11-18T21:46:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-157875145",
      "id" : 157875145,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-18T21:46:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157875145",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@pstratem Pull request 6850 will improve zapwallet / rescan time similarly with no memory increase. However, this pull request will be good for AddToWallets when near the tip, where there is intermittent CPU spiking when the indexes are recreated.\r\n\r\nIMO, this pull request is needed even with the memory increase, but 6850 is less controversial.",
      "created_at" : "2015-11-18T22:05:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6851#issuecomment-157879682",
      "id" : 157879682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6851",
      "updated_at" : "2015-11-18T22:05:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/157879682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15180124?v=3",
         "events_url" : "https://api.github.com/users/bittylicious/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bittylicious/followers",
         "following_url" : "https://api.github.com/users/bittylicious/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bittylicious/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bittylicious",
         "id" : 15180124,
         "login" : "bittylicious",
         "organizations_url" : "https://api.github.com/users/bittylicious/orgs",
         "received_events_url" : "https://api.github.com/users/bittylicious/received_events",
         "repos_url" : "https://api.github.com/users/bittylicious/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bittylicious/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bittylicious/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bittylicious"
      }
   }
]
