{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "I would like to propose splitting up our fuzz binary into one binary per fuzz harness (or at least have an option to build separate binaries). This would primarily enable properly compiling with LTO, which would have several benefits:\r\n* In environments where individual binaries are required/desired (e.g. oss-fuzz [1]), this has the benefit that each binary is as small as possible, resulting in less disk usage (nice for container images).\r\n* Enable afl++ to create a token dictionary at compile time, which only contains tokens that are found in code paths reachable by each individual harness.\r\n* Efficient and collision edge coverage tracking and more for afl++ see: https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.lto.md.\r\n* People designing and developing fuzzing engines recommend not linking unreachable code into fuzz binaries: https://github.com/google/fuzzing/blob/master/docs/good-fuzz-target.md#unreachable-code.\r\n\r\nThe only downside would be that linking multiple binaries is slower (this was the only reason for switching to compiling only one binary), but I think we can work around this by simply making this optional.\r\n\r\nTo achieve this we would need to:\r\n1. Change the build system to have an option to compile individual binaries\r\n3. Change the fuzzing framework to (optionally) have `FUZZ_TARGET` include the actual fuzz entry point directly (e.g. `LLVMFuzzerTestOneInput`) instead of accumulating all harness functions into a global map\r\n   * This probably requires splitting each harness into its own file",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971/comments",
   "created_at" : "2023-11-29T16:43:53Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/28971",
   "id" : 2017007554,
   "labels" : [
      {
         "color" : "ebd775",
         "default" : false,
         "description" : null,
         "id" : 64584,
         "name" : "Brainstorming",
         "node_id" : "MDU6TGFiZWw2NDU4NA==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Brainstorming"
      },
      {
         "color" : "d4c5f9",
         "default" : false,
         "description" : null,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII5854ORfC",
   "number" : 28971,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971/timeline",
   "title" : "fuzz, brainstorm: Individual binaries per harness",
   "updated_at" : "2023-11-29T16:57:58Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28971",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
      "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dergoegge/followers",
      "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dergoegge",
      "id" : 8077169,
      "login" : "dergoegge",
      "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
      "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
      "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
      "repos_url" : "https://api.github.com/users/dergoegge/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dergoegge"
   }
}
