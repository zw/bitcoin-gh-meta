[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28944).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [S3RK](https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1827377177) |\n| Stale ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/28944#pullrequestreview-1771199234), [murchandamus](https://github.com/bitcoin/bitcoin/pull/28944#pullrequestreview-1797513405) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28979](https://github.com/bitcoin/bitcoin/pull/28979) (wallet, rpc: document and update `sendall` behavior around unconfirmed inputs by ishaanam)\n* [#28710](https://github.com/bitcoin/bitcoin/pull/28710) (Remove the legacy wallet and BDB dependency by achow101)\n* [#24128](https://github.com/bitcoin/bitcoin/pull/24128) (wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-11-26T22:43:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1826925880",
      "id" : 1826925880,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585s5K04",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1826925880/reactions"
      },
      "updated_at" : "2024-03-06T05:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1826925880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-11-27T08:43:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1827377177",
      "id" : 1827377177,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585s65AZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1827377177/reactions"
      },
      "updated_at" : "2023-11-27T08:43:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1827377177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 5c9ac1456b7b4512845270cd850e5c33b643f575\r\n\r\nA test for `send` would be nice as well.",
      "created_at" : "2023-11-28T15:24:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1830068525",
      "id" : 1830068525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585tFKEt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830068525/reactions"
      },
      "updated_at" : "2023-11-28T15:24:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830068525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> A test for send would be nice as well.\r\n\r\nDone",
      "created_at" : "2023-11-29T17:05:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1832348500",
      "id" : 1832348500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585tN2tU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1832348500/reactions"
      },
      "updated_at" : "2023-11-29T17:05:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1832348500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414538735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414538735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5101f054ce435ac653a3f5e780fca066e2f25088 \"test: test sendall and send do anti-fee-sniping\"\r\n\r\nnit: `gettransaction` has a `verbose` argument that does the decoding so this doesn't need to call `decoderawtransaction`. Same below.",
      "commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "created_at" : "2023-12-04T21:42:23Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])[\"locktime\"], locktime)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414538735",
      "id" : 1414538735,
      "line" : 145,
      "node_id" : "PRRC_kwDOABII585UUCXv",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 145,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 4,
      "pull_request_review_id" : 1763485627,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414538735/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T21:43:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414538735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414539439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539439"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5101f054ce435ac653a3f5e780fca066e2f25088 \"test: test sendall and send do anti-fee-sniping\"\r\n\r\nnit: `getrawtransaction` has a `verbosity` option that will do the decoding, so no need to call `decoderawtransaction` here.",
      "commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "created_at" : "2023-12-04T21:43:01Z",
      "diff_hunk" : "@@ -379,6 +379,20 @@ def sendall_with_maxconf(self):\n         assert_equal(len(self.wallet.listunspent()), 1)\n         assert_equal(self.wallet.listunspent()[0]['confirmations'], 6)\n \n+    @cleanup\n+    def sendall_anti_fee_sniping(self):\n+        self.log.info(\"Testing sendall does anti-fee-sniping when locktime is not specified\")\n+        self.add_utxos([10,11])\n+        tx_from_wallet = self.test_sendall_success(sendall_args = [self.remainder_target])\n+\n+        assert_greater_than(tx_from_wallet[\"decoded\"][\"locktime\"], tx_from_wallet[\"blockheight\"] - 100)\n+\n+        self.add_utxos([10,11])\n+        txid = self.wallet.sendall(recipients=[self.remainder_target], options={\"locktime\":0})[\"txid\"]\n+        tx_from_wallet = self.wallet.decoderawtransaction(self.wallet.getrawtransaction(txid))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414539439",
      "id" : 1414539439,
      "line" : 392,
      "node_id" : "PRRC_kwDOABII585UUCiv",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_sendall.py",
      "position" : 14,
      "pull_request_review_id" : 1763485627,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539439/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T21:43:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414539685"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539685"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5101f054ce435ac653a3f5e780fca066e2f25088 \"test: test sendall and send do anti-fee-sniping\"\r\n\r\nShouldn't this check for `getblockcount() - 100`?",
      "commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "created_at" : "2023-12-04T21:43:16Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])[\"locktime\"], locktime)\n             return res\n+        else:\n+            if add_to_wallet:\n+                decoded_tx = from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])\n+                assert_greater_than(decoded_tx[\"locktime\"], 100)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414539685",
      "id" : 1414539685,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII585UUCml",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 150,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 9,
      "pull_request_review_id" : 1763485627,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539685/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T21:43:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414539685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414651395"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651395"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "created_at" : "2023-12-04T23:42:07Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])[\"locktime\"], locktime)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414651395",
      "id" : 1414651395,
      "in_reply_to_id" : 1414538735,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585UUd4D",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 145,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 1763648561,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651395/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T23:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414651744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651744"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "created_at" : "2023-12-04T23:42:15Z",
      "diff_hunk" : "@@ -379,6 +379,20 @@ def sendall_with_maxconf(self):\n         assert_equal(len(self.wallet.listunspent()), 1)\n         assert_equal(self.wallet.listunspent()[0]['confirmations'], 6)\n \n+    @cleanup\n+    def sendall_anti_fee_sniping(self):\n+        self.log.info(\"Testing sendall does anti-fee-sniping when locktime is not specified\")\n+        self.add_utxos([10,11])\n+        tx_from_wallet = self.test_sendall_success(sendall_args = [self.remainder_target])\n+\n+        assert_greater_than(tx_from_wallet[\"decoded\"][\"locktime\"], tx_from_wallet[\"blockheight\"] - 100)\n+\n+        self.add_utxos([10,11])\n+        txid = self.wallet.sendall(recipients=[self.remainder_target], options={\"locktime\":0})[\"txid\"]\n+        tx_from_wallet = self.wallet.decoderawtransaction(self.wallet.getrawtransaction(txid))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414651744",
      "id" : 1414651744,
      "in_reply_to_id" : 1414539439,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585UUd9g",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_sendall.py",
      "position" : null,
      "pull_request_review_id" : 1763648797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651744/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T23:42:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414651744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414652209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414652209"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "created_at" : "2023-12-04T23:42:28Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])[\"locktime\"], locktime)\n             return res\n+        else:\n+            if add_to_wallet:\n+                decoded_tx = from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])\n+                assert_greater_than(decoded_tx[\"locktime\"], 100)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1414652209",
      "id" : 1414652209,
      "in_reply_to_id" : 1414539685,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585UUeEx",
      "original_commit_id" : "5101f054ce435ac653a3f5e780fca066e2f25088",
      "original_line" : 150,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 1763649152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414652209/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T23:42:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414652209",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1417764868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417764868"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: blank line under this; ideally docs above",
      "commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "created_at" : "2023-12-06T18:00:50Z",
      "diff_hunk" : "@@ -213,6 +213,7 @@ struct CreatedTransactionResult\n         : tx(_tx), fee(_fee), fee_calc(_fee_calc), change_pos(_change_pos) {}\n };\n \n+void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng_fast, interfaces::Chain& chain, const uint256& block_hash, int block_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1417764868",
      "id" : 1417764868,
      "line" : 216,
      "node_id" : "PRRC_kwDOABII585UgWAE",
      "original_commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "original_line" : 216,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/spend.h",
      "position" : 4,
      "pull_request_review_id" : 1768286377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417764868/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-06T18:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417764868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1419702642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1419702642"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In f348eadadd6099e7763f04eb3d42cfd8bba33146 \"test: test sendall and send do anti-fee-sniping\"\r\n\r\nnit: `verbose` here too.",
      "commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "created_at" : "2023-12-07T21:56:04Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.gettransaction(txid=res[\"txid\"], verbose=True)[\"decoded\"][\"locktime\"], locktime)\n             return res\n+        else:\n+            if add_to_wallet:\n+                decoded_tx = from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1419702642",
      "id" : 1419702642,
      "line" : 149,
      "node_id" : "PRRC_kwDOABII585UnvFy",
      "original_commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "original_line" : 149,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 8,
      "pull_request_review_id" : 1771199234,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1419702642/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-07T21:56:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1419702642",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1421680771"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680771"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "a5ef4e226a854af75ca83c367633111407178918",
      "created_at" : "2023-12-10T04:09:21Z",
      "diff_hunk" : "@@ -213,6 +213,7 @@ struct CreatedTransactionResult\n         : tx(_tx), fee(_fee), fee_calc(_fee_calc), change_pos(_change_pos) {}\n };\n \n+void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng_fast, interfaces::Chain& chain, const uint256& block_hash, int block_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1421680771",
      "id" : 1421680771,
      "in_reply_to_id" : 1417764868,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585UvSCD",
      "original_commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "original_line" : 220,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/spend.h",
      "position" : 8,
      "pull_request_review_id" : 1773964140,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680771/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-10T04:09:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1421680795"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680795"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "a5ef4e226a854af75ca83c367633111407178918",
      "created_at" : "2023-12-10T04:09:31Z",
      "diff_hunk" : "@@ -142,7 +142,12 @@ def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n             return\n \n         if locktime:\n+            assert_equal(from_wallet.gettransaction(txid=res[\"txid\"], verbose=True)[\"decoded\"][\"locktime\"], locktime)\n             return res\n+        else:\n+            if add_to_wallet:\n+                decoded_tx = from_wallet.decoderawtransaction(from_wallet.gettransaction(res[\"txid\"])[\"hex\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1421680795",
      "id" : 1421680795,
      "in_reply_to_id" : 1419702642,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585UvSCb",
      "original_commit_id" : "f348eadadd6099e7763f04eb3d42cfd8bba33146",
      "original_line" : 149,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 1773964156,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680795/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-10T04:09:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1421680795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed silent merge conflict. ",
      "created_at" : "2023-12-27T20:19:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1870602431",
      "id" : 1870602431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585vfyC_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1870602431/reactions"
      },
      "updated_at" : "2023-12-27T20:19:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1870602431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2024-01-23T23:30:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1907088541",
      "id" : 1907088541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585xq9yd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1907088541/reactions"
      },
      "updated_at" : "2024-01-23T23:30:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1907088541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I circled back to review, I think this has a merge conflict",
      "created_at" : "2024-02-01T20:04:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1922141545",
      "id" : 1922141545,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII585ykY1p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1922141545/reactions"
      },
      "updated_at" : "2024-02-01T20:04:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1922141545",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1523853254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523853254"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In 8e5778a9fb6fbcbddd4ba87cc3f3caf41118592a (wallet, rpc: add anti-fee-sniping to `send` and `sendall`):\r\n\r\nIt seems to me that the `nSequence` check here is too restrictive. Locktime is disabled when _all_ sequences are set to final, but it seems to me that `can_anti_fee_snipe` would be set to `false` here, even if only one inputâs sequence is set to final.\r\n\r\nIâm not sure this would matter much in practice because most transactions would probably use the same sequence value for all inputs, but `can_anti_fee_snipe` should probably end up `true` if at least one `nSequence` is non-final?\r\n\r\nCould you perhaps add a test that a transaction with final `nSequence` values does not get its `locktime` set, but one with mixed values and one with all non-final `nSequence` values both do?",
      "commit_id" : "fa1fa3515841ad53ff214041f2bc7c9fbef17445",
      "created_at" : "2024-03-13T20:08:27Z",
      "diff_hunk" : "@@ -88,8 +88,21 @@ std::set<int> InterpretSubtractFeeFromOutputInstructions(const UniValue& sffo_in\n     return sffo_set;\n }\n \n-static UniValue FinishTransaction(const std::shared_ptr<CWallet> pwallet, const UniValue& options, const CMutableTransaction& rawTx)\n+static UniValue FinishTransaction(const std::shared_ptr<CWallet> pwallet, const UniValue& options, CMutableTransaction& rawTx)\n {\n+    bool can_anti_fee_snipe = !options.exists(\"locktime\");\n+\n+    for (const CTxIn& tx_in : rawTx.vin) {\n+        // Can not be FINAL for locktime to work\n+        can_anti_fee_snipe &= tx_in.nSequence != CTxIn::SEQUENCE_FINAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1523853254",
      "id" : 1523853254,
      "line" : 97,
      "node_id" : "PRRC_kwDOABII585a1CfG",
      "original_commit_id" : "8e5778a9fb6fbcbddd4ba87cc3f3caf41118592a",
      "original_line" : 97,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 11,
      "pull_request_review_id" : 1935111791,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523853254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-13T20:14:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523853254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> ```diff\r\n> --- a/test/functional/wallet_import_rescan.py\r\n> +++ b/test/functional/wallet_import_rescan.py\r\n> @@ -293,6 +293,7 @@ class ImportRescanTest(BitcoinTestFramework):\r\n>                  add_to_wallet=False,\r\n>                  inputs=[unspent_txid_map[variant.initial_txid]],\r\n>                  outputs=[{ADDRESS_BCRT1_UNSPENDABLE : variant.initial_amount}],\r\n> +                locktime=0,\r\n>                  subtract_fee_from_outputs=[0]\r\n>              )\r\n>              variant.child_txid = child[\"txid\"]\r\n> ```\r\n\r\nDone",
      "created_at" : "2024-03-14T21:44:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#issuecomment-1998532949",
      "id" : 1998532949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28944",
      "node_id" : "IC_kwDOABII5853HzFV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1998532949/reactions"
      },
      "updated_at" : "2024-03-14T21:44:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1998532949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1548649866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548649866"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> It seems to me that the `nSequence` check here is too restrictive. Locktime is disabled when _all_ sequences are set to final, but it seems to me that `can_anti_fee_snipe` would be set to `false` here, even if only one inputâs sequence is set to final.\r\n\r\nCurrently `DiscourageFeeSniping` will assert if any sequence is final, so this check is appropriate for now. It also enforces that the sequences are either `MAX_SEQUENCE_NONFINAL` or `MAX_BIP125_RBF_SEQUENCE`, so this needs to be checking that as well otherwise an assertion will be hit. Or a commit could be added to relax those checks.\r\n\r\n> Could you perhaps add a test that a transaction with final nSequence values does not get its locktime set, but one with mixed values and one with all non-final nSequence values both do?\r\n\r\nI would also like to see tests for other sequence numbers as there is a risk of reaching an assertion here.",
      "commit_id" : "fa1fa3515841ad53ff214041f2bc7c9fbef17445",
      "created_at" : "2024-04-02T21:48:07Z",
      "diff_hunk" : "@@ -88,8 +88,21 @@ std::set<int> InterpretSubtractFeeFromOutputInstructions(const UniValue& sffo_in\n     return sffo_set;\n }\n \n-static UniValue FinishTransaction(const std::shared_ptr<CWallet> pwallet, const UniValue& options, const CMutableTransaction& rawTx)\n+static UniValue FinishTransaction(const std::shared_ptr<CWallet> pwallet, const UniValue& options, CMutableTransaction& rawTx)\n {\n+    bool can_anti_fee_snipe = !options.exists(\"locktime\");\n+\n+    for (const CTxIn& tx_in : rawTx.vin) {\n+        // Can not be FINAL for locktime to work\n+        can_anti_fee_snipe &= tx_in.nSequence != CTxIn::SEQUENCE_FINAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28944#discussion_r1548649866",
      "id" : 1548649866,
      "in_reply_to_id" : 1523853254,
      "line" : 97,
      "node_id" : "PRRC_kwDOABII585cToWK",
      "original_commit_id" : "8e5778a9fb6fbcbddd4ba87cc3f3caf41118592a",
      "original_line" : 97,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 11,
      "pull_request_review_id" : 1975122510,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28944",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548649866/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-02T21:48:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548649866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
