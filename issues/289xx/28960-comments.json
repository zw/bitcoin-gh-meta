[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28960).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1831605764), [darosior](https://github.com/bitcoin/bitcoin/pull/28960#pullrequestreview-1787282671) |\n| Stale ACK | [jamesob](https://github.com/bitcoin/bitcoin/pull/28960#pullrequestreview-1818940398), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/28960#pullrequestreview-1830011358) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29256](https://github.com/bitcoin/bitcoin/pull/29256) (Improve new LogDebug/Trace/Info/Warning/Error Macros by ryanofsky)\n* [#29242](https://github.com/bitcoin/bitcoin/pull/29242) (Mempool util: Add RBF diagram checks for single chunks against clusters of size 2 by instagibbs)\n* [#29236](https://github.com/bitcoin/bitcoin/pull/29236) (log: Nuke error(...) by maflcko)\n* [#29015](https://github.com/bitcoin/bitcoin/pull/29015) (kernel: Streamline util library by ryanofsky)\n* [#28948](https://github.com/bitcoin/bitcoin/pull/28948) (v3 transaction policy for anti-pinning by glozow)\n* [#28886](https://github.com/bitcoin/bitcoin/pull/28886) (refactor: Replace sets of txiter with CTxMemPoolEntryRefs by TheCharlatan)\n* [#28830](https://github.com/bitcoin/bitcoin/pull/28830) ([refactor] Check CTxMemPool options in ctor by TheCharlatan)\n* [#28228](https://github.com/bitcoin/bitcoin/pull/28228) (kernel: Run sanity checks on context construction by TheCharlatan)\n* [#28031](https://github.com/bitcoin/bitcoin/pull/28031) (Package Relay 1/3: Introduce TxDownloadManager and improve orphan-handling by glozow)\n* [#27277](https://github.com/bitcoin/bitcoin/pull/27277) (Move log messages: tx enqueue to mempool, allocation to blockstorage by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-11-28T16:27:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1830244579",
      "id" : 1830244579,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tF1Dj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830244579/reactions"
      },
      "updated_at" : "2024-01-19T11:21:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830244579",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2023-11-29T10:17:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1831605764",
      "id" : 1831605764,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tLBYE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1831605764/reactions"
      },
      "updated_at" : "2023-11-29T10:17:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1831605764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-11-30T20:02:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1834463262",
      "id" : 1834463262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tV7Ae",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1834463262/reactions"
      },
      "updated_at" : "2023-11-30T20:02:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1834463262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-12-01T21:10:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1836781327",
      "id" : 1836781327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tew8P",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1836781327/reactions"
      },
      "updated_at" : "2023-12-01T21:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1836781327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1412791517"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412791517"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why?",
      "commit_id" : "f86c3e858f6bf708746b7c8fbcfe25707ca6467e",
      "created_at" : "2023-12-02T12:16:05Z",
      "diff_hunk" : "@@ -113,7 +123,7 @@ int main(int argc, char* argv[])\n \n \n     // SETUP: Chainstate\n-    auto chainparams = CChainParams::Main();\n+    auto chainparams = CChainParams::SigNet({});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1412791517",
      "id" : 1412791517,
      "line" : 126,
      "node_id" : "PRRC_kwDOABII585UNXzd",
      "original_commit_id" : "f86c3e858f6bf708746b7c8fbcfe25707ca6467e",
      "original_line" : 126,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : 60,
      "pull_request_review_id" : 1760865264,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412791517/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-02T12:16:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412791517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1412793508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412793508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just not done testing yet and SigNet is easier.",
      "commit_id" : "f86c3e858f6bf708746b7c8fbcfe25707ca6467e",
      "created_at" : "2023-12-02T12:32:19Z",
      "diff_hunk" : "@@ -113,7 +123,7 @@ int main(int argc, char* argv[])\n \n \n     // SETUP: Chainstate\n-    auto chainparams = CChainParams::Main();\n+    auto chainparams = CChainParams::SigNet({});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1412793508",
      "id" : 1412793508,
      "in_reply_to_id" : 1412791517,
      "line" : 126,
      "node_id" : "PRRC_kwDOABII585UNYSk",
      "original_commit_id" : "f86c3e858f6bf708746b7c8fbcfe25707ca6467e",
      "original_line" : 126,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : 60,
      "pull_request_review_id" : 1760867059,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412793508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-02T12:32:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1412793508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Undrafting this now. I tested this approach extensively against my proof of concept [C FFI](https://github.com/TheCharlatan/bitcoin/pull/7) and proof of concept [Rust library](https://github.com/TheCharlatan/rust-bitcoinkernel), and think it's not that bad an interface to have. Not sure why the msvc build is failing (only seems to be the Qt build?).",
      "created_at" : "2023-12-02T22:16:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1837267077",
      "id" : 1837267077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tgniF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1837267077/reactions"
      },
      "updated_at" : "2023-12-02T22:16:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1837267077",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Not sure why the msvc build is failing (only seems to be the Qt build?).\r\n\r\ncc @sipsorcery ",
      "created_at" : "2023-12-02T22:33:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1837269861",
      "id" : 1837269861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585tgoNl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1837269861/reactions"
      },
      "updated_at" : "2023-12-02T22:33:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1837269861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Maybe something in txmempool.h that the msvc compiler doesn't like?\r\n\r\n```\r\nD:\\a\\bitcoin\\bitcoin\\src\\txmempool.h(457,60): error C2143: syntax error: missing ')' before 'public' [D:\\a\\bitcoin\\bitcoin\\build_msvc\\libbitcoin_qt\\libbitcoin_qt.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\txmempool.h(457,60): error C2143: syntax error: missing ';' before 'public' [D:\\a\\bitcoin\\bitcoin\\build_msvc\\libbitcoin_qt\\libbitcoin_qt.vcxproj]\r\nD:\\a\\bitcoin\\bitcoin\\src\\txmempool.h(457,67): error C2059: syntax error: ')' [D:\\a\\bitcoin\\bitcoin\\build_msvc\\libbitcoin_qt\\libbitcoin_qt.vcxproj]\r\n```\r\n\r\nGiven it's a compiler, rather than a linker, error should be easy enough to replicate. I'll try and do so 2morrow",
      "created_at" : "2023-12-06T23:29:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1843853088",
      "id" : 1843853088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585t5vcg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1843853088/reactions"
      },
      "updated_at" : "2023-12-06T23:29:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1843853088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It's something to do with `CMainSignals&`. Wherever it's used in libbitcoin_qt the msvc compiler generates a syntax error of:\r\n\r\n`Error\tC2238\tunexpected token(s) preceding ';'`\t\r\n",
      "created_at" : "2023-12-08T23:32:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1847971114",
      "id" : 1847971114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585uJc0q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1847971114/reactions"
      },
      "updated_at" : "2023-12-08T23:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1847971114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It's something to do with `CMainSignals&`. Wherever it's used in libbitcoin_qt the msvc compiler generates a syntax error of:\r\n> \r\n> `Error C2238 unexpected token(s) preceding ';'`\r\n\r\nFixed in #29044.",
      "created_at" : "2023-12-09T16:19:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1848453153",
      "id" : 1848453153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585uLSgh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1848453153/reactions"
      },
      "updated_at" : "2023-12-09T16:19:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1848453153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This shouldn't have been closed i think @fanquake.",
      "created_at" : "2023-12-11T11:31:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1849887372",
      "id" : 1849887372,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585uQwqM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1849887372/reactions"
      },
      "updated_at" : "2023-12-11T11:31:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1849887372",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-12-11T17:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1850513110",
      "id" : 1850513110,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585uTJbW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1850513110/reactions"
      },
      "updated_at" : "2023-12-11T17:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1850513110",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1438670874"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1438670874"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Technically i think this reference can be dangling at `Shutdown()` (if there is still some wallets loaded) since we don't `reset()` the `node.wallet_loader` before resetting `node.main_signals`.",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2023-12-30T17:59:10Z",
      "diff_hunk" : "@@ -458,17 +459,20 @@ class NotificationsProxy : public CValidationInterface\n \n class NotificationsHandlerImpl : public Handler\n {\n+private:\n+    CMainSignals& m_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1438670874",
      "id" : 1438670874,
      "line" : 465,
      "node_id" : "PRRC_kwDOABII585VwGAa",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 463,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : 22,
      "pull_request_review_id" : 1799576749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1438670874/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-30T17:59:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1438670874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440249695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440249695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this moved to the header?",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2024-01-03T09:44:32Z",
      "diff_hunk" : "@@ -189,16 +155,53 @@ class CValidationInterface {\n     friend class ValidationInterfaceTest;\n };\n \n-class MainSignalsImpl;\n+/**\n+ * MainSignalsImpl manages a list of shared_ptr<CValidationInterface> callbacks.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440249695",
      "id" : 1440249695,
      "line" : 160,
      "node_id" : "PRRC_kwDOABII585V2Hdf",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 159,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 75,
      "pull_request_review_id" : 1801668068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440249695/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T09:44:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440249695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440318695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440318695"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Felt more natural to give a `CMainSignals` ownership of `MainSignalsImpl` instead of a `std::unique_ptr<MainSignalsImpl`, so it needs the full declaration of the class.",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2024-01-03T10:54:51Z",
      "diff_hunk" : "@@ -189,16 +155,53 @@ class CValidationInterface {\n     friend class ValidationInterfaceTest;\n };\n \n-class MainSignalsImpl;\n+/**\n+ * MainSignalsImpl manages a list of shared_ptr<CValidationInterface> callbacks.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440318695",
      "id" : 1440318695,
      "in_reply_to_id" : 1440249695,
      "line" : 160,
      "node_id" : "PRRC_kwDOABII585V2YTn",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 159,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 75,
      "pull_request_review_id" : 1801777178,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440318695/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T10:54:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440318695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440323203"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440323203"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Mmh, the destruction of `wallet_loader` is a bit weird, but doesn't it get reset when `node.chain_clients.clear()` is called at `Shutdown(...)`?",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2024-01-03T11:00:08Z",
      "diff_hunk" : "@@ -458,17 +459,20 @@ class NotificationsProxy : public CValidationInterface\n \n class NotificationsHandlerImpl : public Handler\n {\n+private:\n+    CMainSignals& m_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440323203",
      "id" : 1440323203,
      "in_reply_to_id" : 1438670874,
      "line" : 465,
      "node_id" : "PRRC_kwDOABII585V2ZaD",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 463,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : 22,
      "pull_request_review_id" : 1801784309,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440323203/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T11:00:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440323203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440329179"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440329179"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ok, but in the commit 4b9a37e461aee0c24f798123cdb023a783a130c6 I was looking at, the unique_ptr remains unchanged",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2024-01-03T11:07:35Z",
      "diff_hunk" : "@@ -189,16 +155,53 @@ class CValidationInterface {\n     friend class ValidationInterfaceTest;\n };\n \n-class MainSignalsImpl;\n+/**\n+ * MainSignalsImpl manages a list of shared_ptr<CValidationInterface> callbacks.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440329179",
      "id" : 1440329179,
      "in_reply_to_id" : 1440249695,
      "line" : 160,
      "node_id" : "PRRC_kwDOABII585V2a3b",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 159,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 75,
      "pull_request_review_id" : 1801794213,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440329179/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T11:07:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440329179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440349190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440349190"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, right, the ownership of the loader is in `node.chain_clients`:\r\nhttps://github.com/bitcoin/bitcoin/blob/65c05db660b2ca1d0076b0d8573a6760b3228068/src/wallet/init.cpp#L129-L131\r\n\r\nSo it's dropped before `node.main_signals` is.",
      "commit_id" : "717093f24b1ad65bc18b23eab492cfdcc2511e69",
      "created_at" : "2024-01-03T11:32:53Z",
      "diff_hunk" : "@@ -458,17 +459,20 @@ class NotificationsProxy : public CValidationInterface\n \n class NotificationsHandlerImpl : public Handler\n {\n+private:\n+    CMainSignals& m_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1440349190",
      "id" : 1440349190,
      "in_reply_to_id" : 1438670874,
      "line" : 465,
      "node_id" : "PRRC_kwDOABII585V2fwG",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 463,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : 22,
      "pull_request_review_id" : 1801827744,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440349190/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T11:32:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440349190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2024-01-03T13:12:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1875354008",
      "id" : 1875354008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585vx6GY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1875354008/reactions"
      },
      "updated_at" : "2024-01-03T13:12:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1875354008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased 717093f24b1ad65bc18b23eab492cfdcc2511e69 -> d63b2e88780dc78fd531b053653361a0bf3fcbea ([noGlobalSignals_0](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_0) -> [noGlobalSignals_1](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_1),  [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_0..noGlobalSignals_1))\r\n\r\n* Fix conflict with #29013",
      "created_at" : "2024-01-03T15:13:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1875530051",
      "id" : 1875530051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585vylFD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1875530051/reactions"
      },
      "updated_at" : "2024-01-03T15:13:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1875530051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1450864735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450864735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/28960/commits/d63b2e88780dc78fd531b053653361a0bf3fcbea\r\n\r\nI guess this periodic call was originally included to demonstrate how you might use the scheduler from the libbitcoinkernel interface, but now that we've removed the scheduler from the interface there isn't really an equivalent. Clients would be expected to run their own async event managers and periodic schedulers, which makes sense - and I guess is the whole point of this change!",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-12T19:46:41Z",
      "diff_hunk" : "@@ -68,16 +67,27 @@ int main(int argc, char* argv[])\n     Assert(InitSignatureCache(validation_cache_sizes.signature_cache_bytes));\n     Assert(InitScriptExecutionCache(validation_cache_sizes.script_execution_cache_bytes));\n \n+    class DummyQueue : public ValidationInterfaceQueue\n+    {\n+    public:\n+        DummyQueue() {}\n+        void AddToProcessQueue(std::function<void()> func) override\n+        {\n+            func();\n+        }\n \n-    // SETUP: Scheduling and Background Signals\n-    CScheduler scheduler{};\n-    // Start the lightweight task scheduler thread\n-    scheduler.m_service_thread = std::thread(util::TraceThread, \"scheduler\", [&] { scheduler.serviceQueue(); });\n+        void EmptyQueue() override\n+        {\n+            return;\n+        }\n \n-    CMainSignals main_signals{scheduler};\n+        size_t CallbacksPending() override\n+        {\n+            return 0;\n+        }\n+    };\n \n-    // Gather some entropy once per minute.\n-    scheduler.scheduleEvery(RandAddPeriodic, std::chrono::minutes{1});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1450864735",
      "id" : 1450864735,
      "line" : 78,
      "node_id" : "PRRC_kwDOABII585WenBf",
      "original_commit_id" : "d63b2e88780dc78fd531b053653361a0bf3fcbea",
      "original_line" : 78,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : 43,
      "pull_request_review_id" : 1818940398,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450864735/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T20:06:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450864735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453382756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453382756"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in the first commit: Any reason to re-order this and remove the doc comment?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-16T12:49:01Z",
      "diff_hunk" : "@@ -209,6 +212,43 @@ class CMainSignals {\n \n     size_t CallbacksPending();\n \n+    /** Register subscriber */\n+    void RegisterValidationInterface(CValidationInterface* callbacks);\n+    /** Unregister subscriber. DEPRECATED. This is not safe to use when the RPC server or main message handler thread is running. */\n+    void UnregisterValidationInterface(CValidationInterface* callbacks);\n+    /** Unregister all subscribers */\n+    void UnregisterAllValidationInterfaces();\n+\n+    // Alternate registration functions that release a shared_ptr after the last\n+    // notification is sent. These are useful for race-free cleanup, since\n+    // unregistration is nonblocking and can return before the last notification is\n+    // processed.\n+    /** Unregister subscriber */\n+    void UnregisterSharedValidationInterface(std::shared_ptr<CValidationInterface> callbacks);\n+\n+    void RegisterSharedValidationInterface(std::shared_ptr<CValidationInterface>);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453382756",
      "id" : 1453382756,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WoNxk",
      "original_commit_id" : "cfb94ef2b3ef6cebd6d01897663c375c969db727",
      "original_line" : 229,
      "original_position" : 146,
      "original_start_line" : 228,
      "path" : "src/validationinterface.h",
      "position" : null,
      "pull_request_review_id" : 1823257728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453382756/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-16T14:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453382756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453405057"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453405057"
         }
      },
      "author_association" : "MEMBER",
      "body" : "first commit: Why check below, but not here, for nullptr?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-16T13:08:43Z",
      "diff_hunk" : "@@ -291,7 +291,7 @@ void Shutdown(NodeContext& node)\n \n     // Because these depend on each-other, we make sure that neither can be\n     // using the other before destroying them.\n-    if (node.peerman) UnregisterValidationInterface(node.peerman.get());\n+    if (node.peerman) node.main_signals->UnregisterValidationInterface(node.peerman.get());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453405057",
      "id" : 1453405057,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WoTOB",
      "original_commit_id" : "cfb94ef2b3ef6cebd6d01897663c375c969db727",
      "original_line" : 294,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1823257728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453405057/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-16T14:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453405057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453413538"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453413538"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in the first commit: Could drop `signals` and use `active_chainstate.GetMainSignals()` instead?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-16T13:16:10Z",
      "diff_hunk" : "@@ -429,11 +429,12 @@ namespace {\n class MemPoolAccept\n {\n public:\n-    explicit MemPoolAccept(CTxMemPool& mempool, Chainstate& active_chainstate) :\n+    explicit MemPoolAccept(CTxMemPool& mempool, Chainstate& active_chainstate, CMainSignals& signals) :\n         m_pool(mempool),\n         m_view(&m_dummy),\n         m_viewmempool(&active_chainstate.CoinsTip(), m_pool),\n-        m_active_chainstate(active_chainstate)\n+        m_active_chainstate(active_chainstate),\n+        m_signals{signals}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453413538",
      "id" : 1453413538,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WoVSi",
      "original_commit_id" : "cfb94ef2b3ef6cebd6d01897663c375c969db727",
      "original_line" : 437,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 1823257728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453413538/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-16T14:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453413538",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453516899"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453516899"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Wouldn't it be better to use existing `chainman` references to get the signals reference, instead of using unchecked pointer dereferences? (Same in all other places)",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-16T14:34:51Z",
      "diff_hunk" : "@@ -761,12 +765,12 @@ class ChainImpl : public Chain\n     }\n     std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) override\n     {\n-        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications));\n+        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications), *m_node.main_signals);\n     }\n     void waitForNotificationsIfTipChanged(const uint256& old_tip) override\n     {\n         if (!old_tip.IsNull() && old_tip == WITH_LOCK(::cs_main, return chainman().ActiveChain().Tip()->GetBlockHash())) return;\n-        SyncWithValidationInterfaceQueue();\n+        m_node.main_signals->SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453516899",
      "id" : 1453516899,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Wouhj",
      "original_commit_id" : "cfb94ef2b3ef6cebd6d01897663c375c969db727",
      "original_line" : 773,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1823257728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453516899/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-16T14:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453516899",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453524696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453524696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Any reason to call it \"main\", when main.cpp has long been split up and renamed to validation.cpp? Could call it `validation_signals`, or leave it as is.",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-16T14:40:25Z",
      "diff_hunk" : "@@ -72,6 +73,7 @@ struct NodeContext {\n     std::function<void()> rpc_interruption_point = [] {};\n     std::unique_ptr<KernelNotifications> notifications;\n     std::atomic<int> exit_status{EXIT_SUCCESS};\n+    std::unique_ptr<CMainSignals> main_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453524696",
      "id" : 1453524696,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WowbY",
      "original_commit_id" : "cfb94ef2b3ef6cebd6d01897663c375c969db727",
      "original_line" : 76,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/context.h",
      "position" : null,
      "pull_request_review_id" : 1823257728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453524696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-16T14:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1453524696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the review @maflcko,\r\n\r\nUpdated d63b2e88780dc78fd531b053653361a0bf3fcbea -> 5755454fb5cc4067fc94e2682116e0fc5c9dfc58 ([noGlobalSignals_1](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_1) -> [noGlobalSignals_2](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_2), [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_1..noGlobalSignals_2))\r\n\r\n* Added a new first scripted-diff commit for renaming `MainSignals` to `ValidationSignals` as suggested by @maflcko's [comment_1](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453405057) and [comment_2](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453524696). Since most of the touched lines in the scripted-diff end up being touched anyway, this seems like a good opportunity for a rename.\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453382756), making the diffs a bit more move-only.\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453405057), consistently checking if `node.main_signals` is initialized in `init.cpp`'s `Shutdown()`.\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453413538), dropping `m_signals` member in `MemPoolAccept` and instead using `active_chainstate.GetValidationSignals()`.\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1453516899), using `chainman.m_signals` reference instead of the `m_node.main_signals` `unique_ptr`. Also applied this suggestion in some other places where references to the signals are available.\r\n\r\n\r\n",
      "created_at" : "2024-01-17T08:21:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1895309927",
      "id" : 1895309927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585w-CJn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1895309927/reactions"
      },
      "updated_at" : "2024-01-17T08:21:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1895309927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1454918683"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1454918683"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, I think we need the full declaration here, because other modules are now instantiating the `CMainSignals`.",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T08:22:21Z",
      "diff_hunk" : "@@ -189,16 +155,53 @@ class CValidationInterface {\n     friend class ValidationInterfaceTest;\n };\n \n-class MainSignalsImpl;\n+/**\n+ * MainSignalsImpl manages a list of shared_ptr<CValidationInterface> callbacks.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1454918683",
      "id" : 1454918683,
      "in_reply_to_id" : 1440249695,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WuEwb",
      "original_commit_id" : "4b9a37e461aee0c24f798123cdb023a783a130c6",
      "original_line" : 160,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : null,
      "pull_request_review_id" : 1826730420,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1454918683/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T08:22:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1454918683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455548750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455548750"
         }
      },
      "author_association" : "MEMBER",
      "body" : "second commit: I still don't understand why sometimes a nullptr check is done and sometimes not",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T13:21:20Z",
      "diff_hunk" : "@@ -399,7 +399,7 @@ bool BaseIndex::StartBackgroundSync()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    m_chain->context()->validation_signals->UnregisterValidationInterface(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455548750",
      "id" : 1455548750,
      "line" : 402,
      "node_id" : "PRRC_kwDOABII585WwelO",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 402,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : 23,
      "pull_request_review_id" : 1827284733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455548750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T14:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455548750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455680501"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455680501"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is the point of asserting here, when previously it wasn't (and already ran into UB)?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T14:16:45Z",
      "diff_hunk" : "@@ -1504,9 +1509,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts);\n+        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, *Assert(node.validation_signals));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455680501",
      "id" : 1455680501,
      "line" : 1506,
      "node_id" : "PRRC_kwDOABII585Ww-v1",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 1512,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 94,
      "pull_request_review_id" : 1827284733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455680501/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T14:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455680501",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455681352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455681352"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe assert in the first line of this function and create a reference?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T14:17:04Z",
      "diff_hunk" : "@@ -1504,9 +1509,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts);\n+        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, *Assert(node.validation_signals));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455681352",
      "id" : 1455681352,
      "in_reply_to_id" : 1455680501,
      "line" : 1506,
      "node_id" : "PRRC_kwDOABII585Ww-9I",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 1512,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 94,
      "pull_request_review_id" : 1827284733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455681352/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T14:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455681352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455749485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455749485"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm also not sure what to do with this one. We seem to be fine with not doing nullptr checks for very similar code, e.g. `base.cpp:89`, so I did not include any checks here. Maybe it is better to add a reference to the signals to `BaseIndex`?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T14:43:44Z",
      "diff_hunk" : "@@ -399,7 +399,7 @@ bool BaseIndex::StartBackgroundSync()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    m_chain->context()->validation_signals->UnregisterValidationInterface(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455749485",
      "id" : 1455749485,
      "in_reply_to_id" : 1455548750,
      "line" : 402,
      "node_id" : "PRRC_kwDOABII585WxPlt",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 402,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : 23,
      "pull_request_review_id" : 1827466242,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455749485/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T14:43:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455749485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455760981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455760981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> We seem to be fine with not doing nullptr checks for very similar code, e.g. base.cpp:89\r\n\r\nThat isn't run during shutdown, but during start, so the code path should be exercised in tests. Also, it is only \"temporary\", so will be removed in any case. Whereas the code here is run during shutdown, for which it is hard (impossible?) to test all code path permutations. Also it isn't temporary, is it?",
      "commit_id" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58",
      "created_at" : "2024-01-17T14:48:15Z",
      "diff_hunk" : "@@ -399,7 +399,7 @@ bool BaseIndex::StartBackgroundSync()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    m_chain->context()->validation_signals->UnregisterValidationInterface(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455760981",
      "id" : 1455760981,
      "in_reply_to_id" : 1455548750,
      "line" : 402,
      "node_id" : "PRRC_kwDOABII585WxSZV",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 402,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : 23,
      "pull_request_review_id" : 1827476586,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455760981/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T14:48:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455760981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455808582"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455808582"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, not temporary, and in the `Stop` case we should guard against early destruction of the signals in the `Shutdown` procedure. I'll add an `Assert` for this case.",
      "commit_id" : "487b12e18ce007379a997da48b5ee97f459f6342",
      "created_at" : "2024-01-17T15:07:47Z",
      "diff_hunk" : "@@ -399,7 +399,7 @@ bool BaseIndex::StartBackgroundSync()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    m_chain->context()->validation_signals->UnregisterValidationInterface(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455808582",
      "id" : 1455808582,
      "in_reply_to_id" : 1455548750,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WxeBG",
      "original_commit_id" : "a8267363f2cf70d9e63a6cac177437e9fd3193b4",
      "original_line" : 402,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : null,
      "pull_request_review_id" : 1827522001,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455808582/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T15:07:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1455808582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "5755454fb5cc4067fc94e2682116e0fc5c9dfc58 -> 487b12e18ce007379a997da48b5ee97f459f6342 ([noGlobalSignals_2](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_2) -> [noGlobalSignals_3](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_3), [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_2..noGlobalSignals_3))\r\n\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455548750), adding `Assert` to guard against early destruction of the signals in `base.cpp`.\r\n* Addressed @maflcko's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455680501), creating a reference of the signals at the top of `AppInitMain`.\r\n* Applied the same pattern to the `scheduler` in `AppInitMain`.",
      "created_at" : "2024-01-17T16:34:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1896179668",
      "id" : 1896179668,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585xBWfU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896179668/reactions"
      },
      "updated_at" : "2024-01-17T16:34:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896179668",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. This change removes removes `g_signals` and lets kernel applications call validation functions with separate schedulers so signals from different functions don't need to interfere with each other. It also lets kernel applications define their own scheduling logic, which may be useful if they want to control when notifications are processed.\r\n\r\nI think naming and organization could be improved though. Like `kernel::ValidationInterfaceQueue` seems seems like it should be called `util::SchedulerInterface` (since it is an abstract class and doesn't have to do with validation), and `DummyQueue` seems like it should be called `util::ImmediateScheduler` (since it is a fully functional class and not a dummy object).\r\n\r\nI'm not totally sure that `ImmediateScheduler` will be sufficient for libbitcoinkernel applications, and seems possible application may want to use `SingleThreadedSchedulerClient` instead (which I would call `SerialScheduler`) instead of an immediate scheduler, to avoiding having to spawn their own threads and deal with potential deadlocks. But it seems fine to exclude for now since we can always include it later if there is a use-case.\r\n\r\nEDIT: If we want to avoid \"Scheduler\" in the interface name because the interface doesn't let the caller control scheduling (the only scheduling option for callers is _whenever_) you could replace Scheduler in suggestions above with something like TaskQueue, WorkQueue, CallbackRunner, etc. But I think Scheduler is ok because the class controls scheduling even if the caller doesn't.",
      "created_at" : "2024-01-17T21:57:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1896988088",
      "id" : 1896988088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585xEb24",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896988088/reactions"
      },
      "updated_at" : "2024-01-17T22:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896988088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for looking this over @ryanofsky,\r\n\r\nUpdated 487b12e18ce007379a997da48b5ee97f459f6342 -> e3592ee55756c08bda3075b54cbff719d3fb964f ([noGlobalSignals_3](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_3) -> [noGlobalSignals_4](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_4), [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_3..noGlobalSignals_4))\r\n\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1896988088), renaming `ValidationInterfaceQueue` to `TaskQueueInterface` and `DummyQueue` to `ImmediateTaskQueue`.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1896988088), moving `ImmediateTaskQueue` and `TaskQueueInterface` to their own modules in `util/`.\r\n",
      "created_at" : "2024-01-18T10:32:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1898213458",
      "id" : 1898213458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585xJHBS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1898213458/reactions"
      },
      "updated_at" : "2024-01-18T10:32:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1898213458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457639359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457639359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"scripted-diff: Rename MainSignals to ValidationSignals\" (0fd494c4a856d7aefd4fd94a4d5f18ab5e59c2a2)\r\n\r\nNot important, but I think it would be a little nicer if scripted diff was last commit instead of first commit, because it's hard to tell whether renames are good or bad when the code is in flux, and better when you can see that names match state of the final code. Moving the scripted diff would also reduce churn within the PR so commit diffs are smaller and lines like this (which are being completely replaced later) do not change multiple times.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T15:45:29Z",
      "diff_hunk" : "@@ -77,7 +77,7 @@ int main(int argc, char* argv[])\n     // Gather some entropy once per minute.\n     scheduler.scheduleEvery(RandAddPeriodic, std::chrono::minutes{1});\n \n-    GetMainSignals().RegisterBackgroundSignalScheduler(scheduler);\n+    GetValidationSignals().RegisterBackgroundSignalScheduler(scheduler);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457639359",
      "id" : 1457639359,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4c-_",
      "original_commit_id" : "0fd494c4a856d7aefd4fd94a4d5f18ab5e59c2a2",
      "original_line" : 80,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457639359/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457639359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457656786"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457656786"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nThese wallet tests should be calling `wallet.chain().waitForNotificationsIfTipChanged({})` instead of `test_setup->m_node.validation_signals->SyncWithValidationInterfaceQueue`. This would make them more realistic and less tied to test and node internals.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T15:58:05Z",
      "diff_hunk" : "@@ -39,7 +39,7 @@ static void WalletBalance(benchmark::Bench& bench, const bool set_dirty, const b\n         generatetoaddress(test_setup->m_node, address_mine.value_or(ADDRESS_WATCHONLY));\n         generatetoaddress(test_setup->m_node, ADDRESS_WATCHONLY);\n     }\n-    SyncWithValidationInterfaceQueue();\n+    test_setup->m_node.validation_signals->SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457656786",
      "id" : 1457656786,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4hPS",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 42,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bench/wallet_balance.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457656786/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457656786",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457662881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457662881"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nMentioned earlier, but you should drop the new parameter here and just call `wallet->chain().waitForNotificationsIfTipChanged({})` instead of `SyncWithValidationInterfaceQueue`, for the same reasons",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:02:26Z",
      "diff_hunk" : "@@ -69,9 +69,9 @@ std::shared_ptr<CWallet> TestLoadWallet(WalletContext& context)\n     return TestLoadWallet(std::move(database), context, options.create_flags);\n }\n \n-void TestUnloadWallet(std::shared_ptr<CWallet>&& wallet)\n+void TestUnloadWallet(std::shared_ptr<CWallet>&& wallet, ValidationSignals& validation_signals)\n {\n-    SyncWithValidationInterfaceQueue();\n+    validation_signals.SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457662881",
      "id" : 1457662881,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4iuh",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 74,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/test/util.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457662881/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457662881",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457667372"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457667372"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nWould suggest organizing the parameters {validation_signals, interrupt, chainman_opts, blockman_opts} so ChainstateManager dependencies are first and ChainstateManager options are last. Also so dependencies and options are both ordered from high level to low level.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:05:53Z",
      "diff_hunk" : "@@ -126,7 +128,7 @@ int main(int argc, char* argv[])\n         .notifications = chainman_opts.notifications,\n     };\n     util::SignalInterrupt interrupt;\n-    ChainstateManager chainman{interrupt, chainman_opts, blockman_opts};\n+    ChainstateManager chainman{interrupt, chainman_opts, blockman_opts, validation_signals};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457667372",
      "id" : 1457667372,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4j0s",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 131,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457667372/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457667372",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457671335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457671335"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nNote: This is ugly, but #24230 replaces it with `m_chain->attachChain()`. Other changes to indexing code in this PR, which also don't look great, have similar replacements.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:08:57Z",
      "diff_hunk" : "@@ -89,7 +89,7 @@ bool BaseIndex::Init()\n         return &m_chain->context()->chainman->GetChainstateForIndexing());\n     // Register to validation interface before setting the 'm_synced' flag, so that\n     // callbacks are not missed once m_synced is true.\n-    RegisterValidationInterface(this);\n+    m_chain->context()->validation_signals->RegisterValidationInterface(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457671335",
      "id" : 1457671335,
      "line" : 92,
      "node_id" : "PRRC_kwDOABII585W4kyn",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 92,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : 5,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457671335/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457671335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457678045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457678045"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nSlight preference for passing validation_signals dependency parameter first and mempool_opts options parameter second, for consistency with ChainstateManager, and since signals dependency is required in theory it should be possible to omit the options parameter.\r\n\r\nIt might also be worth asking whether the signals parameter actually should be required, since mempool class does not need to send signals to function. We could add a `ValidationSignals*` option to `CTxMemPool::Options` that is allowed to be null, as an alternative to making this a required parameter.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:13:53Z",
      "diff_hunk" : "@@ -1504,9 +1510,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts);\n+        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, validation_signals);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457678045",
      "id" : 1457678045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4mbd",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 1513,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457678045/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457678045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457683117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457683117"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nNote: At some point we should see if it makes sense to deduplicate this function with `AppInit`  and `BasicTestingSetup::BasicTestingSetup` since all three functions are doing very similar things.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:17:43Z",
      "diff_hunk" : "@@ -99,6 +99,7 @@ class NodeImpl : public Node\n         if (!AppInitBasicSetup(args(), Assert(context())->exit_status)) return false;\n         if (!AppInitParameterInteraction(args())) return false;\n \n+        m_context->validation_signals = std::make_unique<ValidationSignals>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457683117",
      "id" : 1457683117,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4nqt",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 102,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457683117/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457683117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457687097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457687097"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nWould again suggest making make signals parameter first. `signals` is the hard dependency and input, `notifications` is the option and output.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:20:02Z",
      "diff_hunk" : "@@ -459,17 +460,20 @@ class NotificationsProxy : public CValidationInterface\n \n class NotificationsHandlerImpl : public Handler\n {\n+private:\n+    ValidationSignals& m_signals;\n+\n public:\n-    explicit NotificationsHandlerImpl(std::shared_ptr<Chain::Notifications> notifications)\n-        : m_proxy(std::make_shared<NotificationsProxy>(std::move(notifications)))\n+    explicit NotificationsHandlerImpl(std::shared_ptr<Chain::Notifications> notifications, ValidationSignals& signals)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457687097",
      "id" : 1457687097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4oo5",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 467,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457687097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457687097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457699474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457699474"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\n`m_signals` declaration should be moved directly above `m_proxy` declaration. IMO it is a bad practice to mix up method declarations and variable declarations in a class definition. The most important thing you can know about a class is what it information contains and what it represents, and that is difficult to do if you can't easily see a list of its member variables.\r\n\r\nAdditionally, all members of these classes should all be public to reduce boilerplate:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/6ffa572edd9693a3217eb201b9d147b44c5b4eb5/src/node/interfaces.cpp#L75-L76",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:28:47Z",
      "diff_hunk" : "@@ -459,17 +460,20 @@ class NotificationsProxy : public CValidationInterface\n \n class NotificationsHandlerImpl : public Handler\n {\n+private:\n+    ValidationSignals& m_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457699474",
      "id" : 1457699474,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4rqS",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 464,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457699474/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457699474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457711001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457711001"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nAny particular reason this is called m_signal not m_signals like the rest of the code? It is true that the Call method only sends one signal, but that is a property of the Call method, not the class. The Call method could easily send multiple signals, or another method could.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:37:43Z",
      "diff_hunk" : "@@ -64,14 +64,15 @@ class TestInterface : public CValidationInterface\n     {\n         if (m_on_call) m_on_call();\n     }\n-    static void Call()\n+    void Call()\n     {\n         CBlock block;\n         BlockValidationState state;\n-        GetValidationSignals().BlockChecked(block, state);\n+        m_signal.BlockChecked(block, state);\n     }\n     std::function<void()> m_on_call;\n     std::function<void()> m_on_destroy;\n+    ValidationSignals& m_signal;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457711001",
      "id" : 1457711001,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4ueZ",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 75,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/test/validationinterface_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457711001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457711001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457719624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457719624"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nI think it would make sense to move this member variable declaration after `mapDeltas` and before `m_max_size_bytes` member variable declarations below. Both `m_signals` and `m_max_size_bytes` are public members that are externally controlled (passed in as constructor arguments) so they would seem to belong together.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:44:33Z",
      "diff_hunk" : "@@ -396,6 +397,9 @@ class CTxMemPool\n     using Limits = kernel::MemPoolLimits;\n \n     uint64_t CalculateDescendantMaximum(txiter entry) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n+    ValidationSignals& m_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457719624",
      "id" : 1457719624,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4wlI",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 401,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457719624/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457719624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457724122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457724122"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nIt seems like it would be less verbose and more appropriate to use `m_pool.m_signals` instead of `m_active_chainstate.GetValidationSignals()` here and below on line 1272",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:48:05Z",
      "diff_hunk" : "@@ -1220,7 +1220,7 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n                                                        args.m_bypass_limits, args.m_package_submission,\n                                                        IsCurrentForFeeEstimation(m_active_chainstate),\n                                                        m_pool.HasNoInputsOf(tx));\n-        GetValidationSignals().TransactionAddedToMempool(tx_info, m_pool.GetAndIncrementSequence());\n+        m_active_chainstate.GetValidationSignals().TransactionAddedToMempool(tx_info, m_pool.GetAndIncrementSequence());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457724122",
      "id" : 1457724122,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4xra",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 1223,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457724122/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457724122",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457731191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457731191"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nMaybe consider eliminating this and just using `m_chainman.m_signals` directly. IMO that would be clearer and more consistent than having code occasionally call this method, and this method isn't actually called very many places.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T16:53:32Z",
      "diff_hunk" : "@@ -1705,6 +1705,11 @@ const CBlockIndex* Chainstate::SnapshotBase()\n     return m_cached_snapshot_base;\n }\n \n+ValidationSignals& Chainstate::GetValidationSignals()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457731191",
      "id" : 1457731191,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4zZ3",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 1708,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457731191/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457731191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457739617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457739617"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nI don't see a reason this class should be to be moved to the header, instead of just forward-declared like previously.\r\n\r\nI'm guessing maybe you were seeing link errors due to the `std::unique_ptr<ValidationSignalsImpl>` member below? If so this can be fixed by adding `ValidationSignals();` `~ValidationSignals();` to the header file and definitions to the cpp file. That way the compiler will not try to generate constructors and destructors while processing the header file and complain about the incomplete ValidationSignalsImpl definition.\r\n",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T17:00:13Z",
      "diff_hunk" : "@@ -189,16 +155,54 @@ class CValidationInterface {\n     friend class ValidationInterfaceTest;\n };\n \n-class ValidationSignalsImpl;\n+/**\n+ * ValidationSignalsImpl manages a list of shared_ptr<CValidationInterface> callbacks.\n+ *\n+ * A std::unordered_map is used to track what callbacks are currently\n+ * registered, and a std::list is used to store the callbacks that are\n+ * currently registered as well as any callbacks that are just unregistered\n+ * and about to be deleted when they are done executing.\n+ */\n+class ValidationSignalsImpl",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457739617",
      "id" : 1457739617,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W41dh",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 166,
      "original_position" : 81,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457739617/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457739617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457757251"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457757251"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] De-globalize ValidationSignals\" (6ffa572edd9693a3217eb201b9d147b44c5b4eb5)\r\n\r\nThis commit is very large, and would suggest splitting it up. The changes to validationinterface.h and validationinterface.cpp are unlike the other changes in the commit, and it would be nice if they could be done separately in an earlier commit. All the other changes are basically small 1-line replacements and insertions, while the validationinterface.h and validationinterface.cpp changes are moving around larger blocks of code.\r\n\r\nIt should be pretty easy to split this commit up by adding the new ValidationSignals methods with documention in an the earlier commit, while keeping the old standalone functions as one-line wrappers without documentation, and then deleting the wrappers in the next commit.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T17:15:09Z",
      "diff_hunk" : "@@ -209,6 +213,43 @@ class ValidationSignals {\n \n     size_t CallbacksPending();\n \n+    /** Register subscriber */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457757251",
      "id" : 1457757251,
      "line" : 180,
      "node_id" : "PRRC_kwDOABII585W45xD",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 180,
      "original_position" : 133,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 109,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457757251/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457757251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457779597"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457779597"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] Make MainSignalsImpl RAII styled\" (06191f38997a02460482efa6b519607406fe5c44)\r\n\r\nOk, looking at this diff, now I understand why `ValidationSignalsImpl` was moved from the .cpp to the .h in the previous commit.\r\n\r\nBut I would not recommend this change, because it makes the previous diff and this diff both substantially larger than they need to be, and it makes the code organization nonsensical.\r\n\r\nPreviously, the code was using a pointer-to-implementation pattern to keep the external class definition smaller and more stable. Arguably there's isn't a reason to do this anymore, because the external class isn't a global variable that is initialized before main() runs anymore. But the logical way to clean up it would be to consolidate the two class definitions into a single class, not just embed one class inside the other class.\r\n\r\nI think the best thing to do here would be to keep this m_internals as a unique_ptr to reduce the size of this PR and not make unnecessary changes. You can still achieve the goal of making ValidationSignals class an RAII class by just doing `m_internals = std::make_unique<ValidationSignalsImpl>(scheduler);` in the constructor rather than in a separate ` `RegisterBackgroundSignalScheduler` method. This would eliminate most of the diffs in this commit and keep the ValidationSignals implementation coherent.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T17:34:18Z",
      "diff_hunk" : "@@ -201,13 +201,11 @@ class ValidationSignalsImpl\n \n class ValidationSignals {\n private:\n-    std::unique_ptr<ValidationSignalsImpl> m_internals;\n+    ValidationSignalsImpl m_internals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457779597",
      "id" : 1457779597,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W4_ON",
      "original_commit_id" : "06191f38997a02460482efa6b519607406fe5c44",
      "original_line" : 204,
      "original_position" : 5,
      "original_start_line" : 204,
      "path" : "src/validationinterface.h",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457779597/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457779597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457796715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457796715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] Move scheduler client to CMainSignals\" (3a6241064ed8bc35d7e159978d40049ed3680a44)\r\n\r\nI don't think this change makes sense, and would suggest reverting. The point of the internals class is to contain the internals, following the pointer-to-implementation pattern (https://en.cppreference.com/w/cpp/language/pimpl) and keeping the ValidationSignals internal reliance on the scheduder out of the header, and out of view of callers.\r\n\r\nIf some of the internals are inside the internals class and other internals are outside of the internals class, it creates an arbitrary and hard to explain inconsistency. There should be some real benefits to this change for it to make sense.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T17:49:50Z",
      "diff_hunk" : "@@ -193,16 +188,18 @@ class ValidationSignalsImpl\n     template <typename F> void Iterate(F&& f) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n \n     friend class ValidationSignals;\n-\n-public:\n-    explicit ValidationSignalsImpl(CScheduler& scheduler LIFETIMEBOUND) : m_schedulerClient(scheduler) {}\n };\n \n \n class ValidationSignals {\n private:\n     ValidationSignalsImpl m_internals;\n \n+    // We are not allowed to assume the scheduler only runs in one thread,\n+    // but must ensure all callbacks happen in-order, so we end up creating\n+    // our own queue here :(\n+    SingleThreadedSchedulerClient m_schedulerClient;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457796715",
      "id" : 1457796715,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W5DZr",
      "original_commit_id" : "3a6241064ed8bc35d7e159978d40049ed3680a44",
      "original_line" : 201,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457796715/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457796715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457805770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457805770"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"kernel: Remove dependency on CScheduler\" (e3592ee55756c08bda3075b54cbff719d3fb964f)\r\n\r\nI think `immediate_task_queue.h` and `task_queue_interface.h` should be consolidated into a single `task_queue.h` so functionality provided is clear and discoverable. Both classes are very small and lightweight, and the interface class is header-only, so it should not introduce any build overhead or any significant compile overhead to combine them. It would also be good to mention in a comment that other implementations of the task queue interface are possible, such as the `SingleThreadedSchedulerClient` implementation in scheduler.cpp.\r\n\r\nThinking more about [naming](https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1896988088), I think having \"queue\" in the name is not great because it implies an order of execution and existence of a queue which may not exist. I think a better name would be `TaskRunner` as the only thing the interface provides is a way to run tasks without control over when and how they will be run.\r\n\r\nI think there should also be a scripted diff renaming `SingleThreadedSchedulerClient` to `SerialTaskRunner` to keep class names consistent. And renaming `AddToProcessQueue` to `Insert` or `insert`, `EmptyQueue` to `Clear` or `clear` and `CallbacksPending` to `Size` or `size` to be consistent with c++ container conventions.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T17:58:49Z",
      "diff_hunk" : "@@ -0,0 +1,25 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_IMMEDIATE_TASK_QUEUE_H\n+#define BITCOIN_UTIL_IMMEDIATE_TASK_QUEUE_H\n+\n+#include <util/task_queue_interface.h>\n+\n+#include <cstddef>\n+#include <functional>\n+\n+namespace util {\n+\n+class ImmediateTaskQueue : public TaskQueueInterface",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457805770",
      "id" : 1457805770,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W5FnK",
      "original_commit_id" : "e3592ee55756c08bda3075b54cbff719d3fb964f",
      "original_line" : 15,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/util/immediate_task_queue.h",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457805770/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457805770",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457841713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457841713"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Probably not important, but the comments in this file become slightly out of date because the final line in `validation.cpp` looks like `if (signals.CallbacksPending() > 10)`",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-18T18:35:06Z",
      "diff_hunk" : "@@ -17,21 +17,21 @@ NON_DETERMINISTIC_TESTS=(\n     \"blockfilter_index_tests/blockfilter_index_initial_sync\"  # src/checkqueue.h: In CCheckQueue::Loop(): while (queue.empty()) { ... }\n     \"coinselector_tests/knapsack_solver_test\"                 # coinselector_tests.cpp: if (equal_sets(setCoinsRet, setCoinsRet2))\n     \"fs_tests/fsbridge_fstream\"                               # deterministic test failure?\n-    \"miner_tests/CreateNewBlock_validity\"                     # validation.cpp: if (GetMainSignals().CallbacksPending() > 10)\n+    \"miner_tests/CreateNewBlock_validity\"                     # validation.cpp: if (GetValidationSignals().CallbacksPending() > 10)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457841713",
      "id" : 1457841713,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W5OYx",
      "original_commit_id" : "e3592ee55756c08bda3075b54cbff719d3fb964f",
      "original_line" : 20,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "contrib/devtools/test_deterministic_coverage.sh",
      "position" : null,
      "pull_request_review_id" : 1830011358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457841713/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-18T18:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1457841713",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the review and detailed comments @ryanofsky!\r\n\r\nRebased e3592ee55756c08bda3075b54cbff719d3fb964f -> 2ef630f3e49f11cbae7abe2dc31c2a908bb5e6ba ([noGlobalSignals_4](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_4) -> [noGlobalSignals_5](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_5), [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_4..noGlobalSignals_5))\r\n\r\nUpdated 2ef630f3e49f11cbae7abe2dc31c2a908bb5e6ba -> 492ff2c504d1da3f4ae8704a5485a286ee76f0d9 ([noGlobalSignals_5](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_5) -> [noGlobalSignals_6](https://github.com/TheCharlatan/bitcoin/tree/noGlobalSignals_6), [compare](https://github.com/TheCharlatan/bitcoin/compare/noGlobalSignals_5..noGlobalSignals_6))\r\n\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457639359), removing the renaming of `GetMainSignals()`, but leaving the current commit order intact. Not renaming `GetMainSignals()` reduces churn and is not useful in any case, since it is removed later on.\r\n* Addressed @ryanofsky's [comment_1](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457656786) and [comment_2](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457662881), using `wallet->chain().waitForNotificationsIfTipChanged()` instead of `test_setup->m_node.validation_signals->SyncWithValidationInterfaceQueue()`.\r\n* Addressed @ryanofsky's [comment_1](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457667372), [comment_2](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457678045), [comment_3](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457687097), [comment_4](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457699474), [comment_5](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457719624), fixing ordering of the various `signals` declarations.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457711001), fixing naming from `m_signal` to `m_signals` in the `validationinterface_tests`.\r\n* Addressed @ryanofsky's [comment_1](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457731191), [comment_2](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457724122), removing the `GetValidationSignals()` helper in `ChainState` and replacing it with direct access to available `m_signals` references.\r\n* Addressed @ryanofsky's [comment_1](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457739617), [comment_2](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457779597), no longer moving `ValidationSignalsImpl` to the header.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457757251), splitting the second commit de-globalizing the signals into two commits; one for moving functions into the `ValidationSignals` class, and another for actually removing the `g_signals`.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457796715), dropping the commit that moved the scheduler client to the `ValidationSignals`. Note that this patch set still retains the move of the `m_serial_task_runner` to the `ValidationSignals` in the last commit. This should be fine, since no additional details are leaked, and it makes the responsibilities of `ValidationSignalsImpl` more singular.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457805770), adding a scripted-diff commit for renaming the `SingleThreadedScheduler` to `SerialTaskRunner` and correspondingly adjust its related class methods.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1457805770), merging the two previously introduced headers into one `util/task_queue.h`.\r\n",
      "created_at" : "2024-01-19T11:22:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1900227084",
      "id" : 1900227084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585xQyoM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1900227084/reactions"
      },
      "updated_at" : "2024-01-19T12:41:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1900227084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1458838935"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458838935"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> It might also be worth asking whether the signals parameter actually should be required.\r\n\r\nIt is used in `CTxMemPool` methods, so should be required, no? Or are you saying these classes should be given the option to not be sending signals in the first place? In that case, I don't see what the difference between the mempool and the other validation classes is. The signals could be optional in the chainman too.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T11:26:30Z",
      "diff_hunk" : "@@ -1504,9 +1510,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts);\n+        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, validation_signals);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1458838935",
      "id" : 1458838935,
      "in_reply_to_id" : 1457678045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W9B2X",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 1513,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1832213207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458838935/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T11:26:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458838935",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1458922669"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458922669"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1458838935\r\n\r\n> The signals could be optional in the chainman too.\r\n\r\nYes, absolutely. The question is in cases where libbitcoinkernel applications don't care about receiving signals (if maybe just they are just validating a block), should they be forced to declare `ValidationSignals validation_signals{std::make_unique<util::ImmediateTaskRunner>()};` and pass a `validation_signals` parameter to the ChainstateManager object that won't do any real work. Eliminating this requirement might be good for libbitocoinkernel usability, but it would make validation code a little more verbose, because it would need to check if the signals object is null before sending signal. I don't have a real opinion about this, so I think the current approach seems pretty reasonable.\r\n\r\nThe mempool case is slightly different though. It sends fewer signals than validation code, and maybe requiring a new CTxMempool constructor argument will add pointless verbosity to mempool tests. So I think the mempool case is more worth thinking about and maybe getting some feedback from others familiar the mempool code. They may prefer to let this be optional.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T12:23:49Z",
      "diff_hunk" : "@@ -1504,9 +1510,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts);\n+        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, validation_signals);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1458922669",
      "id" : 1458922669,
      "in_reply_to_id" : 1457678045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585W9WSt",
      "original_commit_id" : "6ffa572edd9693a3217eb201b9d147b44c5b4eb5",
      "original_line" : 1513,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1832387071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458922669/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T12:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1458922669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20654065729</sub>",
      "created_at" : "2024-01-19T12:24:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#issuecomment-1900324259",
      "id" : 1900324259,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
      "node_id" : "IC_kwDOABII585xRKWj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1900324259/reactions"
      },
      "updated_at" : "2024-01-19T12:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1900324259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459116286"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459116286"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: De-globalize g_signals\" (e7c060866267fb99c77f80a959bfeb5204d1d3a5)\r\n\r\nI think it would be more consistent to use the  local `validation_signals` variable here instead of the node variable. Same on line 1608 below",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T14:36:19Z",
      "diff_hunk" : "@@ -1506,7 +1516,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n             // Drain the validation interface queue to ensure that the old indexes\n             // don't have any pending work.\n-            SyncWithValidationInterfaceQueue();\n+            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459116286",
      "id" : 1459116286,
      "line" : 1514,
      "node_id" : "PRRC_kwDOABII585W-Fj-",
      "original_commit_id" : "e7c060866267fb99c77f80a959bfeb5204d1d3a5",
      "original_line" : 1519,
      "original_position" : 109,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 134,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459116286/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459116286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459145667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459145667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: De-globalize g_signals\" (e7c060866267fb99c77f80a959bfeb5204d1d3a5)\r\n\r\nMaybe move this declaration up next to the notifications member since both are ways of receiving notifications from validation code.\r\n\r\n-  `NodeContext::notifications` sends high level messages about sync status and errors and warnings, which are blocking and only received by a single recipient (the UI).\r\n-  `NodeContext::validation_signals` sends lower messages about blocks and transactions, which are non-blocking, and are sent to multiple recipients (wallets, indexes, and the fee estimator). \r\n\r\nMight be useful to compare these in a code comment.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T14:51:45Z",
      "diff_hunk" : "@@ -72,6 +73,7 @@ struct NodeContext {\n     std::function<void()> rpc_interruption_point = [] {};\n     std::unique_ptr<KernelNotifications> notifications;\n     std::atomic<int> exit_status{EXIT_SUCCESS};\n+    std::unique_ptr<ValidationSignals> validation_signals;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459145667",
      "id" : 1459145667,
      "line" : 76,
      "node_id" : "PRRC_kwDOABII585W-MvD",
      "original_commit_id" : "e7c060866267fb99c77f80a959bfeb5204d1d3a5",
      "original_line" : 76,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/context.h",
      "position" : 12,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459145667/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459145667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459152304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459152304"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: De-globalize g_signals\" (e7c060866267fb99c77f80a959bfeb5204d1d3a5)\r\n\r\nPossible inconsistency between signal/signals here ",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T14:55:31Z",
      "diff_hunk" : "@@ -52,8 +52,8 @@ BOOST_AUTO_TEST_CASE(unregister_validation_interface_race)\n class TestInterface : public CValidationInterface\n {\n public:\n-    TestInterface(std::function<void()> on_call = nullptr, std::function<void()> on_destroy = nullptr)\n-        : m_on_call(std::move(on_call)), m_on_destroy(std::move(on_destroy))\n+    TestInterface(ValidationSignals& signal, std::function<void()> on_call = nullptr, std::function<void()> on_destroy = nullptr)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459152304",
      "id" : 1459152304,
      "line" : 55,
      "node_id" : "PRRC_kwDOABII585W-OWw",
      "original_commit_id" : "e7c060866267fb99c77f80a959bfeb5204d1d3a5",
      "original_line" : 55,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/test/validationinterface_tests.cpp",
      "position" : 26,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459152304/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459152304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459154811"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459154811"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: De-globalize g_signals\" (e7c060866267fb99c77f80a959bfeb5204d1d3a5)\r\n\r\nMaybe some unintended whitespace changes here and below",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T14:57:04Z",
      "diff_hunk" : "@@ -396,6 +397,7 @@ class CTxMemPool\n     using Limits = kernel::MemPoolLimits;\n \n     uint64_t CalculateDescendantMaximum(txiter entry) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459154811",
      "id" : 1459154811,
      "line" : 400,
      "node_id" : "PRRC_kwDOABII585W-O97",
      "original_commit_id" : "e7c060866267fb99c77f80a959bfeb5204d1d3a5",
      "original_line" : 400,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : 12,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459154811/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459154811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459163630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459163630"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: De-globalize g_signals\" (e7c060866267fb99c77f80a959bfeb5204d1d3a5)\r\n\r\nI see 2 changes to this function which are necessary, and 9 changes which are not needed. It's not important, but I'd suggest reverting all the changes in this function except the on lines 1145-6 above and lines 1167-8 below. Moving the `std::make_unique<CScheduler>()` call is the most important change here, and the other changes do not seem like a significant cleanup and are distracting.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T15:02:49Z",
      "diff_hunk" : "@@ -1142,19 +1142,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         return InitError(strprintf(_(\"Unable to allocate memory for -maxsigcachesize: '%s' MiB\"), args.GetIntArg(\"-maxsigcachesize\", DEFAULT_MAX_SIG_CACHE_BYTES >> 20)));\n     }\n \n-    assert(!node.scheduler);\n-    node.scheduler = std::make_unique<CScheduler>();\n-\n     // Start the lightweight task scheduler thread\n-    node.scheduler->m_service_thread = std::thread(util::TraceThread, \"scheduler\", [&] { node.scheduler->serviceQueue(); });",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459163630",
      "id" : 1459163630,
      "line" : 1143,
      "node_id" : "PRRC_kwDOABII585W-RHu",
      "original_commit_id" : "552a653b99c7743799def64016edb9cc9c6f13f2",
      "original_line" : 1149,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 69,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459163630/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459163630",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459176013"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459176013"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"scripted-diff: Rename SingleThreadedSchedulerClient to SerialTaskRunner\" (46defde7a60afe186629481b738225919f874342)\r\n\r\nI think I made a bad suggestion earlier to call this method \"clear\". I mistakenly thought this was discarding callbacks, but it appears to wait for all the callbacks to run. In light of this, I think it would be better to call this method \"flush\" or \"wait\".",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T15:11:13Z",
      "diff_hunk" : "@@ -182,7 +182,7 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void()> func\n     MaybeScheduleProcessQueue();\n }\n \n-void SingleThreadedSchedulerClient::EmptyQueue()\n+void SerialTaskRunner::clear()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459176013",
      "id" : 1459176013,
      "line" : 185,
      "node_id" : "PRRC_kwDOABII585W-UJN",
      "original_commit_id" : "46defde7a60afe186629481b738225919f874342",
      "original_line" : 185,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/scheduler.cpp",
      "position" : 43,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459176013/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459176013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459185693"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459185693"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"kernel: Remove dependency on CScheduler\" (492ff2c504d1da3f4ae8704a5485a286ee76f0d9)\r\n\r\nI think it would be clearer just to inline these methods and eliminate this file. If not eliminating this file, I would also consider it renaming it to just `util/task_runner.cpp` so it easier to find next to the header file.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T15:17:36Z",
      "diff_hunk" : "@@ -0,0 +1,26 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <util/task_runner.h>\n+\n+#include <functional>\n+\n+namespace util {\n+\n+void ImmediateTaskRunner::insert(std::function<void()> func)\n+{\n+    func();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459185693",
      "id" : 1459185693,
      "line" : 13,
      "node_id" : "PRRC_kwDOABII585W-Wgd",
      "original_commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "original_line" : 13,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/util/immediate_task_runner.cpp",
      "position" : 13,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459185693/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459185693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459197068"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459197068"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"kernel: Remove dependency on CScheduler\" (492ff2c504d1da3f4ae8704a5485a286ee76f0d9)\r\n\r\nI'd consider the leaving this declaration inside the ValidationSignalsImpl class instead of moving it here. This would adhere more closely to the [pointer-to-implementation](https://en.cppreference.com/w/cpp/language/pimpl) pattern and ensure future ValidationSignalsImpl methods can access all private members of the class, not just some of them. It would also just move less code around unnecessarily.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T15:24:57Z",
      "diff_hunk" : "@@ -160,8 +162,13 @@ class ValidationSignals {\n private:\n     std::unique_ptr<ValidationSignalsImpl> m_internals;\n \n+    // We are not allowed to assume the scheduler only runs in one thread,\n+    // but must ensure all callbacks happen in-order, so we end up creating\n+    // our own queue here :(\n+    std::unique_ptr<util::TaskRunnerInterface> m_serial_task_runner;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459197068",
      "id" : 1459197068,
      "line" : 168,
      "node_id" : "PRRC_kwDOABII585W-ZSM",
      "original_commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "original_line" : 168,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 23,
      "pull_request_review_id" : 1832865694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459197068/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T15:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459197068",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459267014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459267014"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would have to capture it then in the lambda, which seems less clear to me.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T16:11:00Z",
      "diff_hunk" : "@@ -1506,7 +1516,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n             // Drain the validation interface queue to ensure that the old indexes\n             // don't have any pending work.\n-            SyncWithValidationInterfaceQueue();\n+            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459267014",
      "id" : 1459267014,
      "in_reply_to_id" : 1459116286,
      "line" : 1514,
      "node_id" : "PRRC_kwDOABII585W-qXG",
      "original_commit_id" : "e7c060866267fb99c77f80a959bfeb5204d1d3a5",
      "original_line" : 1519,
      "original_position" : 109,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 134,
      "pull_request_review_id" : 1833167076,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459267014/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T16:11:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459267014",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459279757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459279757"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> ensure future ValidationSignalsImpl methods can access all private members of the class, not just some of them.\r\n\r\nI don't follow here. `ValidationSignalsImpl` is not a friend of `ValidationSignals`, so I'm not sure which access you are talking about here. Moving it just seems more SOLID to me and I am not sure how this is violating the pimpl pattern, but I feel like I am missing something.\r\n\r\n",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T16:19:18Z",
      "diff_hunk" : "@@ -160,8 +162,13 @@ class ValidationSignals {\n private:\n     std::unique_ptr<ValidationSignalsImpl> m_internals;\n \n+    // We are not allowed to assume the scheduler only runs in one thread,\n+    // but must ensure all callbacks happen in-order, so we end up creating\n+    // our own queue here :(\n+    std::unique_ptr<util::TaskRunnerInterface> m_serial_task_runner;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459279757",
      "id" : 1459279757,
      "in_reply_to_id" : 1459197068,
      "line" : 168,
      "node_id" : "PRRC_kwDOABII585W-teN",
      "original_commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "original_line" : 168,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/validationinterface.h",
      "position" : 23,
      "pull_request_review_id" : 1833189430,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459279757/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T16:19:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459279757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459324535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459324535"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Leaving this for now. The pattern was suggested here https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1455681352 and I think it makes sense to apply it to the scheduler as well.",
      "commit_id" : "492ff2c504d1da3f4ae8704a5485a286ee76f0d9",
      "created_at" : "2024-01-19T16:45:11Z",
      "diff_hunk" : "@@ -1142,19 +1142,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         return InitError(strprintf(_(\"Unable to allocate memory for -maxsigcachesize: '%s' MiB\"), args.GetIntArg(\"-maxsigcachesize\", DEFAULT_MAX_SIG_CACHE_BYTES >> 20)));\n     }\n \n-    assert(!node.scheduler);\n-    node.scheduler = std::make_unique<CScheduler>();\n-\n     // Start the lightweight task scheduler thread\n-    node.scheduler->m_service_thread = std::thread(util::TraceThread, \"scheduler\", [&] { node.scheduler->serviceQueue(); });",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28960#discussion_r1459324535",
      "id" : 1459324535,
      "in_reply_to_id" : 1459163630,
      "line" : 1143,
      "node_id" : "PRRC_kwDOABII585W-4Z3",
      "original_commit_id" : "552a653b99c7743799def64016edb9cc9c6f13f2",
      "original_line" : 1149,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 69,
      "pull_request_review_id" : 1833235155,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459324535/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-19T16:45:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1459324535",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   }
]
