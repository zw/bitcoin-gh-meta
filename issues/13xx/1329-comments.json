[
   {
      "body" : "If everyone thinks the other correction substitutions are a bad idea, those can be removed, let me know....\n",
      "created_at" : "2012-05-17T14:33:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5765151",
      "id" : 5765151,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-17T14:33:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5765151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I'd really rather do something like highlight them in red in the interface rather than silently correct them. But maybe thats just me?\n\nI don't think we should correct them for the same reason that we don't try all 1596 one character variations when an address is invalid to see if any give a proper hash even though it would be computationally cheap:  Because its not that unlikely to correct to the wrong thing and/or the detection of a single typo may indicate multiple typos. ... and once coin is sent to a bogus address it is absolutely irreparably unrecoverable. \n\nI figured that the confusion resistant base was to reduce the risk of badguys creating lookalike addresses and to make typos more likely to be detected (it's not uncommon for our weak 'checksum' to permit typos), not for silent automatic correction.\n\n",
      "created_at" : "2012-05-18T03:07:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5779142",
      "id" : 5779142,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-18T03:07:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5779142",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I've removed the correction. After the last commit, the O and 0 and such can no longer be typed the address field and it will only accept true base58 characters (and whitespaces, which are deleted).\n",
      "created_at" : "2012-05-18T06:59:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5780876",
      "id" : 5780876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-18T07:00:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5780876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r847483"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847483"
         }
      },
      "body" : "This should be moved into the for loop, IMO:\n```C++\nfor(unsigned int idx = 0; idx < input.size(); removeChar ? input.remove(idx, 1) : ++idx)\n```\n(also changed idx type to unsigned since it is compared with .size())\n",
      "commit_id" : "ce7896070cc0adbf973e1714fba6a729c1df1411",
      "created_at" : "2012-05-18T19:36:41Z",
      "diff_hunk" : "@@ -21,21 +21,28 @@\n QValidator::State BitcoinAddressValidator::validate(QString &input, int &pos) const\n {\n     // Correction\n-    for(int idx=0; idx<input.size(); ++idx)\n+    for(int idx=0; idx<input.size();)\n     {\n-        switch(input.at(idx).unicode())\n+        bool removeChar = false;\n+        QChar ch = input.at(idx);\n+        switch(ch.unicode())\n         {\n-        case 'l':\n-        case 'I':\n-            input[idx] = QChar('1');\n-            break;\n-        case '0':\n-        case 'O':\n-            input[idx] = QChar('o');\n+        // Qt categorizes these as \"Other_Format\" not \"Separator_Space\"\n+        case 0x200B: // ZERO WIDTH SPACE\n+        case 0xFEFF: // ZERO WIDTH NO-BREAK SPACE\n+            removeChar = true;\n             break;\n         default:\n             break;\n         }\n+        // Remove whitespace\n+        if(ch.isSpace())\n+            removeChar = true;\n+        // To next character",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r847483",
      "id" : 847483,
      "original_commit_id" : "402aa33f945fe0284cb3348c55fb7aa924c10c79",
      "original_position" : 30,
      "path" : "src/qt/bitcoinaddressvalidator.cpp",
      "position" : 33,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329",
      "updated_at" : "2012-05-21T16:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847483",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Maybe it should pop up an error message explaining that it's ignoring it?",
      "created_at" : "2012-05-18T19:37:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5793860",
      "id" : 5793860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-18T19:37:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5793860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r847679"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847679"
         }
      },
      "body" : "1) QString::size() returns an int, not an unsigned int: http://qt-project.org/doc/qt-4.8/qstring.html#size\n2) IMO it is more readable this way. I don't like complex expressions in the third clause of a for",
      "commit_id" : "ce7896070cc0adbf973e1714fba6a729c1df1411",
      "created_at" : "2012-05-18T20:05:55Z",
      "diff_hunk" : "@@ -21,21 +21,28 @@\n QValidator::State BitcoinAddressValidator::validate(QString &input, int &pos) const\n {\n     // Correction\n-    for(int idx=0; idx<input.size(); ++idx)\n+    for(int idx=0; idx<input.size();)\n     {\n-        switch(input.at(idx).unicode())\n+        bool removeChar = false;\n+        QChar ch = input.at(idx);\n+        switch(ch.unicode())\n         {\n-        case 'l':\n-        case 'I':\n-            input[idx] = QChar('1');\n-            break;\n-        case '0':\n-        case 'O':\n-            input[idx] = QChar('o');\n+        // Qt categorizes these as \"Other_Format\" not \"Separator_Space\"\n+        case 0x200B: // ZERO WIDTH SPACE\n+        case 0xFEFF: // ZERO WIDTH NO-BREAK SPACE\n+            removeChar = true;\n             break;\n         default:\n             break;\n         }\n+        // Remove whitespace\n+        if(ch.isSpace())\n+            removeChar = true;\n+        // To next character",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r847679",
      "id" : 847679,
      "original_commit_id" : "402aa33f945fe0284cb3348c55fb7aa924c10c79",
      "original_position" : 30,
      "path" : "src/qt/bitcoinaddressvalidator.cpp",
      "position" : 33,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329",
      "updated_at" : "2012-05-21T16:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847679",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Maybe. It'd be nice in general to be more verbose with validation, and give useful hints. But that's not the goal for this pull. \n\nIn the case of zero-width spaces, the users don't even know the characters are in there, so there is no reason to tell them about it either. It should just work.\n",
      "created_at" : "2012-05-18T20:08:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5794448",
      "id" : 5794448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-18T20:08:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5794448",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r849948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849948"
         }
      },
      "body" : "A comment here expressing the security concerns would be nice; maybe:\n\n// Corrections made are very conservative on purpose, to avoid\n// opening up the possibility for attackers to replace valid addresses\n// with look-alike addresses.",
      "commit_id" : "ce7896070cc0adbf973e1714fba6a729c1df1411",
      "created_at" : "2012-05-19T23:28:08Z",
      "diff_hunk" : "@@ -21,21 +21,28 @@\n QValidator::State BitcoinAddressValidator::validate(QString &input, int &pos) const\n {\n     // Correction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r849948",
      "id" : 849948,
      "original_commit_id" : "402aa33f945fe0284cb3348c55fb7aa924c10c79",
      "original_position" : 3,
      "path" : "src/qt/bitcoinaddressvalidator.cpp",
      "position" : 3,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329",
      "updated_at" : "2012-05-21T16:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r850100"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850100"
         }
      },
      "body" : "I'll add a comment. But the reason is not that it allows attackers anything. The corrections were already very conservative and limited to what base58 considers equivalent, so there was already no risk of look-alike addresses.\n\nMore like:\n\n  // Corrections made are very conservative on purpose, to avoid\n  // users unexpectedly getting away with typos that would normally\n  // be detected, and thus sending to the wrong address.\n",
      "commit_id" : "ce7896070cc0adbf973e1714fba6a729c1df1411",
      "created_at" : "2012-05-20T07:34:12Z",
      "diff_hunk" : "@@ -21,21 +21,28 @@\n QValidator::State BitcoinAddressValidator::validate(QString &input, int &pos) const\n {\n     // Correction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#discussion_r850100",
      "id" : 850100,
      "original_commit_id" : "402aa33f945fe0284cb3348c55fb7aa924c10c79",
      "original_position" : 3,
      "path" : "src/qt/bitcoinaddressvalidator.cpp",
      "position" : 3,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1329",
      "updated_at" : "2012-05-21T16:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Added comment to validator function",
      "created_at" : "2012-05-21T16:53:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1329#issuecomment-5827646",
      "id" : 5827646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1329",
      "updated_at" : "2012-05-21T16:53:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5827646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
