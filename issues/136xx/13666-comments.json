[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202531735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202531735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are these tests changing?",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-07-15T05:26:53Z",
      "diff_hunk" : "@@ -1404,14 +1404,14 @@\n     \"P2PK with too much S padding\"\n ],\n [\n-    \"0x47 0x30440220d7a0417c3f6d1a15094d1cf2a3378ca0503eb8a57630953a9e2987e21ddd0a6502207a6266d686c99090920249991d3d42065b6d43eb70187b219c0db82e4f94d1a201\",\n+    \"0x47 0x3044022093c20fae34ef6ba13038515d18ece7374141b3f051e2cb93a78e4fd7f4e63f34022075037b8f491c746f92318816314c9269679d8702161b9c541f95bd9f029b3ac401\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202531735",
      "id" : 202531735,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMjUzMTczNQ==",
      "original_commit_id" : "d7be065a0b5007d9eb09f70436f13b8ba2fcc1f5",
      "original_position" : 5,
      "path" : "src/test/data/script_tests.json",
      "position" : null,
      "pull_request_review_id" : 137255111,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202531735",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202532071"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202532071"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I assume that they are changing because they are signatures produced with an extra entropy value of 0 (provided by the test case, not the signing method). However in the signing method, an entropy value of 0 has the same meaning as no extra entropy provided which means that the signature will be ground for low R. So in order to get high R, the extra entropy value will need to increment so that a high R signature can be found which is going to result in a different signature.",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-07-15T05:50:17Z",
      "diff_hunk" : "@@ -1404,14 +1404,14 @@\n     \"P2PK with too much S padding\"\n ],\n [\n-    \"0x47 0x30440220d7a0417c3f6d1a15094d1cf2a3378ca0503eb8a57630953a9e2987e21ddd0a6502207a6266d686c99090920249991d3d42065b6d43eb70187b219c0db82e4f94d1a201\",\n+    \"0x47 0x3044022093c20fae34ef6ba13038515d18ece7374141b3f051e2cb93a78e4fd7f4e63f34022075037b8f491c746f92318816314c9269679d8702161b9c541f95bd9f029b3ac401\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202532071",
      "id" : 202532071,
      "in_reply_to_id" : 202531735,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMjUzMjA3MQ==",
      "original_commit_id" : "d7be065a0b5007d9eb09f70436f13b8ba2fcc1f5",
      "original_position" : 5,
      "path" : "src/test/data/script_tests.json",
      "position" : null,
      "pull_request_review_id" : 137255445,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202532071",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202532185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202532185"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps you should split up the signing method into a grinding and a manual one, so the tests can keep creating the old method with provided entropy rather than grindjng?",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-07-15T05:57:50Z",
      "diff_hunk" : "@@ -1404,14 +1404,14 @@\n     \"P2PK with too much S padding\"\n ],\n [\n-    \"0x47 0x30440220d7a0417c3f6d1a15094d1cf2a3378ca0503eb8a57630953a9e2987e21ddd0a6502207a6266d686c99090920249991d3d42065b6d43eb70187b219c0db82e4f94d1a201\",\n+    \"0x47 0x3044022093c20fae34ef6ba13038515d18ece7374141b3f051e2cb93a78e4fd7f4e63f34022075037b8f491c746f92318816314c9269679d8702161b9c541f95bd9f029b3ac401\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202532185",
      "id" : 202532185,
      "in_reply_to_id" : 202531735,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMjUzMjE4NQ==",
      "original_commit_id" : "d7be065a0b5007d9eb09f70436f13b8ba2fcc1f5",
      "original_position" : 5,
      "path" : "src/test/data/script_tests.json",
      "position" : null,
      "pull_request_review_id" : 137255549,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202532185",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does this reduce the entropy of the nonce? To what degree?",
      "created_at" : "2018-07-15T06:02:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405069592",
      "id" : 405069592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTA2OTU5Mg==",
      "updated_at" : "2018-07-15T06:02:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405069592",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr By around 1.0226 bits.",
      "created_at" : "2018-07-15T06:04:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405069682",
      "id" : 405069682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTA2OTY4Mg==",
      "updated_at" : "2018-07-15T06:25:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405069682",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202533893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202533893"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I changed it to have a grind boolean to indicate whether grinding should be used. This results in those tests not changing now.",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-07-15T07:30:37Z",
      "diff_hunk" : "@@ -1404,14 +1404,14 @@\n     \"P2PK with too much S padding\"\n ],\n [\n-    \"0x47 0x30440220d7a0417c3f6d1a15094d1cf2a3378ca0503eb8a57630953a9e2987e21ddd0a6502207a6266d686c99090920249991d3d42065b6d43eb70187b219c0db82e4f94d1a201\",\n+    \"0x47 0x3044022093c20fae34ef6ba13038515d18ece7374141b3f051e2cb93a78e4fd7f4e63f34022075037b8f491c746f92318816314c9269679d8702161b9c541f95bd9f029b3ac401\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r202533893",
      "id" : 202533893,
      "in_reply_to_id" : 202531735,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMjUzMzg5Mw==",
      "original_commit_id" : "d7be065a0b5007d9eb09f70436f13b8ba2fcc1f5",
      "original_position" : 5,
      "path" : "src/test/data/script_tests.json",
      "position" : null,
      "pull_request_review_id" : 137257248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202533893",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK af049b2b52a93dcd05a78c381510534b0c52b4de\r\n\r\nI believe there are no downsides to this, except for making the signing time double on average. It reduces the entropy in the nonce slightly, but not in a way that is usable to an attacker as far as I can tell.\r\n\r\nComments, @gmaxwell, @apoelstra ?",
      "created_at" : "2018-07-15T18:23:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405108732",
      "id" : 405108732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTEwODczMg==",
      "updated_at" : "2018-07-15T18:23:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405108732",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It seems weird-- wasteful and needlessly more identifiable-- to not emit a smaller signature when one shows up. That seems like a bad idea to me. Why not just check that the R size is <=32 bytes? Sometimes you'll be smaller and 'overpay' fee-- yes, but you'll at least get extra priority for your cost. If you instead throw out that candidate signature, you'll still pay the same, but not get the improved priority.  With that changed (or convincing me that I'm wrong), this would get a concept ACK from me. \r\n\r\nI see no security problem from doing this, though the grinding could made ~3x faster by using the endomorphism. \r\n\r\nI was going to argue that it should shave another byte off, but sipa pointed out to me that it would be plenty fast for us (esp with optimized code), it's a lot less likely that anyone else would implement that kind of signing. I think that a great point, and implementing 'lowR' certainly gets the most bang for the computational buck.  It might make sense to deploy at the same time as some other change that makes our transactions more identifiable (perhaps the recent coinselection changes count). ",
      "created_at" : "2018-07-15T20:38:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405116700",
      "id" : 405116700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTExNjcwMA==",
      "updated_at" : "2018-07-15T20:38:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405116700",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I see no security problem from doing this, though the grinding could made ~3x faster by using the endomorphism.\r\n\r\nI believe that doing so would introduce an (additional) bias in the resulting nonce. For example, in groups of 3 points related by multiplication by beta, if only two are low-R, one will be chosen 2/3rd of the time, and the other will be chosen 1/3rd of the time. I don't see a way to exploit that, but it feels scary.\r\n\r\nOut of every 24 points, instead of having 12 with probability 1/12, there will be 3 with probability 1/7, 3 with probability 2/21, and 6 with probability 1/21; overall 0.1576 bits entropy less.",
      "created_at" : "2018-07-15T20:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405117023",
      "id" : 405117023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTExNzAyMw==",
      "updated_at" : "2018-07-15T21:21:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405117023",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I have changed this to allow signatures less than 71 bytes and fixed/added tests for this.",
      "created_at" : "2018-07-16T18:46:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405342204",
      "id" : 405342204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTM0MjIwNA==",
      "updated_at" : "2018-07-16T18:46:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405342204",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 9b7e6e9f0efc74d4f1576802494b5b7966699949",
      "created_at" : "2018-07-16T23:03:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405407454",
      "id" : 405407454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTQwNzQ1NA==",
      "updated_at" : "2018-07-16T23:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405407454",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "You should also change DummySignatureCreator() and all the comments in wallet.cpp talking about the dummy signatures being 72 bytes,  no?",
      "created_at" : "2018-07-17T16:36:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405646885",
      "id" : 405646885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTY0Njg4NQ==",
      "updated_at" : "2018-07-17T16:36:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405646885",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gmaxwell The change to DummySignatureCreator is already included here.",
      "created_at" : "2018-07-17T21:46:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405738848",
      "id" : 405738848,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTczODg0OA==",
      "updated_at" : "2018-07-17T21:46:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405738848",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm. Weird, I see it now, dunno why I missed it before.",
      "created_at" : "2018-07-18T00:36:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-405771690",
      "id" : 405771690,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTc3MTY5MA==",
      "updated_at" : "2018-07-18T00:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405771690",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK",
      "created_at" : "2018-07-18T19:06:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406040985",
      "id" : 406040985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjA0MDk4NQ==",
      "updated_at" : "2018-07-18T19:06:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406040985",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased onto master and removed a psbt signing test that has a high R value (signing is still tested with the other test vector that has low R). Also updated comments in wallet.",
      "created_at" : "2018-07-18T19:27:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406046643",
      "id" : 406046643,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjA0NjY0Mw==",
      "updated_at" : "2018-07-18T19:27:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406046643",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Noting that the search is easily parallelizable without loss of determinism. With this, we can pretty comfortably ignore the overhead for most users.\r\n\r\nA separate concern is this makes hardware wallets more identifiable if this is difficult for them to implement.",
      "created_at" : "2018-07-18T19:52:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406053492",
      "id" : 406053492,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjA1MzQ5Mg==",
      "updated_at" : "2018-07-18T19:52:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406053492",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRubin  each trial has a 50% probability of success the search tries 2 values on average, it wouldn't make sense to parallelize. :) and _should_ be okay for any hardware wallet.",
      "created_at" : "2018-07-19T00:56:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406119814",
      "id" : 406119814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjExOTgxNA==",
      "updated_at" : "2018-07-19T00:56:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406119814",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If I'm not mistaken (my EC math knowledge isn't amazing), could you re-use (k X G) and k^-1 by doing the search via doubling rather than increment.\r\n\r\nSuppose\r\n\r\nk' = 2k, then k' x G = 2k x G = k x G + k x G\r\n\r\nnow k'^-1 = 2^-1 k^-1\r\n\r\n\r\nNot sure if this further reduces the entropy of the nonce too much, but the same optimization also eliminates an ec mul for k' = k+1.",
      "created_at" : "2018-07-19T22:21:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406432246",
      "id" : 406432246,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQzMjI0Ng==",
      "updated_at" : "2018-07-19T22:21:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406432246",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRubin That loses another 0.2885 bits of entropy (1 in 2^N nonces will have N times higher probability). Though in general, I'm really uncomfortable with anything but a uniform distribution (over a sufficiently large subset of acceptable values). See https://www.wolframalpha.com/input/?i=255+-+sum(i%2F2%5E256*log(i%2F2%5E256)*2%5E(255-i),i%3D1...infinity)%2Flog(1%2F2)",
      "created_at" : "2018-07-19T22:42:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406436369",
      "id" : 406436369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQzNjM2OQ==",
      "updated_at" : "2018-07-19T22:47:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406436369",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa just k'=k+1 and eliminating an ec mul shouldn't lose any additional entropy, though not sure what percent of the compute time k'G is.\r\n\r\nIn general, I'm not sure it is worth it to lose any entropy for signature time, but .2885 isn't much (nor is the endomorphism thing @gmaxwell mentioned).\r\n\r\nI think it would be good to provide a strong rationale in this PR on exactly how much entropy is tolerable to drop (e.g. why 1.0226 bits is OK and not 1.3111 bits). Dropping any entropy seems like a non-starter to me.\r\n\r\nI'm also curious if there's an opportunity to leak entropy out of this as a timing attack. If the attacker can make unlimited requests, they can clearly figure out the difference between a msg that (deterministically) takes one signing time and two signing times (or more) by making a historgram of the signing times. From there, they can figure out whether the first or not-first R value was small. This should reduce the space by at least a bit, if not more -- for instance if we infer that it took 10 signature attempts (which should happen once in 1024 attempts), we reduce the nonce space for that message by 1/1024.",
      "created_at" : "2018-07-20T01:42:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406463780",
      "id" : 406463780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ2Mzc4MA==",
      "updated_at" : "2018-07-20T01:42:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406463780",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRubin Using `k' = k + 1` has the same loss of entropy. For example if a particular nonce k has a corresponding low-R, and the 6 nonces before it (k-6...k-1) all have high-R, then that nonce has 7 times more chances to be chosen than one where k-1 is also low-R.\r\n",
      "created_at" : "2018-07-20T01:54:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406465410",
      "id" : 406465410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ2NTQxMA==",
      "updated_at" : "2018-07-20T01:54:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406465410",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> for instance if we infer that it took 10 signature attempts (which should happen once in 1024 attempts), we reduce the nonce space for that message by 1/1024.\r\n\r\nYes, indeed. Information theoretically this is a leak. But the only way an attacker can find out whether a particular nonce is in that subset of 1/1024 is by doing 10 EC multiplications on the preceeding nonces... the exact operation we're trying to make expensive.",
      "created_at" : "2018-07-20T01:57:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406465786",
      "id" : 406465786,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ2NTc4Ng==",
      "updated_at" : "2018-07-20T01:57:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406465786",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think it would be good to provide a strong rationale in this PR on exactly how much entropy is tolerable to drop (e.g. why 1.0226 bits is OK and not 1.3111 bits). Dropping any entropy seems like a non-starter to me.\r\n\r\nThe actual entropy loss is 1 bit exactly. The 0.0226 comes from a previous version of this PR where all signatures had to be 71 bytes. With that now removed, only 1 bit of entropy is lost.",
      "created_at" : "2018-07-20T02:03:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406466702",
      "id" : 406466702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ2NjcwMg==",
      "updated_at" : "2018-07-20T02:03:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406466702",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa ah thanks, they key information I was missing was that the counter goes through a hash (it's not just directly put on the curve).",
      "created_at" : "2018-07-20T03:48:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406481150",
      "id" : 406481150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ4MTE1MA==",
      "updated_at" : "2018-07-20T03:48:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406481150",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Should there be an informational BIP for this to make it more likely other wallets do the same? Any feedback on that BIP might have to wait for the next release to be implemented, but perhaps some obvious problem is found in time.\r\n\r\nAt the same time, it might be useful to propose replacement test vectors for BIP-174, rather than deleting them. I'm sure you and the author get along well :-P\r\n\r\nGrinding seems to ~ double the amount of data about the private key the wallet gives to a side-channel attacker. Is that an issue, or do all conceivable side-channel attacks require many orders of magnitude more signing operations so that doubling has insignificant impact? And does that apply to less rigorous alternative implementations?",
      "created_at" : "2018-07-20T11:49:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406577525",
      "id" : 406577525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjU3NzUyNQ==",
      "updated_at" : "2018-07-20T12:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406577525",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors I think that's a good idea, actually. There are clearly several questions in this thread about which specific variant to use, and the trade-offs, so I think it would be good to have it written up somewhere. That would also make it easy to point to, or to have a write-up we can ask expert advice about.\r\n\r\nDoing so also gives us the opportunity to drop RFC6979 and favor of a faster construction (RFC6979 is very much overkill).\r\n\r\nThe question is whether that should stand in the way of implementing this PR (which wouldn't be following such a spec, it's too ad hoc I think).",
      "created_at" : "2018-07-20T19:13:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406700712",
      "id" : 406700712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjcwMDcxMg==",
      "updated_at" : "2018-07-20T19:13:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406700712",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'd say there's two separate goals:\r\n\r\n1. Get more eyes on this specific change before it's irreversible (e.g. it could be merged, but removed from a 0.17rc)\r\n2. Come up with an even better approach for a future next release (can blend in with whatever coin selection changes are ready then)\r\n\r\nSo maybe hold off on the BIP and just drop a summary of this thread on the bitcoin-dev list?",
      "created_at" : "2018-07-21T07:50:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406778593",
      "id" : 406778593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjc3ODU5Mw==",
      "updated_at" : "2018-07-21T07:50:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406778593",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This isn't really very important one way or another,  but I think it's not good for the project that every single little thing takes forever for no obvious reason.   There isn't anything meaningful that would change about this-- sure, someone might optimize it further by not using 6979 or whatnot, but at the end of the day instead of flipping a coin once, it flips it until it comes up tails. And anything similar is going to do the same.\r\n\r\nI think our time would be better spent working on other improvements than debating and documenting this one forever.",
      "created_at" : "2018-07-21T17:39:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406812027",
      "id" : 406812027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjgxMjAyNw==",
      "updated_at" : "2018-07-21T17:39:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406812027",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gmaxwell That's fair; there is no observable difference between generating nonces one way or another as long as the success condition is the same (low R). I'm mostly wondering if people are ok with changing signatures once and then changing them again if/when there would be a more widely adopted standard.",
      "created_at" : "2018-07-21T21:13:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-406823907",
      "id" : 406823907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjgyMzkwNw==",
      "updated_at" : "2018-07-21T21:13:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406823907",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I am not in favor of this change. It would add a way of (statistically) differentiating Bitcoins wallet from other signers  and it is unlikely that all implementations will switch to this scheme. In particular there are potential improvements that could be made to hardware wallets to export a bulletproof that the nonce was selected according to a specified deterministic algorithm. Adding additional constraints like this blow up proof generation time and size by a significant factor for a low power signing devices. And if forced with a choice, I'd much rather have the ability to verify my hardware wallet is not leaking bits of key material than save one measly byte of witness data, on average.",
      "created_at" : "2018-07-23T19:08:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-407167926",
      "id" : 407167926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNzE2NzkyNg==",
      "updated_at" : "2018-07-26T19:16:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/407167926",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/69154?v=4",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "node_id" : "MDQ6VXNlcjY5MTU0",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I am not in favor of this change. It would add a way of (statistically) differentiating Bitcoins wallet from other signers\r\n\r\nOther changes in the current version make its transactions identifyable, so for the moment I think that concern is mostly moot. The expectation here is that other wallets would also adopt this change over time. This is the reason that it doesn't shave an additional byte off too: it's less realistic to expect others to imitate that functionality.\r\n\r\n> In particular there are potential improvements that could be made to hardware wallets to export a bulletproof that the nonce was selected according to a specified deterministic algorithm\r\n\r\nRerunning RFC6979 every time is a lot slower, but a BP that the nonce is H(x||m) + [0..256] would be hardly any more expensive that the nonce is H(x||m). And unfortunately, I've yet to see any hardware wallet with resources within two orders of magnitude needed for this.\r\n\r\nUnrelated, I'm not aware of any reason that the sign-2-contract fix for nonce sidechannels isn't just as effective as a BP... and it's actually computationally reasonable on existing hardware... and would still work with this approach.",
      "created_at" : "2018-07-26T19:24:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-408207897",
      "id" : 408207897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwODIwNzg5Nw==",
      "updated_at" : "2018-07-26T19:28:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408207897",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I wrote:\r\n> Grinding seems to ~ double the amount of data about the private key the wallet gives to a side-channel attacker.\r\n\r\nBut that's not true. Unlike when deriving a public key `Q = d  G`, where you could determine `d` by monitoring a device that performs this elliptic curve multiplication multiple times (with a not perfectly time-constant implementation ), for signatures the private key isn't used in such multiplication. Only a random nonce `k` is, which is completely different on each attempt.\r\n\r\n@gmaxwell wrote:\r\n>  I think it's not good for the project that every single little thing takes forever for no obvious reason. There isn't anything meaningful that would change about this\r\n\r\nThat's not the primary reason I'm in favor of posting this on a mailinglist, although I do think it's useful to give other wallet developers guidance on this topic in the form of a BIP. My bigger concern is that in cryptography it's easy to make a mistake if you don't know what you're doing. Obviously @achow101  knows what he's doing and you and @sipa are able to tell that this particular change is safe. But it's hard for me to verify what makes a simple change safe and what doesn't.",
      "created_at" : "2018-07-27T09:06:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-408359557",
      "id" : 408359557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwODM1OTU1Nw==",
      "updated_at" : "2018-07-27T09:06:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408359557",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@gmaxwell wrote:\r\n\r\n> Unrelated, I'm not aware of any reason that the sign-2-contract fix for nonce sidechannels isn't just as effective as a BP... and it's actually computationally reasonable on existing hardware... and would still work with this approach.\r\n\r\nCan you expand on this? What \"sign-2-contract fix for nonce side channels\"? It might be the case this is something you've explained to me before, but it's not coming to mind.",
      "created_at" : "2018-08-02T23:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-410096633",
      "id" : 410096633,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMDA5NjYzMw==",
      "updated_at" : "2018-08-02T23:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/410096633",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/69154?v=4",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "node_id" : "MDQ6VXNlcjY5MTU0",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maaku \r\n\r\n* HW device generates a nonce `k` (deterministically from msg/privkey, or with real RNG).\r\n* HW device computes `R = kG` and sends it to host device.\r\n* Host device generates randomness `c` (possibly based on `R`), and sends it in plain text to HW device.\r\n* HW device computes `k' = H(R, c) + k` and `R' = H(R, c)G + R`, and uses those in the signature it produces.\r\n* HW device sends the signature and `R` to the host device.\r\n* The host device recomputes `R' = H(R, c)G + R` (taking `R'` from the signature itself) which guarantees that its randomness `c` was included in the signature.\r\n\r\nAn attacker needs to control both devices in order to leak information through the nonce now. The HW device can't even grind without the host machine knowing.",
      "created_at" : "2018-08-02T23:41:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-410100771",
      "id" : 410100771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMDEwMDc3MQ==",
      "updated_at" : "2018-08-02T23:52:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/410100771",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "One question I have here: With the PSBT work, would this affect potential usage of bitcoin core with hardware wallets that do not implement this specific trick and might still generate 72-byte signatures?",
      "created_at" : "2018-08-07T11:23:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411023542",
      "id" : 411023542,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTAyMzU0Mg==",
      "updated_at" : "2018-08-07T11:23:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411023542",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj That's a good point. Perhaps we should still count the size of unknown signatures in DummySignatureCreator as 72 rather than 71, to account for the possibility that external signers produce 72 bytes?",
      "created_at" : "2018-08-07T16:23:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411117029",
      "id" : 411117029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTExNzAyOQ==",
      "updated_at" : "2018-08-07T16:23:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411117029",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Perhaps we should still count the size of unknown signatures in DummySignatureCreator as 72 rather than 71, to account for the possibility that external signers produce 72 bytes?\r\n\r\nI think that kind of defeats the purpose of this change. Since the DummySignatureCreator is only used for fee estimation of unsigned transactions, perhaps we could make it work so that it uses 72 bytes for inputs that we cannot sign for, and 71 bytes for inputs that we can sign for?",
      "created_at" : "2018-08-07T16:47:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411124692",
      "id" : 411124692,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTEyNDY5Mg==",
      "updated_at" : "2018-08-07T16:47:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411124692",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208421727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208421727"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can write this much more compactly using a conditional\r\n```\r\nIf (ProduceSignature(*this, use_max_sig ? DUMMY_MAXIMUM_SIGNATURE_CREATOR : DUMMY_SIGNATURE_CREATOR, scriptPubKey, sigdata)) {\r\n```",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:05:13Z",
      "diff_hunk" : "@@ -1512,29 +1512,35 @@ int64_t CWalletTx::GetTxTime() const\n }\n \n // Helper for producing a max-sized low-S low-R signature (eg 71 bytes)\n-bool CWallet::DummySignInput(CTxIn &tx_in, const CTxOut &txout) const\n+// or a max-sized low-S signature (e.g. 72 bytes) if use_max_sig is true\n+bool CWallet::DummySignInput(CTxIn &tx_in, const CTxOut &txout, bool use_max_sig) const\n {\n     // Fill in dummy signatures for fee calculation.\n     const CScript& scriptPubKey = txout.scriptPubKey;\n     SignatureData sigdata;\n \n-    if (!ProduceSignature(*this, DUMMY_SIGNATURE_CREATOR, scriptPubKey, sigdata))\n-    {\n-        return false;\n+    if (use_max_sig) {\n+        if (ProduceSignature(*this, DUMMY_MAXIMUM_SIGNATURE_CREATOR, scriptPubKey, sigdata)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208421727",
      "id" : 208421727,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyMTcyNw==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 16,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 144227762,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208421727",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423719"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why?",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:19:45Z",
      "diff_hunk" : "@@ -1557,26 +1563,26 @@ int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wall\n         assert(input.prevout.n < mi->second.tx->vout.size());\n         txouts.emplace_back(mi->second.tx->vout[input.prevout.n]);\n     }\n-    return CalculateMaximumSignedTxSize(tx, wallet, txouts);\n+    return CalculateMaximumSignedTxSize(tx, wallet, txouts, use_max_sig);\n }\n \n // txouts needs to be in the order of tx.vin\n-int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wallet, const std::vector<CTxOut>& txouts)\n+int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wallet, const std::vector<CTxOut>& txouts, bool use_max_sig)\n {\n     CMutableTransaction txNew(tx);\n-    if (!wallet->DummySignTx(txNew, txouts)) {\n+    if (!wallet->DummySignTx(txNew, txouts, use_max_sig)) {\n         // This should never happen, because IsAllFromMe(ISMINE_SPENDABLE)\n         // implies that we can sign for every input.\n-        return -1;\n+        return -2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423719",
      "id" : 208423719,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyMzcxOQ==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 71,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 144230101,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423719",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423783"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Variable naming style nit: `m_r_len`.",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:20:08Z",
      "diff_hunk" : "@@ -425,28 +425,33 @@ class DummySignatureChecker final : public BaseSignatureChecker\n const DummySignatureChecker DUMMY_CHECKER;\n \n class DummySignatureCreator final : public BaseSignatureCreator {\n+private:\n+    char r_len = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423783",
      "id" : 208423783,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyMzc4Mw==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 5,
      "path" : "src/script/sign.cpp",
      "position" : null,
      "pull_request_review_id" : 144230101,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423783",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:21:13Z",
      "diff_hunk" : "@@ -1512,29 +1512,35 @@ int64_t CWalletTx::GetTxTime() const\n }\n \n // Helper for producing a max-sized low-S low-R signature (eg 71 bytes)\n-bool CWallet::DummySignInput(CTxIn &tx_in, const CTxOut &txout) const\n+// or a max-sized low-S signature (e.g. 72 bytes) if use_max_sig is true\n+bool CWallet::DummySignInput(CTxIn &tx_in, const CTxOut &txout, bool use_max_sig) const\n {\n     // Fill in dummy signatures for fee calculation.\n     const CScript& scriptPubKey = txout.scriptPubKey;\n     SignatureData sigdata;\n \n-    if (!ProduceSignature(*this, DUMMY_SIGNATURE_CREATOR, scriptPubKey, sigdata))\n-    {\n-        return false;\n+    if (use_max_sig) {\n+        if (ProduceSignature(*this, DUMMY_MAXIMUM_SIGNATURE_CREATOR, scriptPubKey, sigdata)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208423917",
      "id" : 208423917,
      "in_reply_to_id" : 208421727,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyMzkxNw==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 16,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 144230332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208423917",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I pushed a commit that switches between 71 and 72 byte signatures depending on whether watching only inputs can be selected.",
      "created_at" : "2018-08-08T00:22:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411243868",
      "id" : 411243868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTI0Mzg2OA==",
      "updated_at" : "2018-08-08T00:22:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411243868",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424140"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe you can drop the default constructor, and just specify the actual sizes in for both instances?",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:22:58Z",
      "diff_hunk" : "@@ -425,28 +425,33 @@ class DummySignatureChecker final : public BaseSignatureChecker\n const DummySignatureChecker DUMMY_CHECKER;\n \n class DummySignatureCreator final : public BaseSignatureCreator {\n+private:\n+    char r_len = 32;\n+    char s_len = 32;\n public:\n     DummySignatureCreator() {}\n+    DummySignatureCreator(char r_len, char s_len) : r_len(r_len), s_len(s_len) {}\n     const BaseSignatureChecker& Checker() const override { return DUMMY_CHECKER; }\n     bool CreateSig(const SigningProvider& provider, std::vector<unsigned char>& vchSig, const CKeyID& keyid, const CScript& scriptCode, SigVersion sigversion) const override\n     {\n         // Create a dummy signature that is a valid DER-encoding\n-        vchSig.assign(71, '\\000');\n+        vchSig.assign(r_len + s_len + 7, '\\000');\n         vchSig[0] = 0x30;\n-        vchSig[1] = 68;\n+        vchSig[1] = r_len + s_len + 4;\n         vchSig[2] = 0x02;\n-        vchSig[3] = 32;\n+        vchSig[3] = r_len;\n         vchSig[4] = 0x01;\n-        vchSig[4 + 32] = 0x02;\n-        vchSig[5 + 32] = 32;\n-        vchSig[6 + 32] = 0x01;\n-        vchSig[6 + 32 + 32] = SIGHASH_ALL;\n+        vchSig[4 + r_len] = 0x02;\n+        vchSig[5 + r_len] = s_len;\n+        vchSig[6 + r_len] = 0x01;\n+        vchSig[6 + r_len + s_len] = SIGHASH_ALL;\n         return true;\n     }\n };\n }\n \n const BaseSignatureCreator& DUMMY_SIGNATURE_CREATOR = DummySignatureCreator();\n+const BaseSignatureCreator& DUMMY_MAXIMUM_SIGNATURE_CREATOR = DummySignatureCreator(33, 32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424140",
      "id" : 208424140,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyNDE0MA==",
      "original_commit_id" : "598e7965957a1b7609f205a9081b23cb716a2140",
      "original_position" : 37,
      "path" : "src/script/sign.cpp",
      "position" : null,
      "pull_request_review_id" : 144230101,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424140",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424547"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops, forgot to remove some of my debugging stuff. Fixed",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:25:57Z",
      "diff_hunk" : "@@ -1557,26 +1563,26 @@ int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wall\n         assert(input.prevout.n < mi->second.tx->vout.size());\n         txouts.emplace_back(mi->second.tx->vout[input.prevout.n]);\n     }\n-    return CalculateMaximumSignedTxSize(tx, wallet, txouts);\n+    return CalculateMaximumSignedTxSize(tx, wallet, txouts, use_max_sig);\n }\n \n // txouts needs to be in the order of tx.vin\n-int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wallet, const std::vector<CTxOut>& txouts)\n+int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wallet, const std::vector<CTxOut>& txouts, bool use_max_sig)\n {\n     CMutableTransaction txNew(tx);\n-    if (!wallet->DummySignTx(txNew, txouts)) {\n+    if (!wallet->DummySignTx(txNew, txouts, use_max_sig)) {\n         // This should never happen, because IsAllFromMe(ISMINE_SPENDABLE)\n         // implies that we can sign for every input.\n-        return -1;\n+        return -2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424547",
      "id" : 208424547,
      "in_reply_to_id" : 208423719,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyNDU0Nw==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 71,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 144231111,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424547",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424765"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424765"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:27:33Z",
      "diff_hunk" : "@@ -425,28 +425,33 @@ class DummySignatureChecker final : public BaseSignatureChecker\n const DummySignatureChecker DUMMY_CHECKER;\n \n class DummySignatureCreator final : public BaseSignatureCreator {\n+private:\n+    char r_len = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424765",
      "id" : 208424765,
      "in_reply_to_id" : 208423783,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyNDc2NQ==",
      "original_commit_id" : "d8e6ed1209986ac3cdf50e9828396e19abba42d4",
      "original_position" : 5,
      "path" : "src/script/sign.cpp",
      "position" : null,
      "pull_request_review_id" : 144231387,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424765",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424780"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424780"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-08T00:27:39Z",
      "diff_hunk" : "@@ -425,28 +425,33 @@ class DummySignatureChecker final : public BaseSignatureChecker\n const DummySignatureChecker DUMMY_CHECKER;\n \n class DummySignatureCreator final : public BaseSignatureCreator {\n+private:\n+    char r_len = 32;\n+    char s_len = 32;\n public:\n     DummySignatureCreator() {}\n+    DummySignatureCreator(char r_len, char s_len) : r_len(r_len), s_len(s_len) {}\n     const BaseSignatureChecker& Checker() const override { return DUMMY_CHECKER; }\n     bool CreateSig(const SigningProvider& provider, std::vector<unsigned char>& vchSig, const CKeyID& keyid, const CScript& scriptCode, SigVersion sigversion) const override\n     {\n         // Create a dummy signature that is a valid DER-encoding\n-        vchSig.assign(71, '\\000');\n+        vchSig.assign(r_len + s_len + 7, '\\000');\n         vchSig[0] = 0x30;\n-        vchSig[1] = 68;\n+        vchSig[1] = r_len + s_len + 4;\n         vchSig[2] = 0x02;\n-        vchSig[3] = 32;\n+        vchSig[3] = r_len;\n         vchSig[4] = 0x01;\n-        vchSig[4 + 32] = 0x02;\n-        vchSig[5 + 32] = 32;\n-        vchSig[6 + 32] = 0x01;\n-        vchSig[6 + 32 + 32] = SIGHASH_ALL;\n+        vchSig[4 + r_len] = 0x02;\n+        vchSig[5 + r_len] = s_len;\n+        vchSig[6 + r_len] = 0x01;\n+        vchSig[6 + r_len + s_len] = SIGHASH_ALL;\n         return true;\n     }\n };\n }\n \n const BaseSignatureCreator& DUMMY_SIGNATURE_CREATOR = DummySignatureCreator();\n+const BaseSignatureCreator& DUMMY_MAXIMUM_SIGNATURE_CREATOR = DummySignatureCreator(33, 32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r208424780",
      "id" : 208424780,
      "in_reply_to_id" : 208424140,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwODQyNDc4MA==",
      "original_commit_id" : "598e7965957a1b7609f205a9081b23cb716a2140",
      "original_position" : 37,
      "path" : "src/script/sign.cpp",
      "position" : null,
      "pull_request_review_id" : 144231405,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/208424780",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13917 (Additional safety checks in PSBT signer by sipa)\n* #13723 (PSBT key path cleanups by sipa)\n* #13268 (Consistently bounds-check vin/vout access by Empact)\n* #11634 (wallet: Add missing cs_wallet/cs_KeyStore locks to wallet by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-08T05:07:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411286719",
      "id" : 411286719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTI4NjcxOQ==",
      "updated_at" : "2018-08-10T07:40:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411286719",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209110676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209110676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In \"Always create 70 byte signatures with low R values\":\r\n\r\nA comment explaining why the first byte being ` < 0x80` means the signature has a low R would be useful, unless this is blindingly obvious to everyone else.",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-09T23:41:09Z",
      "diff_hunk" : "@@ -189,15 +189,30 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+    return compact_sig[0] < 0x80;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209110676",
      "id" : 209110676,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTExMDY3Ng==",
      "original_commit_id" : "b43b651e2af49f00a60ab36ede3f1581a83d47d1",
      "original_position" : 10,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145064120,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209110676",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209112084"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209112084"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In \"Always create 70 byte signatures with low R values\":\r\n\r\nNit: `&=` unnecessary, can just use `=`, `ret` is always true (though compilers will most likely figure this out and optimize away).",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-09T23:49:32Z",
      "diff_hunk" : "@@ -189,15 +189,30 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+    return compact_sig[0] < 0x80;\n+}\n+\n+bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, bool grind, uint32_t test_case) const {\n     if (!fValid)\n         return false;\n     vchSig.resize(CPubKey::SIGNATURE_SIZE);\n     size_t nSigLen = CPubKey::SIGNATURE_SIZE;\n     unsigned char extra_entropy[32] = {0};\n     WriteLE32(extra_entropy, test_case);\n     secp256k1_ecdsa_signature sig;\n-    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, test_case ? extra_entropy : nullptr);\n+    uint32_t counter = 0;\n+    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, (!grind && test_case) ? extra_entropy : nullptr);\n+\n+    // Grind for low R\n+    while (ret && !SigHasLowR(&sig) && grind) {\n+        WriteLE32(extra_entropy, ++counter);\n+        ret &= secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, extra_entropy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209112084",
      "id" : 209112084,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTExMjA4NA==",
      "original_commit_id" : "b43b651e2af49f00a60ab36ede3f1581a83d47d1",
      "original_position" : 28,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145064120,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209112084",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209113859"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209113859"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In \"Use 72 byte dummy signatures when watching only inputs may be used \":\r\n\r\nI know this flag is used for watch-only outputs, but that's not what the flag is, it's a flag that uses the 72 byte dummy signature instead of the 71 byte one. Noting that this is enabled when output is watch-only is useful, of course.",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T00:01:15Z",
      "diff_hunk" : "@@ -497,20 +497,23 @@ class COutput\n     /** Whether we know how to spend this output, ignoring the lack of keys */\n     bool fSolvable;\n \n+    /** Whether this output is a watch-only output */\n+    bool use_max_sig;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209113859",
      "id" : 209113859,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTExMzg1OQ==",
      "original_commit_id" : "7e425fa2114674578522291a57fd7eec02f16b28",
      "original_position" : 26,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 145064120,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209113859",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123064"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:22:41Z",
      "diff_hunk" : "@@ -189,15 +189,30 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+    return compact_sig[0] < 0x80;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123064",
      "id" : 209123064,
      "in_reply_to_id" : 209110676,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyMzA2NA==",
      "original_commit_id" : "b43b651e2af49f00a60ab36ede3f1581a83d47d1",
      "original_position" : 10,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145078577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123064",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123079"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:22:48Z",
      "diff_hunk" : "@@ -189,15 +189,30 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+    return compact_sig[0] < 0x80;\n+}\n+\n+bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, bool grind, uint32_t test_case) const {\n     if (!fValid)\n         return false;\n     vchSig.resize(CPubKey::SIGNATURE_SIZE);\n     size_t nSigLen = CPubKey::SIGNATURE_SIZE;\n     unsigned char extra_entropy[32] = {0};\n     WriteLE32(extra_entropy, test_case);\n     secp256k1_ecdsa_signature sig;\n-    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, test_case ? extra_entropy : nullptr);\n+    uint32_t counter = 0;\n+    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, (!grind && test_case) ? extra_entropy : nullptr);\n+\n+    // Grind for low R\n+    while (ret && !SigHasLowR(&sig) && grind) {\n+        WriteLE32(extra_entropy, ++counter);\n+        ret &= secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, extra_entropy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123079",
      "id" : 209123079,
      "in_reply_to_id" : 209112084,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyMzA3OQ==",
      "original_commit_id" : "b43b651e2af49f00a60ab36ede3f1581a83d47d1",
      "original_position" : 28,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145078595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123079",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123091"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123091"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:22:52Z",
      "diff_hunk" : "@@ -497,20 +497,23 @@ class COutput\n     /** Whether we know how to spend this output, ignoring the lack of keys */\n     bool fSolvable;\n \n+    /** Whether this output is a watch-only output */\n+    bool use_max_sig;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123091",
      "id" : 209123091,
      "in_reply_to_id" : 209113859,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyMzA5MQ==",
      "original_commit_id" : "7e425fa2114674578522291a57fd7eec02f16b28",
      "original_position" : 26,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 145078615,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123091",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123389"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: `its signed-ness`",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:25:42Z",
      "diff_hunk" : "@@ -189,15 +189,35 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+\n+    // In DER serialization, all values are interpreted as big-endian, signed integers. The highest bit in the integer indicates\n+    // it's signed-ness; 0 is positive, 1 is negative. When the value is interpreted as a negative integer, it must be converted",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123389",
      "id" : 209123389,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyMzM4OQ==",
      "original_commit_id" : "069c87957660adda97083fb77a48cbbcec253418",
      "original_position" : 12,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145078963,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123389",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123964"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe overkill, but you could in theory do\r\n```C++\r\nwhile (secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, (counter || (!grind && test_case)) ? extra_entropy : nullptr)\r\n    && !SigHasLowR(&sig) && grind) {\r\n    WriteLE32(extra_entropy, ++counter);\r\n}\r\n```\r\nto replace\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/069c87957660adda97083fb77a48cbbcec253418/src/key.cpp#L214-L220",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:30:52Z",
      "diff_hunk" : "@@ -189,15 +189,35 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+\n+    // In DER serialization, all values are interpreted as big-endian, signed integers. The highest bit in the integer indicates\n+    // it's signed-ness; 0 is positive, 1 is negative. When the value is interpreted as a negative integer, it must be converted\n+    // to a positive value by prepending a 0x00 byte so that the highest bit is 0. We can avoid this prepending by ensuring that\n+    // our highest bit is always 0, and thus we must check that the first byte is less than 0x80.\n+    return compact_sig[0] < 0x80;\n+}\n+\n+bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, bool grind, uint32_t test_case) const {\n     if (!fValid)\n         return false;\n     vchSig.resize(CPubKey::SIGNATURE_SIZE);\n     size_t nSigLen = CPubKey::SIGNATURE_SIZE;\n     unsigned char extra_entropy[32] = {0};\n     WriteLE32(extra_entropy, test_case);\n     secp256k1_ecdsa_signature sig;\n-    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, test_case ? extra_entropy : nullptr);\n+    uint32_t counter = 0;\n+    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, (!grind && test_case) ? extra_entropy : nullptr);\n+\n+    // Grind for low R\n+    while (ret && !SigHasLowR(&sig) && grind) {\n+        WriteLE32(extra_entropy, ++counter);\n+        ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, extra_entropy);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209123964",
      "id" : 209123964,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyMzk2NA==",
      "original_commit_id" : "069c87957660adda97083fb77a48cbbcec253418",
      "original_position" : 34,
      "path" : "src/key.cpp",
      "position" : 34,
      "pull_request_review_id" : 145078963,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209123964",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209125046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209125046"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd rather not. It's kind of hard to read (at least to me).",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:39:26Z",
      "diff_hunk" : "@@ -189,15 +189,35 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+\n+    // In DER serialization, all values are interpreted as big-endian, signed integers. The highest bit in the integer indicates\n+    // it's signed-ness; 0 is positive, 1 is negative. When the value is interpreted as a negative integer, it must be converted\n+    // to a positive value by prepending a 0x00 byte so that the highest bit is 0. We can avoid this prepending by ensuring that\n+    // our highest bit is always 0, and thus we must check that the first byte is less than 0x80.\n+    return compact_sig[0] < 0x80;\n+}\n+\n+bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, bool grind, uint32_t test_case) const {\n     if (!fValid)\n         return false;\n     vchSig.resize(CPubKey::SIGNATURE_SIZE);\n     size_t nSigLen = CPubKey::SIGNATURE_SIZE;\n     unsigned char extra_entropy[32] = {0};\n     WriteLE32(extra_entropy, test_case);\n     secp256k1_ecdsa_signature sig;\n-    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, test_case ? extra_entropy : nullptr);\n+    uint32_t counter = 0;\n+    int ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, (!grind && test_case) ? extra_entropy : nullptr);\n+\n+    // Grind for low R\n+    while (ret && !SigHasLowR(&sig) && grind) {\n+        WriteLE32(extra_entropy, ++counter);\n+        ret = secp256k1_ecdsa_sign(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, extra_entropy);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209125046",
      "id" : 209125046,
      "in_reply_to_id" : 209123964,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyNTA0Ng==",
      "original_commit_id" : "069c87957660adda97083fb77a48cbbcec253418",
      "original_position" : 34,
      "path" : "src/key.cpp",
      "position" : 34,
      "pull_request_review_id" : 145080835,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209125046",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209125099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209125099"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T01:40:09Z",
      "diff_hunk" : "@@ -189,15 +189,35 @@ CPubKey CKey::GetPubKey() const {\n     return result;\n }\n \n-bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n+// Check that the sig has a low R value and will be less than 71 bytes\n+bool SigHasLowR(const secp256k1_ecdsa_signature* sig)\n+{\n+    unsigned char compact_sig[64];\n+    secp256k1_ecdsa_signature_serialize_compact(secp256k1_context_sign, compact_sig, sig);\n+\n+    // In DER serialization, all values are interpreted as big-endian, signed integers. The highest bit in the integer indicates\n+    // it's signed-ness; 0 is positive, 1 is negative. When the value is interpreted as a negative integer, it must be converted",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#discussion_r209125099",
      "id" : 209125099,
      "in_reply_to_id" : 209123389,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwOTEyNTA5OQ==",
      "original_commit_id" : "069c87957660adda97083fb77a48cbbcec253418",
      "original_position" : 12,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 145080907,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13666",
      "updated_at" : "2018-08-10T01:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/209125099",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Re-ACK",
      "created_at" : "2018-08-10T05:56:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-411983318",
      "id" : 411983318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTk4MzMxOA==",
      "updated_at" : "2018-08-10T05:56:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/411983318",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK e306be742932d4ea5aca0ea4768e54b2fc3dc6a0",
      "created_at" : "2018-08-10T22:31:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-412223265",
      "id" : 412223265,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjIyMzI2NQ==",
      "updated_at" : "2018-08-10T22:31:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412223265",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRobin commented the following:\r\n\r\n> I'm also curious if there's an opportunity to leak entropy out of this as a timing attack. If the attacker can make unlimited requests, they can clearly figure out the difference between a msg that (deterministically) takes one signing time and two signing times (or more) by making a historgram of the signing times. From there, they can figure out whether the first or not-first R value was small. This should reduce the space by at least a bit, if not more -- for instance if we infer that it took 10 signature attempts (which should happen once in 1024 attempts), we reduce the nonce space for that message by 1/1024.\r\n\r\nI don't think this was addressed, is this a potential issue?",
      "created_at" : "2018-08-14T15:31:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-412913964",
      "id" : 412913964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjkxMzk2NA==",
      "updated_at" : "2018-08-14T15:31:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412913964",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We had a discussion about this on IRC with @gmaxwell and @JeremyRubin. While I think it would be good to document this reasoning, I'll summarize here:\r\n\r\n* RFC6979 itself specifies a very similar form of iteration to produce nonces, to make sure they are in the valid range (between 1 and the group's order). For secp256k1 this is not observable, as the order is so close to a power of 2 (2<sup>256</sup> - 2<sup>32</sup> - 977), but for other curves it is an actually practically observable bias. Clearly the authors of RFC6979 did not consider this to be an issue.\r\n\r\n* The information \"whether or not the first generated nonce was Low-R\" was already available in the old scheme as well, by virtue of revealing the first R value (in cases where the old scheme produces a Low-R, the new scheme will have 1 iteration; in cases where the old scheme produces a High-R, the new scheme will have 2 or more iterations). The only additional information to a timing attacker in the new scheme is how many iterations were needed (if more than 1).\r\n\r\n* In general, to meaningfully reduce the nonce space for an attacker, requires in the order of 2<sup>256</sup> hashing operations. This is far slower than a direct ECDLP attack on the R point or public key itself. As the information does not lead to a more efficient attack, it does not reduce security.\r\n\r\nAnything I'm missing?",
      "created_at" : "2018-08-14T16:03:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-412925155",
      "id" : 412925155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjkyNTE1NQ==",
      "updated_at" : "2018-08-14T16:27:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412925155",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Clarification request:\r\n\r\nRef: https://tools.ietf.org/html/rfc6979#section-3.2\r\n\r\nIn `3.2 d and f`. it states:\r\n\r\n```\r\nd:\r\nK = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1))\r\nf:\r\nK = HMAC_K(V || 0x01 || int2octets(x) || bits2octets(h1))\r\n```\r\n\r\nbut in the case where r is >= 2^255 we must re-try the RFC6979 k generation this time with the extra_entropy set to 1 (since when counter is set to 0, extra_entropy becomes nullptr, and the `WriteLE32(extra_entropy, ++counter)` is using ++ beforehand) and the following is done. shown below:\r\n\r\n```\r\nd:\r\nK = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || int2octets(extra_entropy))\r\nf:\r\nK = HMAC_K(V || 0x01 || int2octets(x) || bits2octets(h1) || int2octets(extra_entropy))\r\n```\r\n\r\n@sipa just checking, but is the appended buffer for extra_entropy big endian?\r\nEdit: nvm `WriteLE32` 32 byte Little Endian... rtfm",
      "created_at" : "2018-08-20T08:44:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13666#issuecomment-414242714",
      "id" : 414242714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13666",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNDI0MjcxNA==",
      "updated_at" : "2018-08-20T08:58:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/414242714",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/11246316?v=4",
         "events_url" : "https://api.github.com/users/junderw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/junderw/followers",
         "following_url" : "https://api.github.com/users/junderw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/junderw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/junderw",
         "id" : 11246316,
         "login" : "junderw",
         "node_id" : "MDQ6VXNlcjExMjQ2MzE2",
         "organizations_url" : "https://api.github.com/users/junderw/orgs",
         "received_events_url" : "https://api.github.com/users/junderw/received_events",
         "repos_url" : "https://api.github.com/users/junderw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/junderw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/junderw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/junderw"
      }
   }
]
