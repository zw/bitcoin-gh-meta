[
   {
      "body" : "Concept ACK. _Very_ curious to see some memory usage numbers :)",
      "created_at" : "2016-11-11T02:36:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-259866415",
      "id" : 259866415,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-11T03:29:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259866415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "I created a branch with some follow-up *shared_ptr all the things* and other optimizations: https://github.com/sipa/bitcoin/commits/sharedblock2",
      "created_at" : "2016-11-11T07:12:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-259895918",
      "id" : 259895918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-11T07:12:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259895918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "tested ACK.",
      "created_at" : "2016-11-14T17:57:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-260409978",
      "id" : 260409978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-14T17:57:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260409978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "FWIW, I attempted to test the performance impact of this but it is a bit difficulty to do a fair comparison. I am reasonably confident that it does not produce a significant slowdown. (logically it should be a speedup, but I don't think my measurements were fair/reliable enough to determine if there was on or not).",
      "created_at" : "2016-11-15T07:49:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-260570570",
      "id" : 260570570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-15T07:49:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260570570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I did a quick performance comparison running on 2 days of historical data, and though I was unable to quantify any meaningful performance difference, I agree that this doesn't appear to cause a significant slowdown.",
      "created_at" : "2016-11-16T20:01:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261055148",
      "id" : 261055148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-16T20:01:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261055148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Benchmark results (25 reindex-chainstates until last checkpoint, default dbcache, otherwise unloaded 24-core machine, measured by -debug=bench) on both master and #9125+#8580+#8589+a few shared_ptr optimizations I haven't PR'ed yet:\r\n* Average: master 1490s, shared_ptr 1442s\r\n\r\nBest master run:\r\n```\r\n2016-11-16 12:27:14   - Load block from disk: 1.25ms [273.57s]\r\n2016-11-16 12:27:14     - Sanity checks: 0.14ms [70.95s]\r\n2016-11-16 12:27:14     - Fork checks: 0.02ms [80.76s]\r\n2016-11-16 12:27:14       - Connect 64 transactions: 11.06ms (0.173ms/tx, 0.020ms/txin) [711.67s]\r\n2016-11-16 12:27:14     - Verify 550 txins: 11.09ms (0.020ms/txin) [718.24s]\r\n2016-11-16 12:27:14     - Index writing: 0.03ms [5.25s]\r\n2016-11-16 12:27:14     - Callbacks: 0.01ms [3.75s]\r\n2016-11-16 12:27:14   - Connect total: 11.34ms [896.52s]\r\n2016-11-16 12:27:14   - Flush: 0.26ms [86.70s]\r\n2016-11-16 12:27:14   - Writing chainstate: 0.02ms [112.45s]\r\n2016-11-16 12:27:14   - Connect postprocess: 0.42ms [86.88s]\r\n2016-11-16 12:27:14 - Connect block: 13.30ms [1456.12s]\r\n```\r\n\r\nBest shared_ptr run:\r\n```\r\n2016-11-16 10:17:40   - Load block from disk: 1.61ms [283.93s]\r\n2016-11-16 10:17:40     - Sanity checks: 0.18ms [76.82s]\r\n2016-11-16 10:17:40     - Fork checks: 0.03ms [83.22s]\r\n2016-11-16 10:17:40       - Connect 64 transactions: 17.43ms (0.272ms/tx, 0.032ms/txin) [717.76s]\r\n2016-11-16 10:17:40     - Verify 550 txins: 17.47ms (0.032ms/txin) [724.51s]\r\n2016-11-16 10:17:40     - Index writing: 0.02ms [5.34s]\r\n2016-11-16 10:17:40     - Callbacks: 0.02ms [3.85s]\r\n2016-11-16 10:17:40   - Connect total: 17.81ms [911.36s]\r\n2016-11-16 10:17:40   - Flush: 0.40ms [87.91s]\r\n2016-11-16 10:17:40   - Writing chainstate: 0.03ms [112.31s]\r\n2016-11-16 10:17:40   - Connect postprocess: 0.08ms [25.61s]\r\n2016-11-16 10:17:40 - Connect block: 19.94ms [1421.12s]\r\n```\r\n\r\nGoing to include just this PR in future benchmarks as well, as there seem to be some slowdowns too, and I don't know where they're coming from.",
      "created_at" : "2016-11-16T20:07:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261056620",
      "id" : 261056620,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-16T20:42:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261056620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88527182"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88527182"
         }
      },
      "body" : "Nits: _t is reserved by posix, and maybe namespace \"deserialize\" to avoid future shadowing oopses?",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T19:26:46Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)\n+ *\n+ * is a deserializing constructor, which builds the type by\n+ * deserializing it from s. If T contains const fields, this\n+ * is likely the only way to do so.\n+ */\n+struct deserialize_t {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88527182",
      "id" : 88527182,
      "original_commit_id" : "9ea07616f265b928e32e6981490cd29584749c6f",
      "original_position" : 22,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88527182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88528236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88528236"
         }
      },
      "body" : "Does this need a move assignment operator too? Or is this being removed in a follow-up anyway?",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T19:31:20Z",
      "diff_hunk" : "@@ -379,6 +379,7 @@ class CTransaction\n \n     /** Convert a CMutableTransaction into a CTransaction. */\n     CTransaction(const CMutableTransaction &tx);\n+    CTransaction(CMutableTransaction &&tx);\n \n     CTransaction& operator=(const CTransaction& tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88528236",
      "id" : 88528236,
      "original_commit_id" : "b3a8200c8616d23ea577cac5233d84d795035b0d",
      "original_position" : 6,
      "path" : "src/primitives/transaction.h",
      "position" : 6,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88528236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88537741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88537741"
         }
      },
      "body" : "Need to account for the overhead in the control block?",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T20:18:41Z",
      "diff_hunk" : "@@ -69,8 +69,8 @@ static inline size_t RecursiveDynamicUsage(const CMutableTransaction& tx) {\n \n static inline size_t RecursiveDynamicUsage(const CBlock& block) {\n     size_t mem = memusage::DynamicUsage(block.vtx);\n-    for (std::vector<CTransaction>::const_iterator it = block.vtx.begin(); it != block.vtx.end(); it++) {\n-        mem += RecursiveDynamicUsage(*it);\n+    for (const auto& tx : block.vtx) {\n+        mem += RecursiveDynamicUsage(*tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88537741",
      "id" : 88537741,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 7,
      "path" : "src/core_memusage.h",
      "position" : null,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88537741",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88538183"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88538183"
         }
      },
      "body" : "Future optim (probably done in one of your follow-up branches), this could just return a shared_ptr instead.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T20:21:13Z",
      "diff_hunk" : "@@ -1682,9 +1682,9 @@ bool GetTransaction(const uint256 &hash, CTransaction &txOut, const Consensus::P\n     if (pindexSlow) {\n         CBlock block;\n         if (ReadBlockFromDisk(block, pindexSlow, consensusParams)) {\n-            BOOST_FOREACH(const CTransaction &tx, block.vtx) {\n-                if (tx.GetHash() == hash) {\n-                    txOut = tx;\n+            for (const auto& tx : block.vtx) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88538183",
      "id" : 88538183,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 7,
      "path" : "src/main.cpp",
      "position" : 25,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88538183",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88540383"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88540383"
         }
      },
      "body" : "Fixing them one at a time, eh? :)",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T20:34:24Z",
      "diff_hunk" : "@@ -2884,7 +2885,7 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     // Update chainActive & related variables.\n     UpdateTip(pindexNew, chainparams);\n \n-    for(unsigned int i=0; i < pblock->vtx.size(); i++)\n+    for (unsigned int i=0; i < pblock->vtx.size(); i++)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88540383",
      "id" : 88540383,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 99,
      "path" : "src/main.cpp",
      "position" : 117,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88540383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88541047"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88541047"
         }
      },
      "body" : "unrelated nit: using range-for or iterators here would avoid looking up in the vector 3x.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T20:38:05Z",
      "diff_hunk" : "@@ -3109,13 +3110,13 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         // throw all transactions though the signal-interface\n         // while _not_ holding the cs_main lock\n-        for(std::shared_ptr<const CTransaction> tx : txConflicted)\n+        for (const auto& tx : txConflicted)\n         {\n             GetMainSignals().SyncTransaction(*tx, pindexNewTip, CMainSignals::SYNC_TRANSACTION_NOT_IN_BLOCK);\n         }\n         // ... and about transactions that got confirmed:\n-        for(unsigned int i = 0; i < txChanged.size(); i++)\n-            GetMainSignals().SyncTransaction(std::get<0>(txChanged[i]), std::get<1>(txChanged[i]), std::get<2>(txChanged[i]));\n+        for (unsigned int i = 0; i < txChanged.size(); i++)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88541047",
      "id" : 88541047,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 133,
      "path" : "src/main.cpp",
      "position" : 160,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88541047",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88541658"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88541658"
         }
      },
      "body" : "Nit: This could be combined with the loop above, and &*tx could be cached to avoid duped dereference cost.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T20:41:47Z",
      "diff_hunk" : "@@ -3454,22 +3455,22 @@ bool CheckBlock(const CBlock& block, CValidationState& state, const Consensus::P\n         return state.DoS(100, false, REJECT_INVALID, \"bad-blk-length\", false, \"size limits failed\");\n \n     // First transaction must be coinbase, the rest must not be\n-    if (block.vtx.empty() || !block.vtx[0].IsCoinBase())\n+    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase())\n         return state.DoS(100, false, REJECT_INVALID, \"bad-cb-missing\", false, \"first tx is not coinbase\");\n     for (unsigned int i = 1; i < block.vtx.size(); i++)\n-        if (block.vtx[i].IsCoinBase())\n+        if (block.vtx[i]->IsCoinBase())\n             return state.DoS(100, false, REJECT_INVALID, \"bad-cb-multiple\", false, \"more than one coinbase\");\n \n     // Check transactions\n     for (const auto& tx : block.vtx)\n-        if (!CheckTransaction(tx, state, false))\n+        if (!CheckTransaction(*tx, state, false))\n             return state.Invalid(false, state.GetRejectCode(), state.GetRejectReason(),\n-                                 strprintf(\"Transaction check failed (tx hash %s) %s\", tx.GetHash().ToString(), state.GetDebugMessage()));\n+                                 strprintf(\"Transaction check failed (tx hash %s) %s\", tx->GetHash().ToString(), state.GetDebugMessage()));\n \n     unsigned int nSigOps = 0;\n     for (const auto& tx : block.vtx)\n     {\n-        nSigOps += GetLegacySigOpCount(tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88541658",
      "id" : 88541658,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 161,
      "path" : "src/main.cpp",
      "position" : 188,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88541658",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88545416"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88545416"
         }
      },
      "body" : "nit: could cache the dereferenced tx since it's used a few times",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T21:03:41Z",
      "diff_hunk" : "@@ -596,29 +596,29 @@ void CTxMemPool::removeConflicts(const CTransaction &tx, std::vector<std::shared\n /**\n  * Called when a block is connected. Removes from mempool and updates the miner fee estimator.\n  */\n-void CTxMemPool::removeForBlock(const std::vector<CTransaction>& vtx, unsigned int nBlockHeight,\n+void CTxMemPool::removeForBlock(const std::vector<shared_ptr<const CTransaction>>& vtx, unsigned int nBlockHeight,\n                                 std::vector<std::shared_ptr<const CTransaction>>* conflicts, bool fCurrentEstimate)\n {\n     LOCK(cs);\n     std::vector<CTxMemPoolEntry> entries;\n-    BOOST_FOREACH(const CTransaction& tx, vtx)\n+    for (const auto& tx : vtx)\n     {\n-        uint256 hash = tx.GetHash();\n+        uint256 hash = tx->GetHash();\n \n         indexed_transaction_set::iterator i = mapTx.find(hash);\n         if (i != mapTx.end())\n             entries.push_back(*i);\n     }\n-    BOOST_FOREACH(const CTransaction& tx, vtx)\n+    for (const auto& tx : vtx)\n     {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88545416",
      "id" : 88545416,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 22,
      "path" : "src/txmempool.cpp",
      "position" : 50,
      "pull_request_review_id" : 9099010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88545416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546294"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546294"
         }
      },
      "body" : "Heh, https://github.com/bitcoin/bitcoin/pull/8580/commits/9b27eb1db1e4d1433f016dad381b52e8d986b685. Nevermind.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T21:08:43Z",
      "diff_hunk" : "@@ -1682,9 +1682,9 @@ bool GetTransaction(const uint256 &hash, CTransaction &txOut, const Consensus::P\n     if (pindexSlow) {\n         CBlock block;\n         if (ReadBlockFromDisk(block, pindexSlow, consensusParams)) {\n-            BOOST_FOREACH(const CTransaction &tx, block.vtx) {\n-                if (tx.GetHash() == hash) {\n-                    txOut = tx;\n+            for (const auto& tx : block.vtx) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546294",
      "id" : 88546294,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 7,
      "path" : "src/main.cpp",
      "position" : 25,
      "pull_request_review_id" : 9117976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546809"
         }
      },
      "body" : "I'm not sure what you are suggesting here.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T21:11:57Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)\n+ *\n+ * is a deserializing constructor, which builds the type by\n+ * deserializing it from s. If T contains const fields, this\n+ * is likely the only way to do so.\n+ */\n+struct deserialize_t {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546809",
      "id" : 88546809,
      "original_commit_id" : "9ea07616f265b928e32e6981490cd29584749c6f",
      "original_position" : 22,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9118508,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546901"
         }
      },
      "body" : "All assignment operators go away in #8580.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T21:12:28Z",
      "diff_hunk" : "@@ -379,6 +379,7 @@ class CTransaction\n \n     /** Convert a CMutableTransaction into a CTransaction. */\n     CTransaction(const CMutableTransaction &tx);\n+    CTransaction(CMutableTransaction &&tx);\n \n     CTransaction& operator=(const CTransaction& tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88546901",
      "id" : 88546901,
      "original_commit_id" : "b3a8200c8616d23ea577cac5233d84d795035b0d",
      "original_position" : 6,
      "path" : "src/primitives/transaction.h",
      "position" : 6,
      "pull_request_review_id" : 9118599,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88546901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88556905"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88556905"
         }
      },
      "body" : "```c++\r\nnamespace deserialize\r\n{\r\n  struct tag {};\r\n  constexpr tag do;\r\n}\r\n```\r\nI suppose it's not worry worrying about though. I can't come up with a case where using a local variable \"deserialize\" could compile in an unintended way.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T22:01:42Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)\n+ *\n+ * is a deserializing constructor, which builds the type by\n+ * deserializing it from s. If T contains const fields, this\n+ * is likely the only way to do so.\n+ */\n+struct deserialize_t {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88556905",
      "id" : 88556905,
      "original_commit_id" : "9ea07616f265b928e32e6981490cd29584749c6f",
      "original_position" : 22,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9128405,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88556905",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88565949"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88565949"
         }
      },
      "body" : "Where is this version used? I see calls that call std::move before calling that maybe should be using this instead?\r\n\r\nIn any case, it doesn't feel right to have so many versions of the function somehow. Specially one some with & and others with &&",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T22:55:17Z",
      "diff_hunk" : "@@ -460,12 +464,25 @@ struct CMutableTransaction\n         SerializeTransaction(*this, s, ser_action);\n     }\n \n+    template <typename Stream>\n+    CMutableTransaction(deserialize_t, Stream& s) {\n+        Unserialize(s);\n+    }\n+\n     /** Compute the hash of this CMutableTransaction. This is computed on the\n      * fly, as opposed to GetHash() in CTransaction, which uses a cached result.\n      */\n     uint256 GetHash() const;\n };\n \n+typedef std::shared_ptr<const CTransaction> CTransactionRef;\n+static inline CTransactionRef MakeTransactionRef() { return std::make_shared<const CTransaction>(); }\n+static inline CTransactionRef MakeTransactionRef(const CTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(const CMutableTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(CMutableTransaction&& txIn) { return std::make_shared<const CTransaction>(std::move(txIn)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88565949",
      "id" : 88565949,
      "original_commit_id" : "9bc6cbc4e24ef856ad4c803226378f276acc14ff",
      "original_position" : 37,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 9137405,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88565949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88566807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88566807"
         }
      },
      "body" : "Thanks",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T23:00:29Z",
      "diff_hunk" : "@@ -69,8 +69,8 @@ static inline size_t RecursiveDynamicUsage(const CMutableTransaction& tx) {\n \n static inline size_t RecursiveDynamicUsage(const CBlock& block) {\n     size_t mem = memusage::DynamicUsage(block.vtx);\n-    for (std::vector<CTransaction>::const_iterator it = block.vtx.begin(); it != block.vtx.end(); it++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88566807",
      "id" : 88566807,
      "original_commit_id" : "9bc6cbc4e24ef856ad4c803226378f276acc14ff",
      "original_position" : 4,
      "path" : "src/core_memusage.h",
      "position" : 4,
      "pull_request_review_id" : 9138217,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88566807",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88567792"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88567792"
         }
      },
      "body" : "I believe the overloads could be replaced with:\r\n```c++\r\ntemplate <typename T>\r\nstatic inline CTransactionRef MakeTransactionRef(T&& txIn)\r\n{\r\n  return std::make_shared<const CTransaction>(std::forward<T>(txIn));\r\n}\r\n```",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-17T23:06:42Z",
      "diff_hunk" : "@@ -460,12 +464,25 @@ struct CMutableTransaction\n         SerializeTransaction(*this, s, ser_action);\n     }\n \n+    template <typename Stream>\n+    CMutableTransaction(deserialize_t, Stream& s) {\n+        Unserialize(s);\n+    }\n+\n     /** Compute the hash of this CMutableTransaction. This is computed on the\n      * fly, as opposed to GetHash() in CTransaction, which uses a cached result.\n      */\n     uint256 GetHash() const;\n };\n \n+typedef std::shared_ptr<const CTransaction> CTransactionRef;\n+static inline CTransactionRef MakeTransactionRef() { return std::make_shared<const CTransaction>(); }\n+static inline CTransactionRef MakeTransactionRef(const CTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(const CMutableTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(CMutableTransaction&& txIn) { return std::make_shared<const CTransaction>(std::move(txIn)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88567792",
      "id" : 88567792,
      "original_commit_id" : "9bc6cbc4e24ef856ad4c803226378f276acc14ff",
      "original_position" : 37,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 9139136,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88567792",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@jtimon I believe all of them are used in successor PRs.\n\n@theuni That overload won't work for the arguments that take a\nCTransactionRef.\n",
      "created_at" : "2016-11-17T23:09:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261399275",
      "id" : 261399275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-17T23:09:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261399275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@jtimon std::move just casts to an T&& argument. It's to indicate that the\ncalled function may destroy the object.\n",
      "created_at" : "2016-11-17T23:11:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261399691",
      "id" : 261399691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-17T23:11:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261399691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "utACK 9bc6cbc besides some nits by @theuni ",
      "created_at" : "2016-11-17T23:44:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261405945",
      "id" : 261405945,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-17T23:45:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261405945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@sipa I'm unsure why you'd want to do that? Why wouldn't you just\r\n```\r\nCTransactionRef a(MakeTransactionRef());\r\nCTransactionRef b(a);\r\nCTransactionRef c(std::move(b));\r\n```\r\n?",
      "created_at" : "2016-11-17T23:52:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261407305",
      "id" : 261407305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-17T23:52:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261407305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni In #8580 I add a templated constructor to CWalletTx and CMerkleTx that just passes its arguments to MakeTransactionRef, avoiding duplicating various kinds of constructors in both.",
      "created_at" : "2016-11-18T00:03:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261409347",
      "id" : 261409347,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-18T00:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261409347",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578710"
         }
      },
      "body" : "You take one down, pass it around. Infinity cases of nits in the code.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:33:36Z",
      "diff_hunk" : "@@ -2884,7 +2885,7 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     // Update chainActive & related variables.\n     UpdateTip(pindexNew, chainparams);\n \n-    for(unsigned int i=0; i < pblock->vtx.size(); i++)\n+    for (unsigned int i=0; i < pblock->vtx.size(); i++)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578710",
      "id" : 88578710,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 99,
      "path" : "src/main.cpp",
      "position" : 117,
      "pull_request_review_id" : 9149379,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578876"
         }
      },
      "body" : "Not going to touch that now, as I believe #9014 will rewrite this anyway.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:34:56Z",
      "diff_hunk" : "@@ -3109,13 +3110,13 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         // throw all transactions though the signal-interface\n         // while _not_ holding the cs_main lock\n-        for(std::shared_ptr<const CTransaction> tx : txConflicted)\n+        for (const auto& tx : txConflicted)\n         {\n             GetMainSignals().SyncTransaction(*tx, pindexNewTip, CMainSignals::SYNC_TRANSACTION_NOT_IN_BLOCK);\n         }\n         // ... and about transactions that got confirmed:\n-        for(unsigned int i = 0; i < txChanged.size(); i++)\n-            GetMainSignals().SyncTransaction(std::get<0>(txChanged[i]), std::get<1>(txChanged[i]), std::get<2>(txChanged[i]));\n+        for (unsigned int i = 0; i < txChanged.size(); i++)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578876",
      "id" : 88578876,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 133,
      "path" : "src/main.cpp",
      "position" : 160,
      "pull_request_review_id" : 9149529,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578993"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578993"
         }
      },
      "body" : "Good point, but let's do that as an independent improvement.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:35:53Z",
      "diff_hunk" : "@@ -3454,22 +3455,22 @@ bool CheckBlock(const CBlock& block, CValidationState& state, const Consensus::P\n         return state.DoS(100, false, REJECT_INVALID, \"bad-blk-length\", false, \"size limits failed\");\n \n     // First transaction must be coinbase, the rest must not be\n-    if (block.vtx.empty() || !block.vtx[0].IsCoinBase())\n+    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase())\n         return state.DoS(100, false, REJECT_INVALID, \"bad-cb-missing\", false, \"first tx is not coinbase\");\n     for (unsigned int i = 1; i < block.vtx.size(); i++)\n-        if (block.vtx[i].IsCoinBase())\n+        if (block.vtx[i]->IsCoinBase())\n             return state.DoS(100, false, REJECT_INVALID, \"bad-cb-multiple\", false, \"more than one coinbase\");\n \n     // Check transactions\n     for (const auto& tx : block.vtx)\n-        if (!CheckTransaction(tx, state, false))\n+        if (!CheckTransaction(*tx, state, false))\n             return state.Invalid(false, state.GetRejectCode(), state.GetRejectReason(),\n-                                 strprintf(\"Transaction check failed (tx hash %s) %s\", tx.GetHash().ToString(), state.GetDebugMessage()));\n+                                 strprintf(\"Transaction check failed (tx hash %s) %s\", tx->GetHash().ToString(), state.GetDebugMessage()));\n \n     unsigned int nSigOps = 0;\n     for (const auto& tx : block.vtx)\n     {\n-        nSigOps += GetLegacySigOpCount(tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88578993",
      "id" : 88578993,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 161,
      "path" : "src/main.cpp",
      "position" : 188,
      "pull_request_review_id" : 9149641,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88578993",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579459"
         }
      },
      "body" : "Likewise.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:40:23Z",
      "diff_hunk" : "@@ -596,29 +596,29 @@ void CTxMemPool::removeConflicts(const CTransaction &tx, std::vector<std::shared\n /**\n  * Called when a block is connected. Removes from mempool and updates the miner fee estimator.\n  */\n-void CTxMemPool::removeForBlock(const std::vector<CTransaction>& vtx, unsigned int nBlockHeight,\n+void CTxMemPool::removeForBlock(const std::vector<shared_ptr<const CTransaction>>& vtx, unsigned int nBlockHeight,\n                                 std::vector<std::shared_ptr<const CTransaction>>* conflicts, bool fCurrentEstimate)\n {\n     LOCK(cs);\n     std::vector<CTxMemPoolEntry> entries;\n-    BOOST_FOREACH(const CTransaction& tx, vtx)\n+    for (const auto& tx : vtx)\n     {\n-        uint256 hash = tx.GetHash();\n+        uint256 hash = tx->GetHash();\n \n         indexed_transaction_set::iterator i = mapTx.find(hash);\n         if (i != mapTx.end())\n             entries.push_back(*i);\n     }\n-    BOOST_FOREACH(const CTransaction& tx, vtx)\n+    for (const auto& tx : vtx)\n     {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579459",
      "id" : 88579459,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 22,
      "path" : "src/txmempool.cpp",
      "position" : 50,
      "pull_request_review_id" : 9150116,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579642"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:42:11Z",
      "diff_hunk" : "@@ -69,8 +69,8 @@ static inline size_t RecursiveDynamicUsage(const CMutableTransaction& tx) {\n \n static inline size_t RecursiveDynamicUsage(const CBlock& block) {\n     size_t mem = memusage::DynamicUsage(block.vtx);\n-    for (std::vector<CTransaction>::const_iterator it = block.vtx.begin(); it != block.vtx.end(); it++) {\n-        mem += RecursiveDynamicUsage(*it);\n+    for (const auto& tx : block.vtx) {\n+        mem += RecursiveDynamicUsage(*tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579642",
      "id" : 88579642,
      "original_commit_id" : "8a671e8a16075707a5fe764689087163ebe9d26d",
      "original_position" : 7,
      "path" : "src/core_memusage.h",
      "position" : null,
      "pull_request_review_id" : 9150296,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579642",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579656"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579656"
         }
      },
      "body" : "Fixed by using deserialize_type instead of deserialize_t.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-18T00:42:25Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)\n+ *\n+ * is a deserializing constructor, which builds the type by\n+ * deserializing it from s. If T contains const fields, this\n+ * is likely the only way to do so.\n+ */\n+struct deserialize_t {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88579656",
      "id" : 88579656,
      "original_commit_id" : "9ea07616f265b928e32e6981490cd29584749c6f",
      "original_position" : 22,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9150314,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88579656",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased, and addressed two nits by @theuni:\r\n* Added the memory usage for the control block of the vtx entries in CBlock.\r\n* Changed deserialize_t to deserialize_type to avoid colliding with the reserved _t suffix.",
      "created_at" : "2016-11-18T00:52:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261417431",
      "id" : 261417431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-18T00:53:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261417431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Some more benchmarks (fastest of 28 reindexes each, 300 MB dbcache, reindex chainstate up to block 295000):\r\n- master: 1462.4s\r\n- this PR: 1411.2s\r\n- #8580: 1412.2s\r\n- #8589: 1417.5s\r\n- https://github.com/sipa/bitcoin/commits/sharedblock2: 1410.3s\r\n",
      "created_at" : "2016-11-19T19:24:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261733957",
      "id" : 261733957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-26T01:21:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261733957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88790537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88790537"
         }
      },
      "body" : "Nit: bad search/replace here?",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-19T23:56:28Z",
      "diff_hunk" : "@@ -193,7 +193,7 @@ class CBlockHeaderAndShortTxIDs {\n \n class PartiallyDownloadedBlock {\n protected:\n-    std::vector<std::shared_ptr<const CTransaction> > txn_available;\n+    std::vector<CTransactionRef > txn_available;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88790537",
      "id" : 88790537,
      "original_commit_id" : "39e832c90012db03822f61009060712a47f7f81d",
      "original_position" : 35,
      "path" : "src/blockencodings.h",
      "position" : null,
      "pull_request_review_id" : 9355123,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88790537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88790945"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88790945"
         }
      },
      "body" : "nit: comment out of date",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-20T00:25:50Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88790945",
      "id" : 88790945,
      "original_commit_id" : "39e832c90012db03822f61009060712a47f7f81d",
      "original_position" : 16,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9355123,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88790945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88791112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88791112"
         }
      },
      "body" : "Might still be worth replacing the 6 functions with 3 using @theuni's suggestion",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-20T00:38:34Z",
      "diff_hunk" : "@@ -460,12 +464,25 @@ struct CMutableTransaction\n         SerializeTransaction(*this, s, ser_action);\n     }\n \n+    template <typename Stream>\n+    CMutableTransaction(deserialize_t, Stream& s) {\n+        Unserialize(s);\n+    }\n+\n     /** Compute the hash of this CMutableTransaction. This is computed on the\n      * fly, as opposed to GetHash() in CTransaction, which uses a cached result.\n      */\n     uint256 GetHash() const;\n };\n \n+typedef std::shared_ptr<const CTransaction> CTransactionRef;\n+static inline CTransactionRef MakeTransactionRef() { return std::make_shared<const CTransaction>(); }\n+static inline CTransactionRef MakeTransactionRef(const CTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(const CMutableTransaction& txIn) { return std::make_shared<const CTransaction>(txIn); }\n+static inline CTransactionRef MakeTransactionRef(CMutableTransaction&& txIn) { return std::make_shared<const CTransaction>(std::move(txIn)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88791112",
      "id" : 88791112,
      "original_commit_id" : "9bc6cbc4e24ef856ad4c803226378f276acc14ff",
      "original_position" : 37,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 9355123,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:00:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88791112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88792015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88792015"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-20T02:01:06Z",
      "diff_hunk" : "@@ -193,7 +193,7 @@ class CBlockHeaderAndShortTxIDs {\n \n class PartiallyDownloadedBlock {\n protected:\n-    std::vector<std::shared_ptr<const CTransaction> > txn_available;\n+    std::vector<CTransactionRef > txn_available;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88792015",
      "id" : 88792015,
      "original_commit_id" : "39e832c90012db03822f61009060712a47f7f81d",
      "original_position" : 35,
      "path" : "src/blockencodings.h",
      "position" : null,
      "pull_request_review_id" : 9356283,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:01:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88792015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88792016"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88792016"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2016-11-20T02:01:11Z",
      "diff_hunk" : "@@ -25,6 +26,20 @@\n static const unsigned int MAX_SIZE = 0x02000000;\n \n /**\n+ * Dummy data type to identify deserializing constructors.\n+ *\n+ * By convention, a constructor of a type T with signature\n+ *\n+ *   template <typename Stream> T::T(deserialize_t, Stream& s)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r88792016",
      "id" : 88792016,
      "original_commit_id" : "39e832c90012db03822f61009060712a47f7f81d",
      "original_position" : 16,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 9356284,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2016-11-20T02:01:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/88792016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Addressed all of @TheBlueMatt's nits.",
      "created_at" : "2016-11-20T02:01:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261753075",
      "id" : 261753075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-20T02:01:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261753075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Tested ACK b4e4ba4",
      "created_at" : "2016-11-21T09:52:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261892172",
      "id" : 261892172,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-21T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261892172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r183006766"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183006766"
         }
      },
      "author_association" : "NONE",
      "body" : "Right now there's some code redundancy - the only `deserialize_type` is `deserialize`,\r\nso it's not really used - like here.\r\nBut I guess people think there may be more in the future. ",
      "commit_id" : "b4e4ba475a5679e09f279aaf2a83dcf93c632bdb",
      "created_at" : "2018-04-20T10:14:25Z",
      "diff_hunk" : "@@ -460,6 +464,11 @@ struct CMutableTransaction\n         SerializeTransaction(*this, s, ser_action);\n     }\n \n+    template <typename Stream>\n+    CMutableTransaction(deserialize_type, Stream& s) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#discussion_r183006766",
      "id" : 183006766,
      "original_commit_id" : "da60506fc80f6a78f1b271a9a53b956b49b37234",
      "original_position" : 23,
      "path" : "src/primitives/transaction.h",
      "position" : 23,
      "pull_request_review_id" : 113922540,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9125",
      "updated_at" : "2018-04-20T10:20:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183006766",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5689834?v=4",
         "events_url" : "https://api.github.com/users/arielgabizon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arielgabizon/followers",
         "following_url" : "https://api.github.com/users/arielgabizon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arielgabizon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arielgabizon",
         "id" : 5689834,
         "login" : "arielgabizon",
         "organizations_url" : "https://api.github.com/users/arielgabizon/orgs",
         "received_events_url" : "https://api.github.com/users/arielgabizon/received_events",
         "repos_url" : "https://api.github.com/users/arielgabizon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arielgabizon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arielgabizon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arielgabizon"
      }
   }
]
