{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Maybe helps review: https://github.com/jtimon/bitcoin/compare/0.13-new-testchain...jtimon:0.13-blocksign from #8994.\r\n\r\nOnce we allow users to create their own chains with #8994 and customize chain params viacommand line and/or a separate file (discuss there), this PR adds additional options and chainparams  -con_fsignblockchain and -con_signblockscript to optionally replace pow with bitcoin scripts if -con_fsignblockchain=1; -con_signblockscript being the scriptPubKey the block producers need to provide a scriptSig for with each block (instead of prociding a nonce that passes the pow in the block hash like regular miners).\r\n\r\nThis will help spring testchains that are more reliable and controllable by developers testing new features. Among other people, folks from the lightning community have communicated that testnet3 is not ideal for some testing scenarios.\r\n\r\nNote that also travis tests pass, the new functionality is only tested in test/signedblocks_tests.cpp\r\nApart from that, BasicSignBlock is dependent on some other tests because the following doesn't pass:\r\n```\r\n./src/test/test_bitcoin --run_test=BasicSignBlock\r\n```\r\nIt is good that it fails because testing manually with ```importprivkey cTVbLcfg8ftQ25j1YSysmTVugBVEuZymbKUqjHaiCmg2ZSWNmccU``` and -con_signblockscript != 21026f9ee99573cf566726ab891ad7dd7ffd36cae816efe71a93bd81f71c3abd04d6ac``` [CScript() << ParseHex(\"cTVbLcfg8ftQ25j1YSysmTVugBVEuZymbKUqjHaiCmg2ZSWNmccU\") << OP_CHECKSIG] doesn't work either.\r\nI hope I will eventually figure it out with ```gdb --args ./src/test/test_bitcoin --run_test=BasicSignBlock``` but if someone else is faster than me, thanks in advance.\r\n\r\nIdeally, we would also reuse all the rpc tests for testing this mode with an additional option similar to -extended.\r\nFirst we need  #8994 to reuse (or replace, please discuss there) all the rpc test for regtest with the new custom chain which by default is identical to regtest, only with a different genesis block and .bitcoin directory. Currently all of them are converted from regtest to custom except :\r\n\r\n- [ ] p2p-comapctblocks.py\r\n- [ ] segwit.py\r\n- [ ] mempool_packages.py (extended)\r\n- [ ] pruning.py (extended)\r\n\r\n(help here welcomed too)\r\nReusing all tests is not strictly necessary but would be nice.\r\n\r\nDependencies:\r\n- [ ] Use a proper factory for creating chainparams #8855\r\n- [ ] Really don't validate genesis block #9102\r\n- [ ] Testchains: Introduce custom chain whose constructor... #8994\r\n\r\nOpen design concerns:\r\n\r\n- Global fSignBlocksGlobal is worrying \r\n- Global UnionProof is worrying \r\n\r\nYou can also see https://github.com/jtimon/bitcoin/compare/0.13-blocksign...0.13-blocksign-longest for other things I'm trying or considering.\r\n",
   "closed_at" : "2017-06-19T06:59:59Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
      "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jtimon/followers",
      "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jtimon",
      "id" : 1008458,
      "login" : "jtimon",
      "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
      "organizations_url" : "https://api.github.com/users/jtimon/orgs",
      "received_events_url" : "https://api.github.com/users/jtimon/received_events",
      "repos_url" : "https://api.github.com/users/jtimon/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jtimon"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9177/comments",
   "created_at" : "2016-11-17T07:00:51Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9177/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/9177",
   "id" : 189957621,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9177/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0OTQxMTIzNzc=",
   "number" : 9177,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/9177.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9177",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/9177.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9177"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "NOMERGE: WIP: Support block signed custom testchains",
   "updated_at" : "2017-06-19T06:59:59Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9177",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
      "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jtimon/followers",
      "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jtimon",
      "id" : 1008458,
      "login" : "jtimon",
      "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
      "organizations_url" : "https://api.github.com/users/jtimon/orgs",
      "received_events_url" : "https://api.github.com/users/jtimon/received_events",
      "repos_url" : "https://api.github.com/users/jtimon/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jtimon"
   }
}
