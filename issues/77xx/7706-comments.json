[
   {
      "body" : "Unfortunately this is not easy to fix properly.\r\nInside wallet.cpp, the calculation of your balance has the nice property of adding up all of your coins and then only counting the ones that haven't been spent.  Therefore it's not really possible to spend a coin you're not counting in your balance.\r\n\r\nHowever the calculations used in the `getbalance` rpc call work differently, by adding up the received amounts and subtracting the sent amounts because they are using \"accounts\".   So you'll end up with potentially negative balances and other bad things if we try to mimic the behavior for unconfirmed txs that we want in the wallet code.  This is relevant because the only way to get an unconfirmed balance using rpc is to call `getbalance \"\" 0` or `getbalance \"*\" 0`.  I'll admit to not really understanding exactly what either of those do, but they both suffer from that same broken behavior.\r\n\r\nThe \"solution\" I propose in the second commit is to revert to the 0.11 treatment of transactions which are not confirmed and not in your mempool when calculating balances by account.  This will differ from the calculation that is done for the GUI and as an overall calculation.\r\n\r\nThe biggest impact of this problem is that `sendfrom` and `sendmany` use the `GetAccountBalance` method of determining balance, so they will use the \"wrong\" value.\r\n",
      "created_at" : "2016-03-17T22:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7706#issuecomment-198103470",
      "id" : 198103470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7706",
      "updated_at" : "2016-03-17T22:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/198103470",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Perhaps it would be a good idea to special case the \"\" account in all of these rpc calls to not use the account method of calculations and use `GetBalance` and `GetUnconfirmedBalance` from wallet.cpp.  That way everything should work \"properly\" if you are not trying to use accounts.  Although `GetBalance` doesn't currently have support for minimum confirmation depths.",
      "created_at" : "2016-03-17T22:09:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7706#issuecomment-198104389",
      "id" : 198104389,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7706",
      "updated_at" : "2016-03-17T22:09:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/198104389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Once upon a time I thought to my self *why the call to GetAccountBalance when CreateTransaction fails if there's insufficient UTXO's*..",
      "created_at" : "2016-03-17T23:48:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7706#issuecomment-198135054",
      "id" : 198135054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7706",
      "updated_at" : "2016-03-17T23:48:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/198135054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
